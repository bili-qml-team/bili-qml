/**
 * bilibili comments pc
 * @version 4a34e696fa
 * @built Thu, 13 Nov 2025 07:00:20 GMT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).BiliComments=e()}(this,function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function e(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t,e,n,i,r,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise(function(r,o){var a=t.apply(e,i);function s(t){n(a,r,o,s,l,"next",t)}function l(t){n(a,r,o,s,l,"throw",t)}s(void 0)})}}function r(t,n,i){return n=d(n),function(t,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return e(t)}(t,p()?Reflect.construct(n,i||[],d(t).constructor):n.apply(t,i))}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,A(i.key),i)}}function s(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=E(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function c(t,e,n){return(e=A(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},u.apply(null,arguments)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(p=function(){return!!t})()}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach(function(e){c(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function m(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,e,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,i,r,o){var l=i&&i.prototype instanceof s?i:s,c=Object.create(l.prototype);return y(c,"_invoke",function(n,i,r){var o,s,l,c=0,u=r||[],d=!1,h={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return o=e,s=0,l=t,h.n=n,a}};function p(n,i){for(s=n,l=i,e=0;!d&&c&&!r&&e<u.length;e++){var r,o=u[e],p=h.p,f=o[2];n>3?(r=f===i)&&(l=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=p&&((r=n<2&&p<o[1])?(s=0,h.v=i,h.n=o[1]):p<f&&(r=n<3||o[0]>i||i>f)&&(o[4]=n,o[5]=i,h.n=f,s=0))}if(r||n>1)return a;throw d=!0,i}return function(r,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,f),s=u,l=f;(e=s<2?t:l)||!d;){o||(s?s<3?(s>1&&(h.n=-1),p(s,l)):h.n=l:h.v=l);try{if(c=2,o){if(s||(r="next"),e=o[r]){if(!(e=e.call(o,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),s=1);o=t}else if((e=(d=h.n<0)?l:n.call(i,h))!==a)break}catch(e){o=t,s=1,l=e}finally{c=1}}return{value:e,done:d}}}(n,r,o),!0),c}var a={};function s(){}function l(){}function c(){}e=Object.getPrototypeOf;var u=[][i]?e(e([][i]())):(y(e={},i,function(){return this}),e),d=c.prototype=s.prototype=Object.create(u);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,y(t,r,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=c,y(d,"constructor",c),y(c,"constructor",l),l.displayName="GeneratorFunction",y(c,r,"GeneratorFunction"),y(d),y(d,r,"Generator"),y(d,i,function(){return this}),y(d,"toString",function(){return"[object Generator]"}),(m=function(){return{w:o,m:h}})()}function y(t,e,n,i){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}y=function(t,e,n,i){function o(e,n){y(t,e,function(t){return this._invoke(e,n,t)})}e?r?r(t,e,{value:n,enumerable:!i,configurable:!i,writable:!i}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},y(t,e,n,i)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(t,e)||E(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e,n,i){var r=u(d(1&i?t.prototype:t),e,n);return 2&i&&"function"==typeof r?function(t){return r.apply(n,t)}:r}function x(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function k(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function E(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}function C(t){var e="function"==typeof Map?new Map:void 0;return C=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(p())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(t.bind.apply(t,i));return n&&b(r,n.prototype),r}(t,arguments,d(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),b(n,t)},C(t)}("undefined"==typeof globalThis?"undefined":_(globalThis))<"u"?globalThis:("undefined"==typeof window?"undefined":_(window))<"u"?window:("undefined"==typeof global?"undefined":_(global))<"u"?global:("undefined"==typeof self?"undefined":_(self))<"u"&&self;var T={exports:{}};!function(t,e){!function(t){var e=function(){function t(t){var e=this;this.disposables=[],this.playing=!1,this.valid=!1,this.remove=!1,this.raf=0;var n=t.src,i=t.width,r=t.height,o=t.sizing,a=t.autoplay,s=t.loop,l=t.canvas||document.createElement("canvas");this.canvas=l,t.container&&(t.container.appendChild(l),this.remove=!0),this.initVideo(n,a,s),this.initWebgl(i,r,o),this.disposables.unshift(function(){e.playing&&e.pause(),e.raf&&window.cancelAnimationFrame(e.raf),e.remove&&e.canvas.parentElement&&e.canvas.parentElement.removeChild(e.canvas)})}return Object.defineProperty(t.prototype,"currentTime",{get:function(){return this.video.currentTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.video.duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"src",{get:function(){return this.video.src},enumerable:!1,configurable:!0}),t.prototype.addEventListener=function(t,e,n){var i=this;this.video.addEventListener(t,e,n),this.disposables.push(function(){i.video.removeEventListener(t,e,n)})},t.prototype.initVideo=function(t,e,n){var i=this,r=document.createElement("video");this.video=r,r.src=t,r.autoplay=e||!1,r.muted=!0,r.volume=0,r.muted=!0,r.loop=n||!1,r.style.display="none",r.crossOrigin="anonymous",r.setAttribute("type","video/mp4"),this.addEventListener("play",function(){i.raf=window.requestAnimationFrame(function(){i.nextFrame()})}),this.addEventListener("playing",function(){i.valid=!0}),this.addEventListener("ended",function(){i.playing=!1})},t.prototype.nextFrame=function(){var t=this;this.playing&&(this.callWebglDraw(),this.raf=window.requestAnimationFrame(function(){t.nextFrame()}))},t.prototype.callWebglDraw=function(){var t=this.gl;this.valid&&(t.texImage2D(t.TEXTURE_2D,0,t.RGB,t.RGB,t.UNSIGNED_BYTE,this.video),t.drawArrays(t.TRIANGLE_STRIP,0,4))},t.prototype.dispose=function(){for(;this.disposables.length;)this.disposables.pop()()},t.prototype.play=function(){return this.playing=!0,this.valid=!1,this.video.play(),this},t.prototype.pause=function(){return this.playing=!1,this.video.pause(),this},t.prototype.reload=function(t){if(t)return this.video.src=t,this;console.warn("please set a valid src")},t.prototype.initWebgl=function(t,e,n){var i=1,r=[t,e];"raw"!==n&&(i=window.devicePixelRatio||1,r.forEach(function(t,e){r[e]=t*i}),"dpr-raw"===n&&(this.canvas.style.setProperty("transform","scale(".concat(1/i,")")),this.canvas.style.setProperty("transform-origin","left top"))),this.canvas.width=r[0],this.canvas.height=r[1];var o=this.canvas.getContext("webgl");this.gl=o,o.viewport(0,0,r[0],r[1]);var a=this.initShaderProgram(o);o.linkProgram(a),o.useProgram(a);var s=this.initBuffer(o);o.bindBuffer(o.ARRAY_BUFFER,s.position);var l=o.getAttribLocation(a,"a_position");o.enableVertexAttribArray(l),o.vertexAttribPointer(l,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,s.texture);var c=o.getAttribLocation(a,"a_texCoord");o.enableVertexAttribArray(c),o.vertexAttribPointer(c,2,o.FLOAT,!1,0,0);var u=this.initTexture(o);o.bindTexture(o.TEXTURE_2D,u);var d=o.getUniformLocation(a,"u_scale");return o.uniform2fv(d,[i,i]),o},t.prototype.createShader=function(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(i)),i},t.prototype.initShaderProgram=function(t){var e=this.createShader(t,t.VERTEX_SHADER,"\n          attribute vec2 a_position;\n          attribute vec2 a_texCoord;\n          varying vec2 v_texCoord;\n          uniform vec2 u_scale;\n          void main(void) {\n              gl_Position = vec4(a_position, 0.0, 1.0);\n              v_texCoord = a_texCoord;\n          }\n          "),n=this.createShader(t,t.FRAGMENT_SHADER,"\n          precision lowp float;\n          varying vec2 v_texCoord;\n          uniform sampler2D u_sampler;\n          void main(void) {\n              gl_FragColor = vec4(texture2D(u_sampler, v_texCoord).rgb, texture2D(u_sampler, v_texCoord+vec2(-0.5, 0)).r);\n          }\n          "),i=t.createProgram();return t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),i},t.prototype.initBuffer=function(t){var e=new Float32Array([-1,1,1,1,-1,-1,1,-1]),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW);var i=t.createBuffer(),r=new Float32Array([.5,1,1,1,.5,0,1,0]);return t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),{position:n,texture:i}},t.prototype.initTexture=function(t){var e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e},t}();t.create=function(t){return new e(t)},Object.defineProperty(t,"__esModule",{value:!0})}(e)}(0,T.exports);var S=T.exports,O=function(t){function e(){var t;return o(this,e),(t=r(this,e)).alphaVideo=null,t.attachShadow({mode:"open"}).innerHTML='\n      <style>\n        #wrap {\n          overflow: hidden;\n        }\n      </style>\n      <div id="wrap">\n        <canvas></canvas>\n      </div>\n    ',t}return h(e,t),s(e,[{key:"wrap",get:function(){return this.shadowRoot.querySelector("#wrap")}},{key:"canvas",get:function(){return this.shadowRoot.querySelector("canvas")}},{key:"connectedCallback",value:function(){var t=this,e=this.getAttribute("src"),n=this.getAttribute("width"),i=this.getAttribute("height"),r=null!==this.getAttribute("loop"),o=null!==this.getAttribute("autoplay");!e||!n||!i||(this.wrap.style.setProperty("width","".concat(n,"px")),this.wrap.style.setProperty("height","".concat(i,"px")),this.alphaVideo=S.create({src:e,canvas:this.canvas,width:Number(n),height:Number(i),sizing:"dpr-raw",loop:r}),this.alphaVideo.addEventListener("ended",function(){t.dispatchEvent(new CustomEvent("ended"))}),o&&this.play())}},{key:"play",value:function(){var t;null==(t=this.alphaVideo)||t.play()}},{key:"disconnectedCallback",value:function(){this.alphaVideo&&(this.alphaVideo.dispose(),this.alphaVideo=null)}}])}(C(HTMLElement));customElements.get("bili-alpha-video")||customElements.define("bili-alpha-video",O);var P,I=!0,R=function(){return I&&(I="undefined"==typeof window),I},j=function(){return R(),!1},D=function(){var t,e,n,i;if(R())return!1;if(void 0!==P)return P;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return P=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var r=document.createElement("canvas");P=!!(null===(e=r.getContext)||void 0===e?void 0:e.call(r,"2d"))&&0===(null===(i=null===(n=r.toDataURL)||void 0===n?void 0:n.call(r,"image/webp"))||void 0===i?void 0:i.indexOf("data:image/webp"))}catch(t){P=!1}return P};R()||window.IntersectionObserver;var N=function(t){return function(t){return"number"==typeof t}(t)&&(0|t)===t};var M=/\.(jpeg|jpg|png|webp|gif|avif)$/,L=function(t){return!(!function(t){return!!/\/bfs\//.test(t)}(t)&&!function(t){return/pic.bstarstatic.com/.test(t)}(t))&&!!function(t){var e;return(null===(e=t.match(M))||void 0===e?void 0:e[0])||null}(t)},B=function(t){return"number"!=typeof t||isNaN(t)?0:Math.floor(t)||0};function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}var U="bmgOnLoad",F="bmgOnError",V="__BMG_TRACKER_COLLECT_EXTS__";"function"==typeof SuppressedError&&SuppressedError;var H=function(t){return"function"==typeof t},W="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},$={};Object.defineProperty($,"__esModule",{value:!0});var G=!0,q=$.default=function(){return G&&(G="undefined"==typeof window),G},X={};Object.defineProperty(X,"__esModule",{value:!0});var Z=/\.(jpeg|jpg|png|webp|gif|avif)$/;X.default=function(t){var e;return(null===(e=t.match(Z))||void 0===e?void 0:e[0])||null};!function(t){var e=W&&W.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseAvif=t.canUseAvif=t.setAvif=void 0;var n,i=e($);t.setAvif=function(t){n=t},t.canUseAvif=function(){return!(0,i.default)()&&void 0!==n&&n},t.asyncCanUseAvif=function(){return new Promise(function(e){if((0,i.default)())return e(!1);if((0,t.canUseAvif)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setAvif)(!1),e(!1)},n.onload=function(){(0,t.setAvif)(!0),e(!0)},n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="})}}({});!function(t){var e=W&&W.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseWebP=t.canUseWebP=t.setWebp=void 0;var n,i=e($);t.setWebp=function(t){n=t},t.canUseWebP=function(){var t,e,r,o;if((0,i.default)())return!1;if(void 0!==n)return n;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return n=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var a=document.createElement("canvas");n=!!(null===(e=a.getContext)||void 0===e?void 0:e.call(a,"2d"))&&0===(null===(o=null===(r=a.toDataURL)||void 0===r?void 0:r.call(a,"image/webp"))||void 0===o?void 0:o.indexOf("data:image/webp"))}catch(t){n=!1}return n},t.asyncCanUseWebP=function(){return new Promise(function(e){if((0,i.default)())return e(!1);if((0,t.canUseWebP)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setWebp)(!1),e(!1)},n.onload=function(){(0,t.setWebp)(!0),e(!0)},n.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="})}}({});var Y=null,Q=function(){return!q()&&!function(){if(q())return!1;var t=window.rawWindow;return!!t&&!!t.__MICRO_APP_PROXY_WINDOW__}()&&H(window[U])&&H(window[F])};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.commitLog=t.getSpmId=t.getSpmPrefix=void 0;var e=function(){return"undefined"==typeof window},n="";t.getSpmPrefix=function(){var t,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e())return"";if(n&&!i)return n;try{return n=(null===(t=document.querySelector("meta[name=spm_prefix]"))||void 0===t?void 0:t.content)||""}catch(i){return""}},t.getSpmId=function(e){if(!e)return"";var n=(0,t.getSpmPrefix)();return n?e.indexOf(n)>-1?e:"".concat(n,".").concat(e):""},t.commitLog=function(n,i,r,o){var a,s,l,c;if(!e()&&(window.reportConfig||window.MReporter)&&n&&i){var u=null;if(!u&&window.reportConfig)if(window.reportMsgObj)u=window.reportMsgObj;else{var d=window.reportConfig.msgObjects;u=window[d]||null}var h=i.indexOf("selfDef");if(h>-1)u&&(u[i.substring(h+8)]=r,null===(a=window.reportObserver)||void 0===a||a.forceCommit());else{var p=(0,t.getSpmPrefix)();if(p){var f="object"==z(r)?JSON.stringify(r):JSON.stringify({});if(window.MReporter)return i.indexOf(p)>-1&&(i=i.replace("".concat(p,"."),"")),void(null===(l=(s=window.MReporter)[n])||void 0===l||l.call(s,{evt:i,msg:f,target_url:o||""}));null===(c=window.reportObserver)||void 0===c||c.reportCustomData(n,{spm_id:(0,t.getSpmId)(i),msg:f,target_url:o||""})}}}}}({});var K="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},J={},tt={},et={};Object.defineProperty(et,"__esModule",{value:!0});var nt=!0,it=et.default=function(){return nt&&(nt="undefined"==typeof window),nt};!function(t){var e=K&&K.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseAvif=t.canUseAvif=t.setAvif=void 0;var n,i=e(et);t.setAvif=function(t){n=t};t.canUseAvif=function(){return!(0,i.default)()&&(void 0!==n&&n)};t.asyncCanUseAvif=function(){return new Promise(function(e){if((0,i.default)())return e(!1);if((0,t.canUseAvif)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setAvif)(!1),e(!1)},n.onload=function(){(0,t.setAvif)(!0),e(!0)},n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="})}}(tt);var rt={};!function(t){var e=K&&K.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseWebP=t.canUseWebP=t.setWebp=void 0;var n,i=e(et);t.setWebp=function(t){n=t};t.canUseWebP=function(){var t,e,r,o;if((0,i.default)())return!1;if(void 0!==n)return n;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return n=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var a=document.createElement("canvas");n=!!(null===(e=a.getContext)||void 0===e?void 0:e.call(a,"2d"))&&0===(null===(o=null===(r=a.toDataURL)||void 0===r?void 0:r.call(a,"image/webp"))||void 0===o?void 0:o.indexOf("data:image/webp"))}catch(t){n=!1}return n};t.asyncCanUseWebP=function(){return new Promise(function(e){if((0,i.default)())return e(!1);if((0,t.canUseWebP)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setWebp)(!1),e(!1)},n.onload=function(){(0,t.setWebp)(!0),e(!0)},n.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="})}}(rt);var ot={},at=K&&K.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ot,"__esModule",{value:!0});var st=at(et);ot.default=function(){return!(0,st.default)()&&!!window.HTMLPictureElement},function(t){var e=K&&K.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.autoDetectAll=t.autoDetect=t.canUseHtmlPictureElement=t.canUseWebP=t.setWebp=t.canUseAvif=t.setAvif=void 0;var n=tt;Object.defineProperty(t,"canUseAvif",{enumerable:!0,get:function(){return n.canUseAvif}}),Object.defineProperty(t,"setAvif",{enumerable:!0,get:function(){return n.setAvif}});var i=rt;Object.defineProperty(t,"canUseWebP",{enumerable:!0,get:function(){return i.canUseWebP}}),Object.defineProperty(t,"setWebp",{enumerable:!0,get:function(){return i.setWebp}});var r=e(ot);t.canUseHtmlPictureElement=r.default;t.autoDetect=function(t){void 0===t&&(t=["webp"]);for(var e=0;e<t.length;e++){if("avif"===t[e]&&(0,n.canUseAvif)())return t[e];if("webp"===t[e]&&(0,i.canUseWebP)())return t[e]}return""};t.autoDetectAll=function(){return new Promise(function(t){Promise.all([(0,n.asyncCanUseAvif)(),(0,i.asyncCanUseWebP)()]).then(function(e){var n=e[0],i=e[1];t({avif:n,webp:i})})})}}(J);var lt={},ct={};Object.defineProperty(ct,"__esModule",{value:!0}),ct.default=function(t){return t?t.replace(/^http(s)?:/,""):""};var ut={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.isInt=t.isNum=void 0;t.isNum=function(t){return"number"==typeof t};t.isInt=function(e){return(0,t.isNum)(e)&&(0|e)===e}}(ut);var dt={};Object.defineProperty(dt,"__esModule",{value:!0});var ht=/\.(jpeg|jpg|png|webp|gif|avif)$/;dt.default=function(t){var e;return(null===(e=t.match(ht))||void 0===e?void 0:e[0])||null},function(t){var e=K&&K.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBmgSrc=t.isSupportBmgFormat=void 0;var n=e(ct),i=e(et),r=ut,o=e(dt);t.isSupportBmgFormat=function(t){return!(!function(t){return!!/\/bfs\//.test(t)}(t)&&!function(t){return/pic.bstarstatic.com/.test(t)}(t))&&!!(0,o.default)(t)};var a=function(t){return"number"!=typeof t||isNaN(t)?0:Math.floor(t)||0};t.getBmgSrc=function(e,o){var s;if(void 0===o&&(o={c:!0}),"string"!=typeof e)return"";if(!(0,t.isSupportBmgFormat)(e))return e;if(e.indexOf("@")>-1){if(o.cache)return e;e=e.split("@")[0]}e=e.replace("//pre-","//");var l=o.dpr||((0,i.default)()?2:Math.floor(null!==(s=null===window||void 0===window?void 0:window.devicePixelRatio)&&void 0!==s?s:2)||1),c=[];o.w&&(0,r.isInt)(o.w)&&c.push("".concat(Math.floor(o.w*l),"w")),o.h&&(0,r.isInt)(o.h)&&c.push("".concat(Math.floor(o.h*l),"h")),o.e&&c.push("".concat(o.e,"e")),o.c&&c.push("1c"),o.a&&c.push("".concat([a(o.a.x),a(o.a.y),a(o.a.w)*l,a(o.a.h)*l].join("-"),"a")),o.p&&(0,r.isInt)(o.p)&&c.push("".concat(o.p,"p")),o.s&&c.push("1s"),o.q&&(0,r.isInt)(o.q)&&c.push("".concat(o.q,"q")),o.style&&c.push("!".concat(o.style));var u="";return o.ext&&["webp","avif"].includes(o.ext)&&(u=o.ext),0!==c.length||u?"".concat((0,n.default)(e),"@").concat(c.join("_")).concat(u?".".concat(u):""):e}}(lt);var pt,ft={};function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}Object.defineProperty(ft,"__esModule",{value:!0});var mt="__BMG_TRACKER_COLLECT_QUEUE__",yt="__BMG_TRACKER_COLLECT_EXTS__",bt="__BMG_TRACKER_COLLECT_MODE__",gt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==K?K:"undefined"!=typeof self?self:{},wt={};Object.defineProperty(wt,"__esModule",{value:!0});var xt=!0,kt=wt.default=function(){return xt&&(xt="undefined"==typeof window),xt},At={};Object.defineProperty(At,"__esModule",{value:!0});var _t=/\.(jpeg|jpg|png|webp|gif|avif)$/,Et=At.default=function(t){var e;return(null===(e=t.match(_t))||void 0===e?void 0:e[0])||null},Ct={};!function(t){var e=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseAvif=t.canUseAvif=t.setAvif=void 0;var n,i=e(wt);t.setAvif=function(t){n=t},t.canUseAvif=function(){return!(0,i.default)()&&void 0!==n&&n},t.asyncCanUseAvif=function(){return new Promise(function(e){if((0,i.default)())return e(!1);if((0,t.canUseAvif)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setAvif)(!1),e(!1)},n.onload=function(){(0,t.setAvif)(!0),e(!0)},n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="})}}(Ct);var Tt={};!function(t){var e=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseWebP=t.canUseWebP=t.setWebp=void 0;var n,i=e(wt);t.setWebp=function(t){n=t},t.canUseWebP=function(){var t,e,r,o;if((0,i.default)())return!1;if(void 0!==n)return n;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return n=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var a=document.createElement("canvas");n=!!(null===(e=a.getContext)||void 0===e?void 0:e.call(a,"2d"))&&0===(null===(o=null===(r=a.toDataURL)||void 0===r?void 0:r.call(a,"image/webp"))||void 0===o?void 0:o.indexOf("data:image/webp"))}catch(t){n=!1}return n},t.asyncCanUseWebP=function(){return new Promise(function(e){if((0,i.default)())return e(!1);if((0,t.canUseWebP)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setWebp)(!1),e(!1)},n.onload=function(){(0,t.setWebp)(!0),e(!0)},n.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="})}}(Tt);var St="BMG_EXTS",Ot=null,Pt=function(){if(Ot)return Ot;try{Ot=(localStorage.getItem(St)||"").split(",")}catch(t){console.warn(t),Ot=[]}return Ot},It=function(t){if(void 0===t&&(t=!1),!window[yt]||t){var e=Pt();window[yt]={avif:e.includes("avif"),webp:e.includes("webp")}}},Rt=function(t){return function(e){switch(function(){var t=[],e=window[yt]||{avif:!1,webp:!1};e.avif&&t.push("avif"),e.webp&&t.push("webp");try{localStorage.setItem(St,t.join(","))}catch(t){console.warn(t)}}(),t){case"avif":Ct.setAvif(e);break;case"webp":Tt.setWebp(e)}}},jt=function(t){var e;"object"!=vt(window[yt])&&It(),(null===(e=window[yt])||void 0===e?void 0:e[t])||(window[yt][t]=!0,Rt(t)(!0))},Dt=function(){return window[bt]};ft.collect=function(t,e,n){if(!kt()){var i=kt()?null:window.__BMG_TRACKER__||null;n=n||Dt();var r=(Et(t)||"").substring(1);if(["avif","webp"].indexOf(r)>-1&&jt(r),"onlyext"!==n)if(i)i.collect(t,e);else if("nocache"!==n){var o={src:t,type:e,ts:Date.now()/1e3|0};Array.isArray(window[mt])?window[mt].push(o):window[mt]=[o]}}},ft.getCollectMode=Dt,ft.getLocalExtsState=Pt,pt=ft.getWindowExtsState=function(t){var e,n;return"avif"===t?(null===(e=window[yt])||void 0===e?void 0:e.avif)||!1:"webp"===t?(null===(n=window[yt])||void 0===n?void 0:n.webp)||!1:window[yt]||null},ft.initWindowExtsState=It,ft.setCollectMode=function(t){window[bt]=t},ft.updateExtState=Rt,ft.updateWindowExtsState=jt;var Nt=new RegExp(function(t,e){return"".concat(t).concat(e,".hdslb.com")}("(s|i)","\\d")),Mt=function(t){if(it())return t||"";var e=window.__BMG_AF__;return(null==e?void 0:e.defDomain)?(e.defUpdated,e.defDomain):t||""},Lt=function(t,e){var n;if(!e)return t;var i=(null===(n=t.match(Nt))||void 0===n?void 0:n[0])||"";return i&&i!==e?t.replace(Nt,e):t},Bt=function(t,e,n){var i,r,o,a,s="";if(it())return lt.getBmgSrc((null==n?void 0:n.domain)?Lt(t,n.domain):t,e);if(!(null===(i=null==n?void 0:n.disabledExts)||void 0===i?void 0:i.avif)&&pt("avif"))s="avif";else if(!(null===(r=null==n?void 0:n.disabledExts)||void 0===r?void 0:r.webp)&&pt("webp"))s="webp";else{var l=[];(null===(o=null==n?void 0:n.disabledExts)||void 0===o?void 0:o.avif)||l.push("avif"),(null===(a=null==n?void 0:n.disabledExts)||void 0===a?void 0:a.webp)||l.push("webp"),l.length&&(s=J.autoDetect(l))}return lt.getBmgSrc(Lt(t,Mt(null==n?void 0:n.domain)),Object.assign(Object.assign({},e),{ext:s}))},zt=function(t,e,n){n=(null==n?void 0:n.filter(Boolean))||[];var i="img"===t?">":">".concat(n.length?n.join(""):"","</").concat(t,">");return"<".concat(t," ").concat(Object.keys(e).filter(function(t){return"string"==typeof e[t]}).map(function(t){return"".concat(t,'="').concat((n=e[t]||"")?n.replace(i||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(t,e){return e?t:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[t]||""}):"",'"');var n,i}).join(" ")," ").concat(i)},Ut=function(t){return t?"".concat(t,"(this)"):""},Ft=function(t,e){return-1===t.indexOf("@")?"".concat(t,"@.").concat(e):(t=t.replace(new RegExp(".(avif|webp)$"),""),"".concat(t,".").concat(e))},Vt=function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return R()?"":n&&(null===(t=window[V])||void 0===t?void 0:t.avif)?"avif":(null===(e=window[V])||void 0===e?void 0:e.webp)?"webp":function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["webp"],e=0;e<t.length;e++){if("avif"===t[e]&&j())return t[e];if("webp"===t[e]&&D())return t[e]}return""}()},Ht=function(t,e,n){var i,r,o=[],a="";e.class?(o.push(e.class),a=o.join(" ")):a="",t=Lt(t,Mt(null==n?void 0:n.domain));var s=!!(null===(i=null==n?void 0:n.exts)||void 0===i?void 0:i.avif),l=!1!==(null===(r=null==n?void 0:n.exts)||void 0===r?void 0:r.webp),c=!(s||l),u=!!(null==n?void 0:n.performance),d=L(t)&&((null==n?void 0:n.tag)?"picture"===n.tag:!R()&&!!window.HTMLPictureElement),h=Q(),p={};if("object"===_(e.dataset))for(var f in e.dataset)p["data-".concat(f)]=e.dataset[f];var v=c?void 0:Vt(u&&s),m=!1;u&&(s&&"avif"===v||l&&"webp"===v||c&&""===v)&&(m=!0),!m&&d&&!0===(null==n?void 0:n.safe)&&(v=void 0,R()&&(h=!0));var y=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{c:!0};if("string"!=typeof t)return"";if(!L(t))return t;if(t.indexOf("@")>-1){if(n.cache)return t;t=t.split("@")[0]}t=t.replace("//pre-","//");var i=n.dpr||(R()?2:Math.floor(null!==(e=null===window||void 0===window?void 0:window.devicePixelRatio)&&void 0!==e?e:2)||1),r=[];n.w&&N(n.w)&&r.push("".concat(Math.floor(n.w*i),"w")),n.h&&N(n.h)&&r.push("".concat(Math.floor(n.h*i),"h")),n.e&&r.push("".concat(n.e,"e")),n.c&&r.push("1c"),n.a&&r.push("".concat([B(n.a.x),B(n.a.y),B(n.a.w)*i,B(n.a.h)*i].join("-"),"a")),n.p&&N(n.p)&&r.push("".concat(n.p,"p")),n.s&&r.push("1s"),n.q&&N(n.q)&&r.push("".concat(n.q,"q")),n.style&&r.push("!".concat(n.style));var o,a="";return n.ext&&["webp","avif"].includes(n.ext)&&(a=n.ext),0!==r.length||a?"".concat((o=t,o?o.replace(/^http(s)?:/,""):""),"@").concat(r.join("_")).concat(a?".".concat(a):""):t}(t,Object.assign({},e,{ext:v})),b=zt("img",Object.assign({src:y,class:m||!d?a:null,alt:e.alt||null,loading:(null==e?void 0:e.loading)?"lazy":null,onload:h?Ut(U):Ut((null==n?void 0:n.onload)||"")||null,onerror:h?Ut(F):Ut((null==n?void 0:n.onerror)||"")||null,"data-onload":h&&(null==n?void 0:n.onload)||null,"data-onerror":h&&(null==n?void 0:n.onerror)||null},p));return m?b:d?zt("picture",{class:a||null},[s&&zt("source",{type:"image/avif",srcset:Ft(y,"avif")})||"",l&&zt("source",{type:"image/webp",srcset:Ft(y,"webp")})||"",b]):b};"undefined"!=typeof window&&function(t){if(void 0===t&&(t=!1),!window[V]||t){var e=function(){if(Y)return Y;try{Y=(localStorage.getItem("BMG_EXTS")||"").split(",")}catch(t){console.warn(t),Y=[]}return Y}();window[V]={avif:e.includes("avif"),webp:e.includes("webp")}}}();var Wt=function(){return{group_id:"",layers:[{layer_id:"",layer_config:{allow_over_paint:!1,is_critical:!0,layer_mask:null,tags:{AVATAR_LAYER:{config_type:0},GENERAL_CONFIG:{config_type:1,general_config:{web_css_style:{borderRadius:"50%"}}}}},general_spec:{pos_spec:{axis_x:.675,axis_y:.675,coordinate_pos:2},render_spec:{opacity:1},size_spec:{height:1,width:1}},visible:!0,resource:{res_type:3,res_image:{image_src:{src_type:2,placeholder:6,local:6}}}}],group_mask:null,is_critical_group:!0}},$t="onAvtSrcError",Gt={animationWebpSrc:0,maskImageStyle:0},qt=function(t,e){Gt[t]=e?1:2},Xt=function(){return s(function t(e,n){o(this,t),this.payload=e,this.size=n,this.layers=[],this.id=e.group_id,this.createElement()},[{key:"createElement",value:function(){this.el=document.createElement("div"),this.el.classList.add("layers")}},{key:"render",value:function(){var t=i(m().m(function t(){var e,n=this;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Promise.all(this.payload.layers.filter(function(t){return!!t.visible}).map(function(t){return n.addLayer(t,n.size)}));case 1:return t.a(2,this);case 2:return t.p=2,e=t.v,t.a(2,Promise.reject(e))}},t,this,[[0,2]])}));return function(){return t.apply(this,arguments)}}()},{key:"addLayer",value:(t=i(m().m(function t(e,n){var i,r;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,new Qt(e,n).render();case 1:i=t.v,this.layers.push(i),this.el.appendChild(i.el),t.n=3;break;case 2:return t.p=2,r=t.v,t.a(2,Promise.reject(r));case 3:return t.a(2)}},t,this,[[0,2]])})),function(e,n){return t.apply(this,arguments)})},{key:"removeLayer",value:function(t){var e=this.layers.findIndex(function(e){return e.id===t});if(e>-1){var n=this.layers[e];this.el.removeChild(n.el),this.layers.splice(e,1)}}}]);var t}(),Zt=function(){return s(function t(e,n){switch(o(this,t),this.localSrcList=["//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local1.png","//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local2.png","//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local3.png","//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local4.png","//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local5.png","//i0.hdslb.com/bfs/seed/jinkela/short/webui/avatar/img/res-local6.jpeg"],this.type=e.res_type,this.createElement(),this.type){case 3:this.loadLocal(e.res_image.image_src.placeholder),this.load(e.res_image.image_src,n);break;case 4:this.play(e.res_animation.webp_src,n);break;case 5:this.draw(e.res_native_draw.draw_src.draw)}},[{key:"createElement",value:function(){this.el=document.createElement("div"),this.el.classList.add("layer-res")}},{key:"registerHandler",value:function(){var t=window;t[$t]||(t[$t]=function(t){t.style.opacity="0"})}},{key:"setStyle",value:function(t,e){this.el.style[t]=e}},{key:"draw",value:function(t){var e,n=t.draw_type,i=t.fill_mode,r=t.color_config;1===n&&this.setStyle("borderRadius","50%"),1===i&&this.setStyle("backgroundColor",null==(e=null==r?void 0:r.day)?void 0:e.argb)}},{key:"play",value:(t=i(m().m(function t(e,n){var i,r,o;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:i=e.src_type,r=i,t.n=1===r?1:2===r?3:3===r?4:5;break;case 1:return t.p=1,t.a(2,(this.setStyle("background","url(".concat(Bt(e.remote.url,{w:Math.floor(n.width),h:Math.floor(n.height),c:!0,dpr:2}),") center / cover no-repeat")),!0));case 2:return t.p=2,o=t.v,t.a(2,Promise.reject(o));case 3:return t.a(2,(this.loadLocal(e.local),!0));case 4:return t.a(2,(this.draw(e.draw),!0));case 5:return t.a(2,!0);case 6:return t.a(2)}},t,this,[[1,2]])})),function(e,n){return t.apply(this,arguments)})},{key:"load",value:function(t,e){switch(t.src_type){case 1:this.registerHandler(),this.el.innerHTML=Ht(t.remote.url,{w:Math.floor(e.width),h:Math.floor(e.height),s:!0,c:!0,dpr:2},{onerror:$t,exts:{avif:!0}});break;case 2:this.loadLocal(t.local);break;case 3:this.draw(t.draw)}}},{key:"loadLocal",value:function(t){var e=Math.floor(t)-1;e>-1&&this.localSrcList[e]&&this.setStyle("backgroundImage","url(".concat(this.localSrcList[e],")"))}}]);var t}(),Yt=function(t,e){return new Promise(function(n,i){if(!t)return i();var r=new Image;r.crossOrigin="anonymous",r.src=t,r.onload=function(){if(!e)return n(t);e(r).then(n).catch(i)},r.onerror=function(){i()}})},Qt=function(){return s(function t(e,n){o(this,t),this.payload=e,this.size=n,this.id=e.layer_id,this.createElement()},[{key:"createElement",value:function(){this.el=document.createElement("div"),this.el.classList.add("layer")}},{key:"render",value:(e=i(m().m(function t(){var e;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,this.renderGeneralSpec(),t.n=1,this.renderResource();case 1:return this.renderTag(),this.renderMask(),t.a(2,this);case 2:return t.p=2,e=t.v,t.a(2,Promise.reject(e))}},t,this,[[0,2]])})),function(){return e.apply(this,arguments)})},{key:"renderGeneralSpec",value:function(){var t=this.payload.general_spec;t.pos_spec&&(2===t.pos_spec.coordinate_pos?this.el.classList.add("center"):(this.el.style.left="".concat(t.pos_spec.axis_x*this.size.width,"px"),this.el.style.top="".concat(t.pos_spec.axis_y*this.size.height,"px"))),t.size_spec&&(this.size={width:t.size_spec.width*this.size.width,height:t.size_spec.height*this.size.height},this.el.style.width="".concat(this.size.width,"px"),this.el.style.height="".concat(this.size.height,"px")),t.render_spec&&"number"==typeof t.render_spec.opacity&&(this.el.style.opacity=String(t.render_spec.opacity))}},{key:"renderTag",value:function(){var t,e=null==(t=this.payload.layer_config)?void 0:t.tags;if(e)for(var n in e){var i=e[n],r=i.config_type,o=i.general_config;if(1===r&&o){var a=o.web_css_style;if(a)for(var s in a)this.el.style[s]=a[s]}}}},{key:"renderMask",value:(t=i(m().m(function t(){var e,n,i,r,o,a,s;return m().w(function(t){for(;;)switch(t.n){case 0:if(i=null==(e=this.payload.layer_config)?void 0:e.layer_mask){t.n=1;break}return t.a(2);case 1:if(1!==(r=i.mask_src).src_type){t.n=6;break}s=Gt.maskImageStyle,t.n=0===s?2:2===s?3:4;break;case 2:return qt("maskImageStyle",!0),t.a(3,4);case 3:throw new Error("Not support [maskImageStyle]");case 4:return o=Bt(r.remote.url,{w:Math.round(this.size.width),h:Math.round(this.size.height)}),t.n=5,Yt(o);case 5:a=t.v,this.resource.setStyle("-webkit-mask-image","url(".concat(a,")")),this.resource.setStyle("-webkit-mask-size","cover"),t.n=7;break;case 6:3===(null==r?void 0:r.src_type)&&1===(null==(n=r.draw)?void 0:n.draw_type)&&this.resource.setStyle("borderRadius","50%");case 7:return t.a(2)}},t,this)})),function(){return t.apply(this,arguments)})},{key:"renderResource",value:function(){this.resource=new Zt(this.payload.resource,this.size),this.el.appendChild(this.resource.el)}}]);var t,e}(),Kt=("undefined"==typeof globalThis?"undefined":_(globalThis))<"u"?globalThis:("undefined"==typeof window?"undefined":_(window))<"u"?window:("undefined"==typeof global?"undefined":_(global))<"u"?global:("undefined"==typeof self?"undefined":_(self))<"u"?self:{},Jt={},te={};Object.defineProperty(te,"__esModule",{value:!0});var ee=!0;te.default=function(){return ee&&(ee=("undefined"==typeof window?"undefined":_(window))>"u"),ee};var ne=Kt&&Kt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Jt,"__esModule",{value:!0});var ie=Jt.unobserve=se=Jt.observe=void 0,re=ne(te),oe=null;(0,re.default)()||window.IntersectionObserver;var ae=function(t,e){t.forEach(function(t){var e,n;null===(n=null===(e=t.target)||void 0===e?void 0:e.__i18r_callback__)||void 0===n||n.call(e,t)})},se=Jt.observe=function(t,e){(0,re.default)()||(oe||(oe=new IntersectionObserver(ae)),t.__i18r_callback__=e,oe.observe(t))};ie=Jt.unobserve=function(t){var e;oe&&(null===(e=oe.unobserve)||void 0===e||e.call(oe,t),delete t.__i18r_callback__)};var le=function(t){function e(){var t;return o(this,e),(t=r(this,e)).loaded=!1,t.size={width:0,height:0},t.config={baseSize:0,isFloat:!1,lazyload:!1},t.layers=[],t.attachShadow({mode:"open"}),t.shadowRoot&&(t.shadowRoot.innerHTML='\n        <style>\n          :host {\n            display: inline-block;\n            position: relative;\n            width: var(--avatar-width);\n            height: var(--avatar-height);\n          }\n          #canvas {\n            width: var(--avatar-canvas-width);\n            height: var(--avatar-canvas-height);\n            position: absolute;\n            left: 50%;\n            top: 50%;\n            transform: translate(-50%, -50%);\n            pointer-events: none;\n          }\n          .layers {\n            position: absolute;\n            left: 0;\n            right: 0;\n            top: 0;\n            bottom: 0;\n          }\n          .layer {\n            position: absolute;\n            isolation: isolate;\n            overflow: hidden;\n          }\n          .layer.center {\n            left: 50%;\n            top: 50%;\n            transform: translate(-50%, -50%);\n          }\n          .layer-res {\n            width: 100%;\n            height: 100%;\n            isolation: isolate;\n            overflow: hidden;\n            background-size: cover;\n            background-repeat: no-repeat;\n            background-position: center;\n          }\n          .layer-res picture {\n            display: inline-block;\n          }\n          .layer-res div,\n          .layer-res picture,\n          .layer-res img {\n            width: 100%;\n            height: 100%;\n          }\n        </style>\n        <div id="canvas"></div>\n      ',t.canvasElement=t.shadowRoot.querySelector("#canvas")),t}return h(e,t),s(e,[{key:"disconnectedCallback",value:function(){this.config.lazyload&&!this.loaded&&ie(this.canvasElement),this.clearCanvas(),this.clearLayers(),this.loaded=!1}},{key:"load",value:function(t,e){var n={width:0,height:0};"number"==typeof e?(n.width=e,n.height=e):"object"==_(e)?("number"==typeof e.baseSize?(n.width=e.baseSize,n.height=e.baseSize):"object"==_(e.baseSize)?(n.width=e.baseSize.width,n.height=e.baseSize.height):console.warn("Not found 'baseSize' in Avatar Config"),this.config.isFloat=e.isFloat||!1,this.config.lazyload=e.lazyload||!1):console.warn("Not found 'baseSize' in Avatar Config"),this.size=v({},n),this.config.baseSize=n,this.initCanvas(t),this.renderLayers(t)}},{key:"renderLayers",value:function(t){var e,n=this;if(this.config.lazyload&&!this.loaded)return this.renderDefaultLayers(),void se(this.canvasElement,function(e){e.isIntersecting&&(n.loaded=!0,n.renderLayers(t),ie(n.canvasElement))});null!=(e=t.layers)&&e.length?this.renderNormalLayers(t):t.fallback_layers&&this.renderFallbackLayers(t.fallback_layers)}},{key:"initCanvas",value:function(t){var e=this.size.width*t.container_size.width,n=this.size.height*t.container_size.height;this.config.isFloat?(this.style.setProperty("--avatar-width","".concat(this.size.width,"px")),this.style.setProperty("--avatar-height","".concat(this.size.height,"px"))):(this.style.setProperty("--avatar-width",e+"px"),this.style.setProperty("--avatar-height",n+"px")),this.canvasElement.style.setProperty("--avatar-canvas-width",e+"px"),this.canvasElement.style.setProperty("--avatar-canvas-height",n+"px")}},{key:"renderDefaultLayers",value:(c=i(m().m(function t(){return m().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.addLayerGroup(Wt(),this.size);case 1:this.renderCanvas();case 2:return t.a(2)}},t,this)})),function(){return c.apply(this,arguments)})},{key:"renderNormalLayers",value:(l=i(m().m(function t(e){var n=this;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Promise.all(e.layers.map(function(t){return n.addLayerGroup(t,n.size)}));case 1:this.renderCanvas(),t.n=3;break;case 2:return t.p=2,t.v,this.clearCanvas(),this.clearLayers(),this.renderFallbackLayers(e.fallback_layers),t.a(2);case 3:return t.a(2)}},t,this,[[0,2]])})),function(t){return l.apply(this,arguments)})},{key:"renderFallbackLayers",value:(a=i(m().m(function t(e){return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.addLayerGroup(e,this.size);case 1:this.renderCanvas(),t.n=3;break;case 2:t.p=2,t.v,this.clearCanvas(),this.clearLayers(),this.renderDefaultLayers();case 3:return t.a(2)}},t,this,[[0,2]])})),function(t){return a.apply(this,arguments)})},{key:"clearCanvas",value:function(){var t=this;Array.from(this.canvasElement.children).forEach(function(e){t.canvasElement.removeChild(e)})}},{key:"clearLayers",value:function(){this.layers=[]}},{key:"renderCanvas",value:function(){var t=this;this.clearCanvas(),this.layers.forEach(function(e){t.canvasElement.appendChild(e.el)})}},{key:"addLayerGroup",value:(n=i(m().m(function t(e,n){var i,r;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,new Xt(e,n).render();case 1:i=t.v,this.layers.push(i),t.n=3;break;case 2:return t.p=2,r=t.v,t.a(2,Promise.reject(r));case 3:return t.a(2)}},t,this,[[0,2]])})),function(t,e){return n.apply(this,arguments)})}]);var n,a,l,c}(C(HTMLElement));customElements.get("bili-avatar")||customElements.define("bili-avatar",le);var ce=function(){function t(){o(this,t),this.disposables=[]}return s(t,[{key:"addEventListener",value:function(t,e,n,i){return this.add(function(t,e,n,i){return t.addEventListener(e,n,i),function(){!function(t,e,n,i){t.removeEventListener(e,n,i)}(t,e,n,i)}}(t,e,n,i))}},{key:"mutationObserve",value:function(t,e,n){var i=!1,r=new MutationObserver(e);return r.observe(t,n),function(){return function(t){i||(i=!0,t.disconnect())}(r)}}},{key:"requestAnimationFrame",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=requestAnimationFrame.apply(void 0,arguments);return this.add(function(){return cancelAnimationFrame(t)})})},{key:"nextFrame",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.requestAnimationFrame(function(){return t.requestAnimationFrame.apply(t,n)})}},{key:"setTimeout",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=setTimeout.apply(void 0,arguments);return this.add(function(){return clearTimeout(t)})})},{key:"microTask",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i={current:!0};return function(t){"function"==typeof queueMicrotask?queueMicrotask(t):Promise.resolve().then(t).catch(function(t){return setTimeout(function(){throw t})})}(function(){i.current&&e[0]()}),this.add(function(){i.current=!1})}},{key:"style",value:function(t,e,n){var i=t.style.getPropertyValue(e);return Object.assign(t.style,c({},e,n)),this.add(function(){Object.assign(t.style,c({},e,i))})}},{key:"group",value:function(e){var n=new t;return e(n),this.add(function(){return n.dispose()})}},{key:"add",value:function(t){var e=this;return this.disposables.push(t),function(){var n=e.disposables.indexOf(t);n>=0&&e.remove(n,1)}}},{key:"remove",value:function(t,e){var n,i=l(this.disposables.splice(t,null!=e?e:this.disposables.length));try{for(i.s();!(n=i.n()).done;){(0,n.value)()}}catch(t){i.e(t)}finally{i.f()}}},{key:"dispose",value:function(){this.remove(0)}}])}();("undefined"==typeof window?"undefined":_(window))<"u"&&(window.__BILI_POPPER_ZINDEX__||(window.__BILI_POPPER_ZINDEX__=1e3));var ue=function(t){function e(){var t;return o(this,e),(t=r(this,e)).disposables=new ce,t.state={label:"",value:"",name:"",disabled:!1,checked:!1},t.attachShadow({mode:"open"}),t.shadowRoot&&(t.shadowRoot.innerHTML='\n        <style>\n          :host {\n            --bili-checkbox-size: 16px;\n            --bili-checkbox-font-size: 14px;\n            --bili-checkbox-border-width: 1px;\n            --bili-checkbox-border-radius: 2px;\n            --bili-checkbox-checked-color: var(--brand_blue);\n            --bili-checkbox-margin-inline-end: 8px;\n\n            display: inline-flex;\n            align-items: baseline;\n            padding: 0;\n            margin: 0;\n            cursor: pointer;\n            margin-inline-end: var(--bili-checkbox-margin-inline-end);\n          }\n          #input {\n            box-sizing: border-box;\n            margin: 0;\n            padding: 0;\n            list-style: none;\n            position: relative;\n            display: inline-block;\n            outline: none;\n            cursor: pointer;\n            align-self: center;\n            border-radius: var(--bili-checkbox-border-radius);\n            width: var(--bili-checkbox-size);\n            height: var(--bili-checkbox-size);\n          }\n          #input input {\n            bottom: 0;\n            left: 0;\n            margin: 0;\n            opacity: 0;\n            outline: none;\n            position: absolute;\n            right: 0;\n            top: 0;\n            z-index: -1;\n          }\n          #input #inner {\n            display: block;\n            background-color: var(--bg1_float);\n            border: 1px solid var(--text4);\n            border-radius: var(--bili-checkbox-border-radius);\n            box-sizing: border-box;\n            width: 100%;\n            height: 100%;\n            transition: all .3s ease-in-out;\n          }\n          #input #inner:hover {\n            border-color: var(--bili-checkbox-checked-color);\n          }\n          #input[checked] #inner {\n            border-color: var(--bili-checkbox-checked-color);\n            background-color: var(--bili-checkbox-checked-color);\n          }\n          #input[checked] #inner::after {\n            transform: rotate(45deg) scale(1) translate(-65%, -50%);\n            opacity: 1;\n          }\n          #input #inner::after {\n            content: "";\n            position: absolute;\n            top: 50%;\n            left: 25%;\n            display: table;\n            width: 4px;\n            height: 8px;\n            border: 2px solid var(--text_white);\n            opacity: 0;\n            border-top: 0;\n            border-left: 0;\n            transition: all .3s ease-in-out;\n            transform: rotate(45deg) scale(0) translate(-50%, -50%);\n          }\n          #label {\n            margin-left: 8px;\n            font-size: var(--bili-checkbox-font-size);\n            color: var(--text2);\n          }\n        </style>\n        <span id="input">\n          <input type="checkbox">\n          <span id="inner"></span>\n        </span>\n        <slot>\n          <span id="label"></span>\n        </slot>\n      '),t}return h(e,t),s(e,[{key:"connectedCallback",value:function(){var t=this;if(this.shadowRoot){var n=this.getAttribute("label");e.observedAttributes.forEach(function(e){var i=t.getAttribute(e);null!==i&&("value"===e&&!n&&t.updateAttribute("label",i),t.updateAttribute(e,i))}),this.shadowRoot&&this.disposables.addEventListener(this,"click",function(){if(!t.state.disabled){t.state.checked=!t.state.checked,t.updateInput("checked",t.state.checked);var e={name:t.state.name,value:t.state.value,checked:t.state.checked},n=new CustomEvent("change",{detail:e});t.parentElement&&t.parentElement.isCheckboxGroup&&t.parentElement.onCheckboxChange(n),t.dispatchEvent(n)}})}}},{key:"disconnectedCallback",value:function(){this.disposables.dispose()}},{key:"updateInput",value:function(t,e){var n,i,r=null==(n=this.shadowRoot)?void 0:n.querySelector("#input"),o=null==(i=this.shadowRoot)?void 0:i.querySelector("input");if(r&&o)switch(t){case"value":o.setAttribute(t,e);break;case"disabled":case"checked":e?(r.setAttribute(t,""),o.setAttribute(t,"")):(r.removeAttribute(t),o.removeAttribute(t))}}},{key:"updateLabel",value:function(t){var e,n=null==(e=this.shadowRoot)?void 0:e.querySelector("#label");n&&(n.textContent=t)}},{key:"updateAttribute",value:function(t,e){switch(t){case"name":this.state.name=e;break;case"label":this.updateLabel(e),this.state.label=e;break;case"value":this.updateInput(t,e),this.state[t]=e;break;case"disabled":case"checked":this.updateInput(t,"true"===e),this.state[t]="true"===e}}},{key:"attributeChangedCallback",value:function(t,e,n){this.updateAttribute(t,n)}}],[{key:"observedAttributes",get:function(){return["name","value","label","disabled","checked"]}}])}(C(HTMLElement));ue.elName="bili-checkbox";var de=ue,he=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).isCheckboxGroup=!0,t.valueList=[],t}return h(e,t),s(e,[{key:"onCheckboxChange",value:function(t){var e=t.detail,n=e.value;if(e.checked){if(this.valueList.includes(n))return;return this.valueList.push(n),void this.dispatchEvent(new CustomEvent("change",{detail:k(this.valueList)}))}var i=this.valueList.indexOf(n);-1!==i&&(this.valueList.splice(i,1),this.dispatchEvent(new CustomEvent("change",{detail:k(this.valueList)})))}}])}(C(HTMLElement));he.elName="bili-checkbox-group",customElements.get(de.elName)||(customElements.define(de.elName,de),customElements.define(he.elName,he));
/**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
var pe,fe,ve=window,me=ve.ShadowRoot&&(void 0===ve.ShadyCSS||ve.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,ye=Symbol(),be=new WeakMap,ge=function(){return s(function t(e,n,i){if(o(this,t),this._$cssResult$=!0,i!==ye)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n},[{key:"styleSheet",get:function(){var t=this.o,e=this.t;if(me&&void 0===t){var n=void 0!==e&&1===e.length;n&&(t=be.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),n&&be.set(e,t))}return t}},{key:"toString",value:function(){return this.cssText}}])}(),we=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r=1===t.length?t[0]:n.reduce(function(e,n,i){return e+function(t){if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")}(n)+t[i+1]},t[0]);return new ge(r,t,ye)},xe=me?function(t){return t}:function(t){return t instanceof CSSStyleSheet?function(t){var e,n="",i=l(t.cssRules);try{for(i.s();!(e=i.n()).done;){n+=e.value.cssText}}catch(t){i.e(t)}finally{i.f()}return function(t){return new ge("string"==typeof t?t:t+"",void 0,ye)}(n)}(t):t},ke=window,Ae=ke.trustedTypes,_e=Ae?Ae.emptyScript:"",Ee=ke.reactiveElementPolyfillSupport,Ce={toAttribute:function(t,e){switch(e){case Boolean:t=t?_e:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute:function(t,e){var n=t;switch(e){case Boolean:n=null!==t;break;case Number:n=null===t?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch(t){n=null}}return n}},Te=function(t,e){return e!==t&&(e==e||t==t)},Se={attribute:!0,type:String,converter:Ce,reflect:!1,hasChanged:Te},Oe="finalized",Pe=function(t){function e(){var t;return o(this,e),(t=r(this,e))._$Ei=new Map,t.isUpdatePending=!1,t.hasUpdated=!1,t._$El=null,t._$Eu(),t}return h(e,t),s(e,[{key:"_$Eu",value:function(){var t,e=this;this._$E_=new Promise(function(t){return e.enableUpdating=t}),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach(function(t){return t(e)})}},{key:"addController",value:function(t){var e,n;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(n=t.hostConnected)||void 0===n||n.call(t))}},{key:"removeController",value:function(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}},{key:"_$Eg",value:function(){var t=this;this.constructor.elementProperties.forEach(function(e,n){t.hasOwnProperty(n)&&(t._$Ei.set(n,t[n]),delete t[n])})}},{key:"createRenderRoot",value:function(){var t,e=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return function(t,e){me?t.adoptedStyleSheets=e.map(function(t){return t instanceof CSSStyleSheet?t:t.styleSheet}):e.forEach(function(e){var n=document.createElement("style"),i=ve.litNonce;void 0!==i&&n.setAttribute("nonce",i),n.textContent=e.cssText,t.appendChild(n)})}(e,this.constructor.elementStyles),e}},{key:"connectedCallback",value:function(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach(function(t){var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)})}},{key:"enableUpdating",value:function(t){}},{key:"disconnectedCallback",value:function(){var t;null===(t=this._$ES)||void 0===t||t.forEach(function(t){var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)})}},{key:"attributeChangedCallback",value:function(t,e,n){this._$AK(t,n)}},{key:"_$EO",value:function(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Se,r=this.constructor._$Ep(t,i);if(void 0!==r&&!0===i.reflect){var o=(void 0!==(null===(n=i.converter)||void 0===n?void 0:n.toAttribute)?i.converter:Ce).toAttribute(e,i.type);this._$El=t,null==o?this.removeAttribute(r):this.setAttribute(r,o),this._$El=null}}},{key:"_$AK",value:function(t,e){var n,i=this.constructor,r=i._$Ev.get(t);if(void 0!==r&&this._$El!==r){var o=i.getPropertyOptions(r),a="function"==typeof o.converter?{fromAttribute:o.converter}:void 0!==(null===(n=o.converter)||void 0===n?void 0:n.fromAttribute)?o.converter:Ce;this._$El=r,this[r]=a.fromAttribute(e,o.type),this._$El=null}}},{key:"requestUpdate",value:function(t,e,n){var i=!0;void 0!==t&&(((n=n||this.constructor.getPropertyOptions(t)).hasChanged||Te)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===n.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,n))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}},{key:"_$Ej",value:(n=i(m().m(function t(){var e,n;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return this.isUpdatePending=!0,t.p=1,t.n=2,this._$E_;case 2:t.n=4;break;case 3:t.p=3,n=t.v,Promise.reject(n);case 4:if(null==(e=this.scheduleUpdate())){t.n=5;break}return t.n=5,e;case 5:return t.a(2,!this.isUpdatePending)}},t,this,[[1,3]])})),function(){return n.apply(this,arguments)})},{key:"scheduleUpdate",value:function(){return this.performUpdate()}},{key:"performUpdate",value:function(){var t,e=this;if(this.isUpdatePending){this.hasUpdated,this._$Ei&&(this._$Ei.forEach(function(t,n){return e[n]=t}),this._$Ei=void 0);var n=!1,i=this._$AL;try{(n=this.shouldUpdate(i))?(this.willUpdate(i),null===(t=this._$ES)||void 0===t||t.forEach(function(t){var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)}),this.update(i)):this._$Ek()}catch(t){throw n=!1,this._$Ek(),t}n&&this._$AE(i)}}},{key:"willUpdate",value:function(t){}},{key:"_$AE",value:function(t){var e;null===(e=this._$ES)||void 0===e||e.forEach(function(t){var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}},{key:"_$Ek",value:function(){this._$AL=new Map,this.isUpdatePending=!1}},{key:"updateComplete",get:function(){return this.getUpdateComplete()}},{key:"getUpdateComplete",value:function(){return this._$E_}},{key:"shouldUpdate",value:function(t){return!0}},{key:"update",value:function(t){var e=this;void 0!==this._$EC&&(this._$EC.forEach(function(t,n){return e._$EO(n,e[n],t)}),this._$EC=void 0),this._$Ek()}},{key:"updated",value:function(t){}},{key:"firstUpdated",value:function(t){}}],[{key:"addInitializer",value:function(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}},{key:"observedAttributes",get:function(){var t=this;this.finalize();var e=[];return this.elementProperties.forEach(function(n,i){var r=t._$Ep(i,n);void 0!==r&&(t._$Ev.set(r,i),e.push(r))}),e}},{key:"createProperty",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Se;if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){var n="symbol"==_(t)?Symbol():"__"+t,i=this.getPropertyDescriptor(t,n,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}}},{key:"getPropertyDescriptor",value:function(t,e,n){return{get:function(){return this[e]},set:function(i){var r=this[t];this[e]=i,this.requestUpdate(t,r,n)},configurable:!0,enumerable:!0}}},{key:"getPropertyOptions",value:function(t){return this.elementProperties.get(t)||Se}},{key:"finalize",value:function(){if(this.hasOwnProperty(Oe))return!1;this[Oe]=!0;var t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=k(t.h)),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){var e,n=this.properties,i=l([].concat(k(Object.getOwnPropertyNames(n)),k(Object.getOwnPropertySymbols(n))));try{for(i.s();!(e=i.n()).done;){var r=e.value;this.createProperty(r,n[r])}}catch(t){i.e(t)}finally{i.f()}}return this.elementStyles=this.finalizeStyles(this.styles),!0}},{key:"finalizeStyles",value:function(t){var e=[];if(Array.isArray(t)){var n,i=l(new Set(t.flat(1/0).reverse()));try{for(i.s();!(n=i.n()).done;){var r=n.value;e.unshift(xe(r))}}catch(t){i.e(t)}finally{i.f()}}else void 0!==t&&e.push(xe(t));return e}},{key:"_$Ep",value:function(t,e){var n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}}]);var n}(C(HTMLElement));Pe[Oe]=!0,Pe.elementProperties=new Map,Pe.elementStyles=[],Pe.shadowRootOptions={mode:"open"},null==Ee||Ee({ReactiveElement:Pe}),(null!==(pe=ke.reactiveElementVersions)&&void 0!==pe?pe:ke.reactiveElementVersions=[]).push("1.6.3");var Ie=window,Re=Ie.trustedTypes,je=Re?Re.createPolicy("lit-html",{createHTML:function(t){return t}}):void 0,De="$lit$",Ne="lit$".concat((Math.random()+"").slice(9),"$"),Me="?"+Ne,Le="<".concat(Me,">"),Be=document,ze=function(){return Be.createComment("")},Ue=function(t){return null===t||"object"!=_(t)&&"function"!=typeof t},Fe=Array.isArray,Ve=function(t){return Fe(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator])},He="[ \t\n\f\r]",We=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,$e=/-->/g,Ge=/>/g,qe=RegExp(">|".concat(He,"(?:([^\\s\"'>=/]+)(").concat(He,"*=").concat(He,"*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)"),"g"),Xe=/'/g,Ze=/"/g,Ye=/^(?:script|style|textarea|title)$/i,Qe=function(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return{_$litType$:t,strings:e,values:i}}}(1),Ke=Symbol.for("lit-noChange"),Je=Symbol.for("lit-nothing"),tn=new WeakMap,en=Be.createTreeWalker(Be,129,null,!1);function nn(t,e){if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==je?je.createHTML(e):e}var rn=function(t,e){for(var n,i=t.length-1,r=[],o=2===e?"<svg>":"",a=We,s=0;s<i;s++){for(var l=t[s],c=void 0,u=void 0,d=-1,h=0;h<l.length&&(a.lastIndex=h,null!==(u=a.exec(l)));)h=a.lastIndex,a===We?"!--"===u[1]?a=$e:void 0!==u[1]?a=Ge:void 0!==u[2]?(Ye.test(u[2])&&(n=RegExp("</"+u[2],"g")),a=qe):void 0!==u[3]&&(a=qe):a===qe?">"===u[0]?(a=null!=n?n:We,d=-1):void 0===u[1]?d=-2:(d=a.lastIndex-u[2].length,c=u[1],a=void 0===u[3]?qe:'"'===u[3]?Ze:Xe):a===Ze||a===Xe?a=qe:a===$e||a===Ge?a=We:(a=qe,n=void 0);var p=a===qe&&t[s+1].startsWith("/>")?" ":"";o+=a===We?l+Le:d>=0?(r.push(c),l.slice(0,d)+De+l.slice(d)+Ne+p):l+Ne+(-2===d?(r.push(void 0),s):p)}return[nn(t,o+(t[i]||"<?>")+(2===e?"</svg>":"")),r]},on=function(){return s(function t(e,n){var i,r=e.strings,a=e._$litType$;o(this,t),this.parts=[];var s=0,c=0,u=r.length-1,d=this.parts,h=g(rn(r,a),2),p=h[0],f=h[1];if(this.el=t.createElement(p,n),en.currentNode=this.el.content,2===a){var v=this.el.content,m=v.firstChild;m.remove(),v.append.apply(v,k(m.childNodes))}for(;null!==(i=en.nextNode())&&d.length<u;){if(1===i.nodeType){if(i.hasAttributes()){var y,b=[],w=l(i.getAttributeNames());try{for(w.s();!(y=w.n()).done;){var x=y.value;if(x.endsWith(De)||x.startsWith(Ne)){var A=f[c++];if(b.push(x),void 0!==A){var _=i.getAttribute(A.toLowerCase()+De).split(Ne),E=/([.?@])?(.*)/.exec(A);d.push({type:1,index:s,name:E[2],strings:_,ctor:"."===E[1]?un:"?"===E[1]?hn:"@"===E[1]?pn:cn})}else d.push({type:6,index:s})}}}catch(t){w.e(t)}finally{w.f()}for(var C=0,T=b;C<T.length;C++){var S=T[C];i.removeAttribute(S)}}if(Ye.test(i.tagName)){var O=i.textContent.split(Ne),P=O.length-1;if(P>0){i.textContent=Re?Re.emptyScript:"";for(var I=0;I<P;I++)i.append(O[I],ze()),en.nextNode(),d.push({type:2,index:++s});i.append(O[P],ze())}}}else if(8===i.nodeType)if(i.data===Me)d.push({type:2,index:s});else for(var R=-1;-1!==(R=i.data.indexOf(Ne,R+1));)d.push({type:7,index:s}),R+=Ne.length-1;s++}},null,[{key:"createElement",value:function(t,e){var n=Be.createElement("template");return n.innerHTML=t,n}}])}();function an(t,e){var n,i,r,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,s=arguments.length>3?arguments[3]:void 0;if(e===Ke)return e;var l=void 0!==s?null===(n=a._$Co)||void 0===n?void 0:n[s]:a._$Cl,c=Ue(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(i=null==l?void 0:l._$AO)||void 0===i||i.call(l,!1),void 0===c?l=void 0:(l=new c(t))._$AT(t,a,s),void 0!==s?(null!==(r=(o=a)._$Co)&&void 0!==r?r:o._$Co=[])[s]=l:a._$Cl=l),void 0!==l&&(e=an(t,l._$AS(t,e.values),l,s)),e}var sn=function(){return s(function t(e,n){o(this,t),this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n},[{key:"parentNode",get:function(){return this._$AM.parentNode}},{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"u",value:function(t){var e,n=this._$AD,i=n.el.content,r=n.parts,o=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:Be).importNode(i,!0);en.currentNode=o;for(var a=en.nextNode(),s=0,l=0,c=r[0];void 0!==c;){if(s===c.index){var u=void 0;2===c.type?u=new ln(a,a.nextSibling,this,t):1===c.type?u=new c.ctor(a,c.name,c.strings,this,t):6===c.type&&(u=new fn(a,this,t)),this._$AV.push(u),c=r[++l]}s!==(null==c?void 0:c.index)&&(a=en.nextNode(),s++)}return en.currentNode=Be,o}},{key:"v",value:function(t){var e,n=0,i=l(this._$AV);try{for(i.s();!(e=i.n()).done;){var r=e.value;void 0!==r&&(void 0!==r.strings?(r._$AI(t,r,n),n+=r.strings.length-2):r._$AI(t[n])),n++}}catch(t){i.e(t)}finally{i.f()}}}])}(),ln=function(){function t(e,n,i,r){var a;o(this,t),this.type=2,this._$AH=Je,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=i,this.options=r,this._$Cp=null===(a=null==r?void 0:r.isConnected)||void 0===a||a}return s(t,[{key:"_$AU",get:function(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cp}},{key:"parentNode",get:function(){var t=this._$AA.parentNode,e=this._$AM;return void 0!==e&&11===(null==t?void 0:t.nodeType)&&(t=e.parentNode),t}},{key:"startNode",get:function(){return this._$AA}},{key:"endNode",get:function(){return this._$AB}},{key:"_$AI",value:function(t){t=an(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this),Ue(t)?t===Je||null==t||""===t?(this._$AH!==Je&&this._$AR(),this._$AH=Je):t!==this._$AH&&t!==Ke&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):Ve(t)?this.T(t):this._(t)}},{key:"k",value:function(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}},{key:"$",value:function(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}},{key:"_",value:function(t){this._$AH!==Je&&Ue(this._$AH)?this._$AA.nextSibling.data=t:this.$(Be.createTextNode(t)),this._$AH=t}},{key:"g",value:function(t){var e,n=t.values,i=t._$litType$,r="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=on.createElement(nn(i.h,i.h[0]),this.options)),i);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===r)this._$AH.v(n);else{var o=new sn(r,this),a=o.u(this.options);o.v(n),this.$(a),this._$AH=o}}},{key:"_$AC",value:function(t){var e=tn.get(t.strings);return void 0===e&&tn.set(t.strings,e=new on(t)),e}},{key:"T",value:function(e){Fe(this._$AH)||(this._$AH=[],this._$AR());var n,i,r=this._$AH,o=0,a=l(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;o===r.length?r.push(n=new t(this.k(ze()),this.k(ze()),this,this.options)):n=r[o],n._$AI(s),o++}}catch(t){a.e(t)}finally{a.f()}o<r.length&&(this._$AR(n&&n._$AB.nextSibling,o),r.length=o)}},{key:"_$AR",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._$AA.nextSibling,n=arguments.length>1?arguments[1]:void 0;for(null===(t=this._$AP)||void 0===t||t.call(this,!1,!0,n);e&&e!==this._$AB;){var i=e.nextSibling;e.remove(),e=i}}},{key:"setConnected",value:function(t){var e;void 0===this._$AM&&(this._$Cp=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}])}(),cn=function(){return s(function t(e,n,i,r,a){o(this,t),this.type=1,this._$AH=Je,this._$AN=void 0,this.element=e,this.name=n,this._$AM=r,this.options=a,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Je},[{key:"tagName",get:function(){return this.element.tagName}},{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"_$AI",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=this.strings,o=!1;if(void 0===r)t=an(this,t,e,0),(o=!Ue(t)||t!==this._$AH&&t!==Ke)&&(this._$AH=t);else{var a,s,l=t;for(t=r[0],a=0;a<r.length-1;a++)(s=an(this,l[n+a],e,a))===Ke&&(s=this._$AH[a]),o||(o=!Ue(s)||s!==this._$AH[a]),s===Je?t=Je:t!==Je&&(t+=(null!=s?s:"")+r[a+1]),this._$AH[a]=s}o&&!i&&this.j(t)}},{key:"j",value:function(t){t===Je?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}])}(),un=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).type=3,t}return h(e,t),s(e,[{key:"j",value:function(t){this.element[this.name]=t===Je?void 0:t}}])}(cn),dn=Re?Re.emptyScript:"",hn=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).type=4,t}return h(e,t),s(e,[{key:"j",value:function(t){t&&t!==Je?this.element.setAttribute(this.name,dn):this.element.removeAttribute(this.name)}}])}(cn),pn=function(t){function e(t,n,i,a,s){var l;return o(this,e),(l=r(this,e,[t,n,i,a,s])).type=5,l}return h(e,t),s(e,[{key:"_$AI",value:function(t){var e;if((t=null!==(e=an(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,0))&&void 0!==e?e:Je)!==Ke){var n=this._$AH,i=t===Je&&n!==Je||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,r=t!==Je&&(n===Je||i);i&&this.element.removeEventListener(this.name,this,n),r&&this.element.addEventListener(this.name,this,t),this._$AH=t}}},{key:"handleEvent",value:function(t){var e,n;"function"==typeof this._$AH?this._$AH.call(null!==(n=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==n?n:this.element,t):this._$AH.handleEvent(t)}}])}(cn),fn=function(){return s(function t(e,n,i){o(this,t),this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=i},[{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"_$AI",value:function(t){an(this,t)}}])}(),vn={O:De,P:Ne,A:Me,C:1,M:rn,L:sn,R:Ve,D:an,I:ln,V:cn,H:hn,N:pn,U:un,F:fn},mn=Ie.litHtmlPolyfillSupport;null==mn||mn(on,ln),(null!==(fe=Ie.litHtmlVersions)&&void 0!==fe?fe:Ie.litHtmlVersions=[]).push("2.8.0");var yn,bn,gn=function(t){function n(){var t;return o(this,n),(t=r(this,n,arguments)).renderOptions={host:e(t)},t._$Do=void 0,t}return h(n,t),s(n,[{key:"createRenderRoot",value:function(){var t,e,i=w(n,"createRenderRoot",this,3)([]);return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=i.firstChild),i}},{key:"update",value:function(t){var e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),w(n,"update",this,3)([t]),this._$Do=function(t,e,n){var i,r,o=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:e,a=o._$litPart$;if(void 0===a){var s=null!==(r=null==n?void 0:n.renderBefore)&&void 0!==r?r:null;o._$litPart$=a=new ln(e.insertBefore(ze(),s),s,void 0,null!=n?n:{})}return a._$AI(t),a}(e,this.renderRoot,this.renderOptions)}},{key:"connectedCallback",value:function(){var t;w(n,"connectedCallback",this,3)([]),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}},{key:"disconnectedCallback",value:function(){var t;w(n,"disconnectedCallback",this,3)([]),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}},{key:"render",value:function(){return Ke}}])}(Pe);
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */gn.finalized=!0,gn._$litElement$=!0,null===(yn=globalThis.litElementHydrateSupport)||void 0===yn||yn.call(globalThis,{LitElement:gn});var wn=globalThis.litElementPolyfillSupport;null==wn||wn({LitElement:gn}),(null!==(bn=globalThis.litElementVersions)&&void 0!==bn?bn:globalThis.litElementVersions=[]).push("3.3.3");
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
var xn=function(t){return function(e){return"function"==typeof e?function(t,e){return customElements.define(t,e),e}(t,e):function(t,e){return{kind:e.kind,elements:e.elements,finisher:function(e){customElements.define(t,e)}}}(t,e)}};
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */function kn(t){return function(e,n){return void 0!==n?function(t,e,n){e.constructor.createProperty(n,t)}(t,e,n):function(t,e){return"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?v(v({},e),{},{finisher:function(n){n.createProperty(e.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer:function(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher:function(n){n.createProperty(e.key,t)}}}(t,e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */function An(t){return kn(v(v({},t),{},{state:!0}))}
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */var _n,En=function(t){var e=t.finisher,n=t.descriptor;return function(t,i){var r;if(void 0===i){var o=null!==(r=t.originalKey)&&void 0!==r?r:t.key,a=null!=n?{kind:"method",placement:"prototype",key:o,descriptor:n(t.key)}:v(v({},t),{},{key:o});return null!=e&&(a.finisher=function(t){e(t,o)}),a}var s=t.constructor;void 0!==n&&Object.defineProperty(t,i,n(i)),null==e||e(s,i)}};
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */function Cn(t,e){return En({descriptor:function(n){var i={get:function(){var e,n;return null!==(n=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==n?n:null},enumerable:!0,configurable:!0};if(e){var r="symbol"==_(n)?Symbol():"__"+n;i.get=function(){var e,n;return void 0===this[r]&&(this[r]=null!==(n=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==n?n:null),this[r]}}return i}})}
/**
   * @license
   * Copyright 2021 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */var Tn=null!=(null===(_n=window.HTMLSlotElement)||void 0===_n?void 0:_n.prototype.assignedElements)?function(t,e){return t.assignedElements(e)}:function(t,e){return t.assignedNodes(e).filter(function(t){return t.nodeType===Node.ELEMENT_NODE})};var Sn=function(){return s(function t(){o(this,t),this.reset()},[{key:"reset",value:function(t){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})}}])}();function On(){return new Sn}function Pn(t){"function"==typeof queueMicrotask?queueMicrotask(t):Promise.resolve().then(t).catch(function(t){return setTimeout(function(){throw t})})}var In=function(){function t(){o(this,t),this.disposables=[]}return s(t,[{key:"addEventListener",value:function(t,e,n,i){return this.add(function(t,e,n,i){return t.addEventListener(e,n,i),function(){!function(t,e,n,i){t.removeEventListener(e,n,i)}(t,e,n,i)}}(t,e,n,i))}},{key:"mutationObserve",value:function(t,e,n){var i=!1,r=new MutationObserver(e);return r.observe(t,n),function(){return function(t){i||(i=!0,t.disconnect())}(r)}}},{key:"requestAnimationFrame",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=requestAnimationFrame.apply(void 0,arguments);return this.add(function(){return cancelAnimationFrame(t)})})},{key:"nextFrame",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.requestAnimationFrame(function(){return t.requestAnimationFrame.apply(t,n)})}},{key:"setTimeout",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=setTimeout.apply(void 0,arguments);return this.add(function(){return clearTimeout(t)})})},{key:"microTask",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i={current:!0};return Pn(function(){i.current&&e[0]()}),this.add(function(){i.current=!1})}},{key:"style",value:function(t,e,n){var i=t.style.getPropertyValue(e);return Object.assign(t.style,c({},e,n)),this.add(function(){Object.assign(t.style,c({},e,i))})}},{key:"group",value:function(e){var n=new t;return e(n),this.add(function(){return n.dispose()})}},{key:"add",value:function(t){var e=this;return this.disposables.push(t),function(){var n=e.disposables.indexOf(t);n>=0&&e.remove(n,1)}}},{key:"remove",value:function(t,e){var n,i=l(this.disposables.splice(t,null!=e?e:this.disposables.length));try{for(i.s();!(n=i.n()).done;){(0,n.value)()}}catch(t){i.e(t)}finally{i.f()}}},{key:"dispose",value:function(){this.remove(0)}}])}();function Rn(){return new In}function jn(t,e){if(t in e){for(var n=e[t],i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return"function"==typeof n?n.apply(void 0,r):n}var a=new Error('Tried to handle "'.concat(t,'" but there is no handler defined. Only defined handlers are: ').concat(Object.keys(e).map(function(t){return'"'.concat(t,'"')}).join(", "),"."));throw Error.captureStackTrace&&Error.captureStackTrace(a,jn),a}var Dn=("undefined"==typeof window?"undefined":_(window))<"u";function Nn(){return Dn?window.__BILI_POPPER_ZINDEX__++:1e3}function Mn(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t&&i.length>0&&(e=t.classList).add.apply(e,i)}function Ln(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t&&i.length>0&&(e=t.classList).remove.apply(e,i)}function Bn(t,e,n,i){var r=n?"enter":"leave",o=Rn(),a=void 0!==i?function(t){var e={called:!1};return function(){if(!e.called)return e.called=!0,t.apply(void 0,arguments)}}(i):function(){};"enter"===r&&(t.removeAttribute("hidden"),t.style.display="");var s=jn(r,{enter:function(){return e.enter},leave:function(){return e.leave}}),l=jn(r,{enter:function(){return e.enterTo},leave:function(){return e.leaveTo}}),c=jn(r,{enter:function(){return e.enterFrom},leave:function(){return e.leaveFrom}});return Ln.apply(void 0,[t].concat(k(e.base),k(e.enter),k(e.enterTo),k(e.enterFrom),k(e.leave),k(e.leaveFrom),k(e.leaveTo),k(e.entered))),Mn.apply(void 0,[t].concat(k(e.base),k(s),k(c))),o.nextFrame(function(){Ln.apply(void 0,[t].concat(k(e.base),k(s),k(c))),Mn.apply(void 0,[t].concat(k(e.base),k(s),k(l))),function(t,e){var n=Rn();if(!t)return n.dispose;var i=getComputedStyle(t),r=[i.transitionDuration,i.transitionDelay].map(function(t){var e=t.split(",").filter(Boolean).map(function(t){return t.includes("ms")?parseFloat(t):1e3*parseFloat(t)}).sort(function(t,e){return e-t}),n=g(e,1)[0];return void 0===n?0:n}),o=g(r,2),a=o[0]+o[1];if(0!==a){n.group(function(n){n.setTimeout(function(){e(),n.dispose()},a),n.addEventListener(t,"transitionrun",function(t){t.target===t.currentTarget&&n.dispose()})});var s=n.addEventListener(t,"transitionend",function(t){t.target===t.currentTarget&&(e(),s())})}else e();n.add(function(){return e()}),n.dispose}(t,function(){return Ln.apply(void 0,[t].concat(k(e.base),k(s),k(l))),Mn.apply(void 0,[t].concat(k(e.base),k(e.entered))),a()})}),o.dispose
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */}Dn&&(window.__BILI_POPPER_ZINDEX__||(window.__BILI_POPPER_ZINDEX__=1e3));var zn,Un,Fn,Vn,Hn=1,Wn=2,$n=function(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return{_$litDirective$:t,values:n}}},Gn=function(){return s(function t(e){o(this,t)},[{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"_$AT",value:function(t,e,n){this._$Ct=t,this._$AM=e,this._$Ci=n}},{key:"_$AS",value:function(t,e){return this.update(t,e)}},{key:"update",value:function(t,e){return this.render.apply(this,k(e))}}])}(),qn="important",Xn=" !"+qn,Zn=$n(function(t){function e(t){var n,i;if(o(this,e),n=r(this,e,[t]),t.type!==Hn||"style"!==t.name||(null===(i=t.strings)||void 0===i?void 0:i.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.");return n}return h(e,t),s(e,[{key:"render",value:function(t){return Object.keys(t).reduce(function(e,n){var i=t[n];return null==i?e:e+"".concat(n=n.includes("-")?n:n.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase(),":").concat(i,";")},"")}},{key:"update",value:function(t,e){var n=this,i=g(e,1)[0],r=t.element.style;if(void 0===this.ht){for(var o in this.ht=new Set,i)this.ht.add(o);return this.render(i)}for(var a in this.ht.forEach(function(t){null==i[t]&&(n.ht.delete(t),t.includes("-")?r.removeProperty(t):r[t]="")}),i){var s=i[a];if(null!=s){this.ht.add(a);var l="string"==typeof s&&s.endsWith(Xn);a.includes("-")||l?r.setProperty(a,l?s.slice(0,-11):s,l?qn:""):r[a]=s}}return Ke}}])}(Gn)),Yn=Object.defineProperty,Qn=Object.getOwnPropertyDescriptor,Kn=function(t,e,n,i){for(var r,o=i>1?void 0:i?Qn(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Yn(e,n,o),o},Jn=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.eventId="cm_goods_common",t.sourceFrom="",t.contentOid="",t.spmIdFrom="",t.selectIds="",t.loaded=!1,t.url="",t.size={width:960,height:642},t}return h(e,t),s(e,[{key:"initUrl",value:function(){var t={eventId:this.eventId,selectIds:this.selectIds,show:!0,source:"2",source_from:this.sourceFrom,content_oid:this.contentOid,no_top:1};this.spmIdFrom&&(t.spm_id_from=this.spmIdFrom);var e=Object.entries(t).map(function(t){var e=g(t,2),n=e[0],i=e[1];return"".concat(n,"=").concat(i)});this.url="".concat("//cm.bilibili.com/goods-plugin/pc#/goods-modal","?").concat(e.join("&"))}},{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),this.initUrl(),this.disposables.addEventListener(window,"message",function(e){try{if("string"==typeof e.data){var n=JSON.parse(e.data);if("object"!=_(n)||n.eventId!==t.eventId)return;var i=n.data;switch(n.type){case"on-ready":i.width&&i.height&&(t.size={width:i.width,height:i.height}),t.loaded=!0;break;case"close":t.dispatchEvent(new CustomEvent("cancel")),setTimeout(function(){t.remove()},0);break;case"on-confirm":t.dispatchEvent(new CustomEvent("confirm",{detail:i}))}}}catch(t){}})}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose()}},{key:"spinnerTemplate",value:function(){return Qe(zn||(zn=x(['<div id="spinner">\n      <img width="24" height="24" src="//i0.hdslb.com/bfs/static/jinkela/long/gif/loading-blue.gif" />\n      <span></span>\n    </div>'])))}},{key:"render",value:function(){return Qe(Un||(Un=x(['\n      <div id="wrap">\n        <div\n          id="window"\n          style="','"\n        >\n          ',"\n        </div>\n        ","\n      </div>\n    "])),Zn({display:this.loaded?"flex":"",width:"".concat(this.size.width,"px"),height:"".concat(this.size.height,"px")}),this.url?Qe(Fn||(Fn=x(['<iframe src="','"></iframe>'])),this.url):"",this.loaded?"":this.spinnerTemplate())}}])}(gn);Jn.styles=we(Vn||(Vn=x(["\n    #wrap {\n      min-height: 100px;\n      min-width: 100px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #window {\n      width: 960px;\n      height: 642px;\n      display: none;\n      border-radius: 8px;\n      overflow: hidden;\n    }\n    iframe {\n      width: 100%;\n      height: 100%;\n      border: none;\n    }\n    #spinner {\n      padding: 20px 0;\n      width: 100%;\n      text-align: center;\n      font-size: 14px;\n      color: var(--text3);\n    }\n    #spinner img {\n      margin-right: 8px;\n      vertical-align: bottom;\n    }\n  "]))),Kn([kn({type:String,attribute:"event-id"})],Jn.prototype,"eventId",2),Kn([kn({type:String,attribute:"source-from"})],Jn.prototype,"sourceFrom",2),Kn([kn({type:String,attribute:"content-oid"})],Jn.prototype,"contentOid",2),Kn([kn({type:String,attribute:"spm-id-from"})],Jn.prototype,"spmIdFrom",2),Kn([kn({type:String,attribute:"data-select-ids"})],Jn.prototype,"selectIds",2),Kn([An()],Jn.prototype,"loaded",2),Kn([An()],Jn.prototype,"url",2),Kn([An()],Jn.prototype,"size",2),customElements.get("bili-cm-goods")||customElements.define("bili-cm-goods",Jn);var ti,ei=function(t){"undefined"!=typeof window&&window.__BILI_X_ENGINE_SCRIPT_CACHE__&&void 0!==window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]&&delete window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]},ni=function(t,e){if("undefined"==typeof window)return Promise.reject(new Error("window is not defined"));var n,i=t=t.replace(/^https?:\/\//,"//"),r=(n=i,"undefined"==typeof window?null:window.__BILI_X_ENGINE_SCRIPT_CACHE__&&window.__BILI_X_ENGINE_SCRIPT_CACHE__[n]||null);if(null!=r&&r.promise)return r.promise;var o=new Promise(function(n,i){var r=document.createElement("script");r.src=t,null!=e&&e.behavior&&r.setAttribute(e.behavior,""),r.onload=function(){var r=window;if(null!=e&&e.lib)return r[e.lib]?n(r[e.lib]):i(new Error('Failed to access library "'+e.lib+'" from '+t));n(null)},r.onerror=function(){i(new Error("Failed to load "+t)),document.head.removeChild(r)},document.head.appendChild(r)});return function(t,e){"undefined"!=typeof window&&(window.__BILI_X_ENGINE_SCRIPT_CACHE__||(window.__BILI_X_ENGINE_SCRIPT_CACHE__={}),window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]=e)}(i,{promise:o,lib:null==e?void 0:e.lib}),o.then(function(){!1===(null==e?void 0:e.cache)&&ei(i)}).catch(function(){!1===(null==e?void 0:e.cache)&&ei(i)}),o},ii=function(t){return Promise.resolve(function(){try{return window.KvSDK?Promise.resolve(window.KvSDK):Promise.resolve(ni("//s1.hdslb.com/bfs/seed/jinkela/kv-sdk/index.js",{lib:"KvSDK"}))}catch(t){return Promise.reject(t)}}()).then(function(e){return new e(t)})},ri=function(){try{var t=function(){return Promise.resolve(window.__BiliUser__.get())},e=function(){if(!window.__BiliUser__)return Promise.resolve(function(){try{return Promise.resolve(ni("//s1.hdslb.com/bfs/seed/jinkela/short/bili-user/index.js",{lib:"__BiliUser__"}))}catch(t){return Promise.reject(t)}}()).then(function(){})}();return Promise.resolve(e&&e.then?e.then(t):t())}catch(t){return Promise.reject(t)}},oi=function(t){if(window.__BiliUser__){var e=window.__BiliUser__;return new Promise(function(n,i){e.quickLogin(function(t){0!==t.code?i():n()},t)})}return new Promise(function(e,n){function i(){ti.showComponent(),ti.addEventListener("success",function(){e(),ti.removeEventListener("success"),ti.removeEventListener("cancel")}),ti.addEventListener("cancel",function(){n(),ti.removeEventListener("success"),ti.removeEventListener("cancel")})}ti?i():function(){try{return window.MiniLogin?Promise.resolve(window.MiniLogin):Promise.resolve(ni("//s1.hdslb.com/bfs/seed/jinkela/short/mini-login/miniLogin.umd.min.js",{lib:"MiniLogin"}))}catch(t){return Promise.reject(t)}}().then(function(e){if(!e)return n("MiniLogin is not found");ti=new e(t),i()}).catch(n)})};function ai(){return ai=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ai.apply(this,arguments)}var si,li,ci,ui,di,hi,pi,fi="",vi=function(){return fi||((fi=function(t){if("undefined"==typeof window)return"";var e=document.querySelector('meta[name="'+t+'"]');return null!=e&&e.content?e.content:""}("spm_prefix"))||"0.0")},mi=function(t){return Promise.resolve(function(){try{return window.ReporterPb?Promise.resolve(window.ReporterPb):Promise.resolve(ni("//s1.hdslb.com/bfs/seed/jinkela/short/reporter-pb/index.js",{lib:"ReporterPb"}))}catch(t){return Promise.reject(t)}}()).then(function(e){return new e(t)})},yi=function(t,e,n,i){console.warn("["+("undefined"==typeof window?"Node":"Browser")+"]Miss reporter args: "+JSON.stringify({type:t,spm:e,data:n,options:i}))},bi=function(t){var e=window,n=vi(),i=e[t].report.bind(e[t]);return function(t,e,r,o){return"string"!=typeof e?e.prefix||(e=ai({},e,{prefix:n})):e.split(".").length<=3&&(e=n+"."+e),i(t,e,r,o)}},gi=function(t,e,n,i){var r=window.biliMirror||window.__MIRROR_REPORT__,o=r.customReportPb,a=r.techReportPb,s="",l="";if("string"!=typeof e)l=[e.c,e.d,e.e].filter(Boolean).join("."),e.prefix&&(s=e.prefix);else{var c=e.split(".");isNaN(Number(c[0]))||isNaN(Number(c[1]))?l=e:(s=c.splice(0,2).join("."),l=c.join("."))}if("tech"===t){if(a)return void a({eventId:l,msg:n,otherSpmId:s})}else if(o)return void o({type:t,eventId:l,msg:n,otherSpmId:s});yi(t,e,n,i)},wi=function(t){if("undefined"==typeof window)return yi;var e=window,n="";function i(){var t=e[n];return!(null==t||!t.report)}return"string"==typeof(null==t?void 0:t.globalInst)&&(n=t.globalInst,i())?bi(n):!1!==(null==t?void 0:t.mirror)&&(window.biliMirror||window.__MIRROR_REPORT__)?gi:(n="__biliMirrorPbInstance__",i()?bi(n):yi)},xi=function(t,e,n,i){return wi()(t,e,n,i)},ki=function(t){try{return window.Unios?Promise.resolve(window.Unios.request(t)):Promise.resolve(function(t){if(window.Unios)return Promise.resolve(window.Unios);var e=window.__LOAD_REQUEST_TYPE__||t||"web";return ni("//s1.hdslb.com/bfs/seed/jinkela/short/unios/"+e+".min.js",{lib:"Unios"})}()).then(function(){return window.Unios.request(t)})}catch(t){return Promise.reject(t)}},Ai=function(t,e,n){try{return window.BToast?Promise.resolve(window.BToast.show(t,e,n)):Promise.resolve(function(){try{return window.BToast?Promise.resolve(window.BToast):Promise.resolve(ni("//s1.hdslb.com/bfs/seed/jinkela/short/webui/toast/index.js",{lib:"BToast"}))}catch(t){return Promise.reject(t)}}()).then(function(){return window.BToast.show(t,e,n)})}catch(t){return Promise.reject(t)}},_i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ei={};function Ci(){var t=window.__BILI_EMOJI_PICKER_DATA_TASK__;return t&&t instanceof Promise||(t=new Promise(function(t,e){ki({url:"//api.bilibili.com/x/emote/user/panel/web",params:{business:"reply"}}).then(function(n){if(0!==n.code||!n.data)return delete window.__BILI_EMOJI_PICKER_DATA_TASK__,e(new Error(n.message||"get emoji data error"));t(n.data)}).catch(e)}),window.__BILI_EMOJI_PICKER_DATA_TASK__=t),t}!function(t){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}Object.defineProperty(t,"__esModule",{value:!0});var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==_i?_i:"undefined"!=typeof self?self:{},i={},r={},o={};Object.defineProperty(o,"__esModule",{value:!0});var a=!0,s=o.default=function(){return a&&(a="undefined"==typeof window),a};!function(t){var e=n&&n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseAvif=t.canUseAvif=t.setAvif=void 0;var i,r=e(o);t.setAvif=function(t){i=t};t.canUseAvif=function(){return!(0,r.default)()&&(void 0!==i&&i)};t.asyncCanUseAvif=function(){return new Promise(function(e){if((0,r.default)())return e(!1);if((0,t.canUseAvif)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setAvif)(!1),e(!1)},n.onload=function(){(0,t.setAvif)(!0),e(!0)},n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="})}}(r);var l={};!function(t){var e=n&&n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseWebP=t.canUseWebP=t.setWebp=void 0;var i,r=e(o);t.setWebp=function(t){i=t};t.canUseWebP=function(){var t,e,n,o;if((0,r.default)())return!1;if(void 0!==i)return i;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return i=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var a=document.createElement("canvas");i=!!(null===(e=a.getContext)||void 0===e?void 0:e.call(a,"2d"))&&0===(null===(o=null===(n=a.toDataURL)||void 0===n?void 0:n.call(a,"image/webp"))||void 0===o?void 0:o.indexOf("data:image/webp"))}catch(t){i=!1}return i};t.asyncCanUseWebP=function(){return new Promise(function(e){if((0,r.default)())return e(!1);if((0,t.canUseWebP)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setWebp)(!1),e(!1)},n.onload=function(){(0,t.setWebp)(!0),e(!0)},n.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="})}}(l);var c={},u=n&&n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(c,"__esModule",{value:!0});var d=u(o);c.default=function(){return!(0,d.default)()&&!!window.HTMLPictureElement},function(t){var e=n&&n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.autoDetectAll=t.autoDetect=t.canUseHtmlPictureElement=t.canUseWebP=t.setWebp=t.canUseAvif=t.setAvif=void 0;var i=r;Object.defineProperty(t,"canUseAvif",{enumerable:!0,get:function(){return i.canUseAvif}}),Object.defineProperty(t,"setAvif",{enumerable:!0,get:function(){return i.setAvif}});var o=l;Object.defineProperty(t,"canUseWebP",{enumerable:!0,get:function(){return o.canUseWebP}}),Object.defineProperty(t,"setWebp",{enumerable:!0,get:function(){return o.setWebp}});var a=e(c);t.canUseHtmlPictureElement=a.default;t.autoDetect=function(t){void 0===t&&(t=["webp"]);for(var e=0;e<t.length;e++){if("avif"===t[e]&&(0,i.canUseAvif)())return t[e];if("webp"===t[e]&&(0,o.canUseWebP)())return t[e]}return""};t.autoDetectAll=function(){return new Promise(function(t){Promise.all([(0,i.asyncCanUseAvif)(),(0,o.asyncCanUseWebP)()]).then(function(e){var n=e[0],i=e[1];t({avif:n,webp:i})})})}}(i);var h={},p={};Object.defineProperty(p,"__esModule",{value:!0}),p.default=function(t){return t?t.replace(/^http(s)?:/,""):""};var f={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.isInt=t.isNum=void 0;t.isNum=function(t){return"number"==typeof t};t.isInt=function(e){return(0,t.isNum)(e)&&(0|e)===e}}(f);var v={};Object.defineProperty(v,"__esModule",{value:!0});var m=/\.(jpeg|jpg|png|webp|gif|avif)$/;v.default=function(t){var e;return(null===(e=t.match(m))||void 0===e?void 0:e[0])||null},function(t){var e=n&&n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBmgSrc=t.isSupportBmgFormat=void 0;var i=e(p),r=e(o),a=f,s=e(v);t.isSupportBmgFormat=function(t){return!(!function(t){return!!/\/bfs\//.test(t)}(t)&&!function(t){return/pic.bstarstatic.com/.test(t)}(t))&&!!(0,s.default)(t)};var l=function(t){return"number"!=typeof t||isNaN(t)?0:Math.floor(t)||0};t.getBmgSrc=function(e,n){var o;if(void 0===n&&(n={c:!0}),"string"!=typeof e)return"";if(!(0,t.isSupportBmgFormat)(e))return e;if(e.indexOf("@")>-1){if(n.cache)return e;e=e.split("@")[0]}e=e.replace("//pre-","//");var s=n.dpr||((0,r.default)()?2:Math.floor(null!==(o=null===window||void 0===window?void 0:window.devicePixelRatio)&&void 0!==o?o:2)||1),c=[];n.w&&(0,a.isInt)(n.w)&&c.push("".concat(Math.floor(n.w*s),"w")),n.h&&(0,a.isInt)(n.h)&&c.push("".concat(Math.floor(n.h*s),"h")),n.e&&c.push("".concat(n.e,"e")),n.c&&c.push("1c"),n.a&&c.push("".concat([l(n.a.x),l(n.a.y),l(n.a.w)*s,l(n.a.h)*s].join("-"),"a")),n.p&&(0,a.isInt)(n.p)&&c.push("".concat(n.p,"p")),n.s&&c.push("1s"),n.q&&(0,a.isInt)(n.q)&&c.push("".concat(n.q,"q")),n.style&&c.push("!".concat(n.style));var u="";return n.ext&&["webp","avif"].includes(n.ext)&&(u=n.ext),0!==c.length||u?"".concat((0,i.default)(e),"@").concat(c.join("_")).concat(u?".".concat(u):""):e}}(h);var y,b={};function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}t.initWindowExtsState=void 0,t.getWindowExtsState=void 0,Object.defineProperty(b,"__esModule",{value:!0});var w="__BMG_TRACKER_COLLECT_QUEUE__",x="__BMG_TRACKER_COLLECT_EXTS__",k="__BMG_TRACKER_COLLECT_MODE__",A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{},_={};Object.defineProperty(_,"__esModule",{value:!0});var E=!0,C=_.default=function(){return E&&(E="undefined"==typeof window),E},T={};Object.defineProperty(T,"__esModule",{value:!0});var S=/\.(jpeg|jpg|png|webp|gif|avif)$/,O=T.default=function(t){var e;return(null===(e=t.match(S))||void 0===e?void 0:e[0])||null},P={};!function(t){var e=A&&A.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseAvif=t.canUseAvif=t.setAvif=void 0;var n,i=e(_);t.setAvif=function(t){n=t},t.canUseAvif=function(){return!(0,i.default)()&&void 0!==n&&n},t.asyncCanUseAvif=function(){return new Promise(function(e){if((0,i.default)())return e(!1);if((0,t.canUseAvif)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setAvif)(!1),e(!1)},n.onload=function(){(0,t.setAvif)(!0),e(!0)},n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="})}}(P);var I={};!function(t){var e=A&&A.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncCanUseWebP=t.canUseWebP=t.setWebp=void 0;var n,i=e(_);t.setWebp=function(t){n=t},t.canUseWebP=function(){var t,e,r,o;if((0,i.default)())return!1;if(void 0!==n)return n;try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return n=Number((null===(t=navigator.userAgent.match(/Firefox\/(\d+)/i))||void 0===t?void 0:t[1])||"0")>=65;var a=document.createElement("canvas");n=!!(null===(e=a.getContext)||void 0===e?void 0:e.call(a,"2d"))&&0===(null===(o=null===(r=a.toDataURL)||void 0===r?void 0:r.call(a,"image/webp"))||void 0===o?void 0:o.indexOf("data:image/webp"))}catch(t){n=!1}return n},t.asyncCanUseWebP=function(){return new Promise(function(e){if((0,i.default)())return e(!1);if((0,t.canUseWebP)())return e(!0);var n=new Image;n.onerror=function(){(0,t.setWebp)(!1),e(!1)},n.onload=function(){(0,t.setWebp)(!0),e(!0)},n.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="})}}(I);var R="BMG_EXTS",j=null,D=function(){if(j)return j;try{j=(localStorage.getItem(R)||"").split(",")}catch(t){console.warn(t),j=[]}return j},N=function(t){if(void 0===t&&(t=!1),!window[x]||t){var e=D();window[x]={avif:e.includes("avif"),webp:e.includes("webp")}}},M=function(t){return function(e){switch(function(){var t=[],e=window[x]||{avif:!1,webp:!1};e.avif&&t.push("avif"),e.webp&&t.push("webp");try{localStorage.setItem(R,t.join(","))}catch(t){console.warn(t)}}(),t){case"avif":P.setAvif(e);break;case"webp":I.setWebp(e)}}},L=function(t){var e;"object"!=g(window[x])&&N(),(null===(e=window[x])||void 0===e?void 0:e[t])||(window[x][t]=!0,M(t)(!0))},B=function(){return window[k]};b.collect=function(t,e,n){if(!C()){var i=C()?null:window.__BMG_TRACKER__||null;n=n||B();var r=(O(t)||"").substring(1);if(["avif","webp"].indexOf(r)>-1&&L(r),"onlyext"!==n)if(i)i.collect(t,e);else if("nocache"!==n){var o={src:t,type:e,ts:Date.now()/1e3|0};Array.isArray(window[w])?window[w].push(o):window[w]=[o]}}},b.getCollectMode=B,b.getLocalExtsState=D,t.getWindowExtsState=b.getWindowExtsState=function(t){var e,n;return"avif"===t?(null===(e=window[x])||void 0===e?void 0:e.avif)||!1:"webp"===t?(null===(n=window[x])||void 0===n?void 0:n.webp)||!1:window[x]||null},t.initWindowExtsState=b.initWindowExtsState=N,b.setCollectMode=function(t){window[k]=t},b.updateExtState=M,y=b.updateWindowExtsState=L;var z=new RegExp(function(t,e){return"".concat(t).concat(e,".hdslb.com")}("(s|i)","\\d")),U=function(t){if(s())return t||"";var e=window.__BMG_AF__;return(null==e?void 0:e.defDomain)?(e.defUpdated,e.defDomain):t||""},F=function(t,e){var n;if(!e)return t;var i=(null===(n=t.match(z))||void 0===n?void 0:n[0])||"";return i&&i!==e?t.replace(z,e):t};t.autoDetectAllExts=function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(a){var l=function(t){o||t.avif&&y("avif"),t.webp&&y("webp"),a(t)};if(s())l({avif:!1,webp:!1});else{if(n){var c=t.getWindowExtsState();if(c&&"object"===e(c))return void l({webp:c.webp||!1,avif:c.avif||!1})}if(r){if(t.initWindowExtsState(),t.getWindowExtsState("avif")||t.getWindowExtsState("webp"))return l(t.getWindowExtsState());i.autoDetectAll().then(l)}else i.autoDetectAll().then(l)}})},t.getBmgSrcNext=function(e,n,r){var o,a,l,c,u="";if(s())return h.getBmgSrc((null==r?void 0:r.domain)?F(e,r.domain):e,n);if(!(null===(o=null==r?void 0:r.disabledExts)||void 0===o?void 0:o.avif)&&t.getWindowExtsState("avif"))u="avif";else if(!(null===(a=null==r?void 0:r.disabledExts)||void 0===a?void 0:a.webp)&&t.getWindowExtsState("webp"))u="webp";else{var d=[];(null===(l=null==r?void 0:r.disabledExts)||void 0===l?void 0:l.avif)||d.push("avif"),(null===(c=null==r?void 0:r.disabledExts)||void 0===c?void 0:c.webp)||d.push("webp"),d.length&&(u=i.autoDetect(d))}return h.getBmgSrc(F(e,U(null==r?void 0:r.domain)),Object.assign(Object.assign({},n),{ext:u}))},t.getSrcDefDomain=U,t.replaceSrcDefDomain=F}(Ei);var Ti=Object.defineProperty,Si=Object.getOwnPropertyDescriptor,Oi=function(t,e,n,i){for(var r,o=i>1?void 0:i?Si(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Ti(e,n,o),o},Pi=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).pageCount=5,t.packages=[],t.contentLoading=!1,t.currentIdx=0,t}return h(e,t),s(e,[{key:"currentPage",get:function(){return Math.floor(this.currentIdx/this.pageCount)}},{key:"isFirstPage",get:function(){return 0===this.currentPage}},{key:"isLastPage",get:function(){var t=Math.floor(this.packages.length/this.pageCount)+(this.packages.length%this.pageCount?1:0);return this.currentPage===t-1}},{key:"currentPackage",get:function(){return this.packages.length&&this.packages[this.currentIdx]||null}},{key:"connectedCallback",value:function(){w(e,"connectedCallback",this,3)([]),this.initData()}},{key:"initData",value:(n=i(m().m(function t(){var e,n,i;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Ci();case 1:e=t.v,n=e.packages,this.packages=n,t.n=3;break;case 2:t.p=2,i=t.v,console.warn(i);case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return n.apply(this,arguments)})},{key:"setTab",value:function(t){var e=this;if(!(t>this.packages.length-1||t<0)){this.contentLoading=!0,this.currentIdx=t;var n=Math.floor(t/this.pageCount);this.shadowRoot.querySelector("#tabs-track").style.setProperty("transform","translateX(".concat(100*-n,"%)")),window.setTimeout(function(){e.contentLoading=!1},200)}}},{key:"handlePrev",value:function(){this.isFirstPage||this.setTab(this.currentPage*this.pageCount-1)}},{key:"handleNext",value:function(){this.isLastPage||this.setTab((this.currentPage+1)*this.pageCount)}},{key:"handleSelect",value:function(t){this.dispatchEvent(new CustomEvent("select",{detail:t}))}},{key:"emojiRenderer",value:function(t){var e=this,n=t.type,i=t.meta,r=t.text,o=t.url,a=t.gif_url,s=t.webp_url;if(4===n)return Qe(si||(si=x(['<div\n        class="emoji text"\n        @click=',"\n      >\n        ","\n      </div>"])),function(){e.handleSelect(t)},r);var l=1===i.size?24:56,c=Ei.getBmgSrcNext(s||a||o,{w:l,h:l,dpr:2});return Qe(li||(li=x(['<div\n      class="emoji img"\n      style="height:','px"\n      @click=','\n    >\n      <img width="','" height="','" src="','" alt="','" />\n    </div>'])),l,function(){e.handleSelect(t)},l,l,c,r)}},{key:"contentTemplate",value:function(){var t=this;return Qe(ci||(ci=x(['<div id="content">',"</div>"])),this.currentPackage.emote.map(function(e){return t.emojiRenderer(e)}))}},{key:"render",value:function(){var t=this;return Qe(ui||(ui=x(['<div id="picker">\n      <div id="header">','</div>\n      <div id="body">','</div>\n      <div id="footer">\n        <div id="tabs">\n          <div\n            id="tabs-track"\n            style="','"\n          >\n            ','\n          </div>\n        </div>\n        <div id="nav">\n          <button\n            class="','"\n            @click=','\n          >\n            <bili-icon size="16" icon="BDC/arrow_back_left_line/3"></bili-icon>\n          </button>\n          <button\n            class="','"\n            @click=','\n          >\n            <bili-icon size="16" icon="BDC/arrow_forward_right_line/3"></bili-icon>\n          </button>\n        </div>\n      </div>\n    </div>'])),this.currentPackage?this.currentPackage.text:"",this.currentPackage&&!this.contentLoading?this.contentTemplate():Qe(di||(di=x(['<div id="spinner">...</div>']))),Zn({transform:"translateX(".concat(58*-this.currentPage*this.pageCount,"px)")}),this.packages.map(function(e,n){return Qe(hi||(hi=x(['<div\n                class="','"\n                @click=','\n              >\n                <img\n                  width="22"\n                  height="22"\n                  src="','"\n                  alt="','"\n                />\n              </div>'])),t.currentIdx===n?"tab active":"tab",function(){t.setTab(n)},Ei.getBmgSrcNext(e.url,{w:22,h:22}),e.text)}),this.isFirstPage?"disabled":"",function(){t.handlePrev()},this.isLastPage?"disabled":"",function(){t.handleNext()})}}]);var n}(gn);Pi.styles=we(pi||(pi=x(["\n    :host {\n      --bili-emoji-picker-tab-count: 5;\n      --bili-emoji-picker-tab-width: 58px;\n      --bili-emoji-picker-nav-width: 73px;\n      --bili-emoji-picker-body-height: 196px;\n    }\n    #picker {\n      width: calc(var(--bili-emoji-picker-tab-width) * var(--bili-emoji-picker-tab-count) + var(--bili-emoji-picker-nav-width));\n      font-size: 12px;\n      color: var(--text2);\n      overflow: hidden;\n      background-color: var(--bg1);\n      border: 1px solid var(--graph_bg_thick);\n      border-radius: 8px;\n      box-sizing: border-box;\n    }\n\n    #header {\n      padding: 13px 15px 6px;\n      box-sizing: border-box;\n    }\n    #body {\n      height: var(--bili-emoji-picker-body-height);\n    }\n    #spinner {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      height: 100%;\n    }\n    #content {\n      height: 100%;\n      padding: 0 11px;\n      background-color: var(--bg1);\n      overflow: auto;\n    }\n    #content::-webkit-scrollbar {\n      width: 4px;\n      border-radius: 4px;\n      background-color: transparent;\n    }\n    #content::-webkit-scrollbar-thumb {\n      border-radius: 4px;\n      border-radius: 4px;\n      background-color: var(--graph_bg_thick);\n      transition: 0.3s ease-in-out;\n    }\n    #content::-webkit-scrollbar-track {\n      border-radius: 4px;\n      background-color: transparent;\n    }\n    #content .emoji {\n      display: inline-block;\n      border-radius: 4px;\n      cursor: pointer;\n    }\n    #content .emoji:hover {\n      background-color: var(--graph_bg_thick);\n    }\n    #content .emoji.img {\n      box-sizing: content-box;\n      padding: 4px;\n    }\n    #content .emoji.text {\n      padding: 5px 8px;\n      line-height: 22px;\n    }\n    #footer {\n      background-color: var(--bg3);\n      box-sizing: border-box;\n      height: 36px;\n      display: flex;\n    }\n    #tabs {\n      height: 100%;\n      width: calc(100% - var(--bili-emoji-picker-nav-width));\n      overflow: hidden;\n    }\n    #tabs-track {\n      transition: transform 0.3s ease-in-out;\n      transform: translateX(0);\n      display: flex;\n      flex-wrap: no-wrap;\n      height: 100%;\n    }\n    .tab {\n      height: 100%;\n      flex-shrink: 0;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: var(--bili-emoji-picker-tab-width);\n      height: 100%;\n      cursor: pointer;\n    }\n    .tab:hover {\n      background-color: var(--graph_bg_thick);\n    }\n    .tab.active {\n      background-color: var(--bg1);\n    }\n    #nav {\n      height: 100%;\n      width: var(--bili-emoji-picker-nav-width);\n      display: flex;\n      justify-content: space-evenly;\n      align-items: center;\n    }\n    #nav button {\n      width: 36px;\n      height: 100%;\n      color: var(--text2);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      outline: none;\n      border: none;\n      background-color: transparent;\n      cursor: pointer;\n      transition: color 0.2s;\n    }\n    #nav button.disabled {\n      color: var(--text4);\n    }\n  "]))),Oi([An()],Pi.prototype,"packages",2),Oi([An()],Pi.prototype,"contentLoading",2),Oi([An()],Pi.prototype,"currentIdx",2),Oi([An()],Pi.prototype,"currentPage",1),Oi([An()],Pi.prototype,"isFirstPage",1),Oi([An()],Pi.prototype,"isLastPage",1),Oi([An()],Pi.prototype,"currentPackage",1),Pi=Oi([xn("bili-emoji-picker")],Pi);
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var Ii=function(t,e){return(Ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Ri(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ii(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function ji(t,e){var n=t[0],i=t[1];return[n*Math.cos(e)-i*Math.sin(e),n*Math.sin(e)+i*Math.cos(e)]}function Di(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++)if("number"!=typeof t[n])throw new Error("assertNumbers arguments["+n+"] is not a number. "+_(t[n])+" == typeof "+t[n]);return!0}var Ni=Math.PI;function Mi(t,e,n){t.lArcFlag=0===t.lArcFlag?0:1,t.sweepFlag=0===t.sweepFlag?0:1;var i=t.rX,r=t.rY,o=t.x,a=t.y;i=Math.abs(t.rX),r=Math.abs(t.rY);var s=ji([(e-o)/2,(n-a)/2],-t.xRot/180*Ni),l=s[0],c=s[1],u=Math.pow(l,2)/Math.pow(i,2)+Math.pow(c,2)/Math.pow(r,2);1<u&&(i*=Math.sqrt(u),r*=Math.sqrt(u)),t.rX=i,t.rY=r;var d=Math.pow(i,2)*Math.pow(c,2)+Math.pow(r,2)*Math.pow(l,2),h=(t.lArcFlag!==t.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(i,2)*Math.pow(r,2)-d)/d)),p=i*c/r*h,f=-r*l/i*h,v=ji([p,f],t.xRot/180*Ni);t.cX=v[0]+(e+o)/2,t.cY=v[1]+(n+a)/2,t.phi1=Math.atan2((c-f)/r,(l-p)/i),t.phi2=Math.atan2((-c-f)/r,(-l-p)/i),0===t.sweepFlag&&t.phi2>t.phi1&&(t.phi2-=2*Ni),1===t.sweepFlag&&t.phi2<t.phi1&&(t.phi2+=2*Ni),t.phi1*=180/Ni,t.phi2*=180/Ni}function Li(t,e,n){Di(t,e,n);var i=t*t+e*e-n*n;if(0>i)return[];if(0===i)return[[t*n/(t*t+e*e),e*n/(t*t+e*e)]];var r=Math.sqrt(i);return[[(t*n+e*r)/(t*t+e*e),(e*n-t*r)/(t*t+e*e)],[(t*n-e*r)/(t*t+e*e),(e*n+t*r)/(t*t+e*e)]]}var Bi,zi=Math.PI/180;function Ui(t,e,n){return(1-n)*t+n*e}function Fi(t,e,n,i){return t+Math.cos(i/180*Ni)*e+Math.sin(i/180*Ni)*n}function Vi(t,e,n,i){var r=1e-6,o=e-t,a=n-e,s=3*o+3*(i-n)-6*a,l=6*(a-o),c=3*o;return Math.abs(s)<r?[-c/l]:function(t,e,n){void 0===n&&(n=1e-6);var i=t*t/4-e;if(i<-n)return[];if(i<=n)return[-t/2];var r=Math.sqrt(i);return[-t/2-r,-t/2+r]}(l/s,c/s,r)}function Hi(t,e,n,i,r){var o=1-r;return t*(o*o*o)+e*(3*o*o*r)+n*(3*o*r*r)+i*(r*r*r)}!function(t){function e(){return r(function(t,e,n){return t.relative&&(void 0!==t.x1&&(t.x1+=e),void 0!==t.y1&&(t.y1+=n),void 0!==t.x2&&(t.x2+=e),void 0!==t.y2&&(t.y2+=n),void 0!==t.x&&(t.x+=e),void 0!==t.y&&(t.y+=n),t.relative=!1),t})}function n(){var t=NaN,e=NaN,n=NaN,i=NaN;return r(function(r,o,a){return r.type&Zi.SMOOTH_CURVE_TO&&(r.type=Zi.CURVE_TO,t=isNaN(t)?o:t,e=isNaN(e)?a:e,r.x1=r.relative?o-t:2*o-t,r.y1=r.relative?a-e:2*a-e),r.type&Zi.CURVE_TO?(t=r.relative?o+r.x2:r.x2,e=r.relative?a+r.y2:r.y2):(t=NaN,e=NaN),r.type&Zi.SMOOTH_QUAD_TO&&(r.type=Zi.QUAD_TO,n=isNaN(n)?o:n,i=isNaN(i)?a:i,r.x1=r.relative?o-n:2*o-n,r.y1=r.relative?a-i:2*a-i),r.type&Zi.QUAD_TO?(n=r.relative?o+r.x1:r.x1,i=r.relative?a+r.y1:r.y1):(n=NaN,i=NaN),r})}function i(){var t=NaN,e=NaN;return r(function(n,i,r){if(n.type&Zi.SMOOTH_QUAD_TO&&(n.type=Zi.QUAD_TO,t=isNaN(t)?i:t,e=isNaN(e)?r:e,n.x1=n.relative?i-t:2*i-t,n.y1=n.relative?r-e:2*r-e),n.type&Zi.QUAD_TO){t=n.relative?i+n.x1:n.x1,e=n.relative?r+n.y1:n.y1;var o=n.x1,a=n.y1;n.type=Zi.CURVE_TO,n.x1=((n.relative?0:i)+2*o)/3,n.y1=((n.relative?0:r)+2*a)/3,n.x2=(n.x+2*o)/3,n.y2=(n.y+2*a)/3}else t=NaN,e=NaN;return n})}function r(t){var e=0,n=0,i=NaN,r=NaN;return function(o){if(isNaN(i)&&!(o.type&Zi.MOVE_TO))throw new Error("path must start with moveto");var a=t(o,e,n,i,r);return o.type&Zi.CLOSE_PATH&&(e=i,n=r),void 0!==o.x&&(e=o.relative?e+o.x:o.x),void 0!==o.y&&(n=o.relative?n+o.y:o.y),o.type&Zi.MOVE_TO&&(i=e,r=n),a}}function o(t,e,n,i,o,a){return Di(t,e,n,i,o,a),r(function(r,s,l,c){var u=r.x1,d=r.x2,h=r.relative&&!isNaN(c),p=void 0!==r.x?r.x:h?0:s,f=void 0!==r.y?r.y:h?0:l;function v(t){return t*t}r.type&Zi.HORIZ_LINE_TO&&0!==e&&(r.type=Zi.LINE_TO,r.y=r.relative?0:l),r.type&Zi.VERT_LINE_TO&&0!==n&&(r.type=Zi.LINE_TO,r.x=r.relative?0:s),void 0!==r.x&&(r.x=r.x*t+f*n+(h?0:o)),void 0!==r.y&&(r.y=p*e+r.y*i+(h?0:a)),void 0!==r.x1&&(r.x1=r.x1*t+r.y1*n+(h?0:o)),void 0!==r.y1&&(r.y1=u*e+r.y1*i+(h?0:a)),void 0!==r.x2&&(r.x2=r.x2*t+r.y2*n+(h?0:o)),void 0!==r.y2&&(r.y2=d*e+r.y2*i+(h?0:a));var m=t*i-e*n;if(void 0!==r.xRot&&(1!==t||0!==e||0!==n||1!==i))if(0===m)delete r.rX,delete r.rY,delete r.xRot,delete r.lArcFlag,delete r.sweepFlag,r.type=Zi.LINE_TO;else{var y=r.xRot*Math.PI/180,b=Math.sin(y),g=Math.cos(y),w=1/v(r.rX),x=1/v(r.rY),k=v(g)*w+v(b)*x,A=2*b*g*(w-x),_=v(b)*w+v(g)*x,E=k*i*i-A*e*i+_*e*e,C=A*(t*i+e*n)-2*(k*n*i+_*t*e),T=k*n*n-A*t*n+_*t*t,S=(Math.atan2(C,E-T)+Math.PI)%Math.PI/2,O=Math.sin(S),P=Math.cos(S);r.rX=Math.abs(m)/Math.sqrt(E*v(P)+C*O*P+T*v(O)),r.rY=Math.abs(m)/Math.sqrt(E*v(O)-C*O*P+T*v(P)),r.xRot=180*S/Math.PI}return void 0!==r.sweepFlag&&0>m&&(r.sweepFlag=+!r.sweepFlag),r})}t.ROUND=function(t){function e(e){return Math.round(e*t)/t}return void 0===t&&(t=1e13),Di(t),function(t){return void 0!==t.x1&&(t.x1=e(t.x1)),void 0!==t.y1&&(t.y1=e(t.y1)),void 0!==t.x2&&(t.x2=e(t.x2)),void 0!==t.y2&&(t.y2=e(t.y2)),void 0!==t.x&&(t.x=e(t.x)),void 0!==t.y&&(t.y=e(t.y)),void 0!==t.rX&&(t.rX=e(t.rX)),void 0!==t.rY&&(t.rY=e(t.rY)),t}},t.TO_ABS=e,t.TO_REL=function(){return r(function(t,e,n){return t.relative||(void 0!==t.x1&&(t.x1-=e),void 0!==t.y1&&(t.y1-=n),void 0!==t.x2&&(t.x2-=e),void 0!==t.y2&&(t.y2-=n),void 0!==t.x&&(t.x-=e),void 0!==t.y&&(t.y-=n),t.relative=!0),t})},t.NORMALIZE_HVZ=function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),r(function(i,r,o,a,s){if(isNaN(a)&&!(i.type&Zi.MOVE_TO))throw new Error("path must start with moveto");return e&&i.type&Zi.HORIZ_LINE_TO&&(i.type=Zi.LINE_TO,i.y=i.relative?0:o),n&&i.type&Zi.VERT_LINE_TO&&(i.type=Zi.LINE_TO,i.x=i.relative?0:r),t&&i.type&Zi.CLOSE_PATH&&(i.type=Zi.LINE_TO,i.x=i.relative?a-r:a,i.y=i.relative?s-o:s),i.type&Zi.ARC&&(0===i.rX||0===i.rY)&&(i.type=Zi.LINE_TO,delete i.rX,delete i.rY,delete i.xRot,delete i.lArcFlag,delete i.sweepFlag),i})},t.NORMALIZE_ST=n,t.QT_TO_C=i,t.INFO=r,t.SANITIZE=function(t){void 0===t&&(t=0),Di(t);var e=NaN,n=NaN,i=NaN,o=NaN;return r(function(r,a,s,l,c){var u=Math.abs,d=!1,h=0,p=0;if(r.type&Zi.SMOOTH_CURVE_TO&&(h=isNaN(e)?0:a-e,p=isNaN(n)?0:s-n),r.type&(Zi.CURVE_TO|Zi.SMOOTH_CURVE_TO)?(e=r.relative?a+r.x2:r.x2,n=r.relative?s+r.y2:r.y2):(e=NaN,n=NaN),r.type&Zi.SMOOTH_QUAD_TO?(i=isNaN(i)?a:2*a-i,o=isNaN(o)?s:2*s-o):r.type&Zi.QUAD_TO?(i=r.relative?a+r.x1:r.x1,o=r.relative?s+r.y1:r.y2):(i=NaN,o=NaN),r.type&Zi.LINE_COMMANDS||r.type&Zi.ARC&&(0===r.rX||0===r.rY||!r.lArcFlag)||r.type&Zi.CURVE_TO||r.type&Zi.SMOOTH_CURVE_TO||r.type&Zi.QUAD_TO||r.type&Zi.SMOOTH_QUAD_TO){var f=void 0===r.x?0:r.relative?r.x:r.x-a,v=void 0===r.y?0:r.relative?r.y:r.y-s;h=isNaN(i)?void 0===r.x1?h:r.relative?r.x:r.x1-a:i-a,p=isNaN(o)?void 0===r.y1?p:r.relative?r.y:r.y1-s:o-s;var m=void 0===r.x2?0:r.relative?r.x:r.x2-a,y=void 0===r.y2?0:r.relative?r.y:r.y2-s;u(f)<=t&&u(v)<=t&&u(h)<=t&&u(p)<=t&&u(m)<=t&&u(y)<=t&&(d=!0)}return r.type&Zi.CLOSE_PATH&&u(a-l)<=t&&u(s-c)<=t&&(d=!0),d?[]:r})},t.MATRIX=o,t.ROTATE=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),Di(t,e,n);var i=Math.sin(t),r=Math.cos(t);return o(r,i,-i,r,e-e*r+n*i,n-e*i-n*r)},t.TRANSLATE=function(t,e){return void 0===e&&(e=0),Di(t,e),o(1,0,0,1,t,e)},t.SCALE=function(t,e){return void 0===e&&(e=t),Di(t,e),o(t,0,0,e,0,0)},t.SKEW_X=function(t){return Di(t),o(1,0,Math.atan(t),1,0,0)},t.SKEW_Y=function(t){return Di(t),o(1,Math.atan(t),0,1,0,0)},t.X_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),Di(t),o(-1,0,0,1,t,0)},t.Y_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),Di(t),o(1,0,0,-1,0,t)},t.A_TO_C=function(){return r(function(t,e,n){return Zi.ARC===t.type?function(t,e,n){var i,r,o,a;t.cX||Mi(t,e,n);for(var s=Math.min(t.phi1,t.phi2),l=Math.max(t.phi1,t.phi2)-s,c=Math.ceil(l/90),u=new Array(c),d=e,h=n,p=0;p<c;p++){var f=Ui(t.phi1,t.phi2,p/c),v=Ui(t.phi1,t.phi2,(p+1)/c),m=v-f,y=4/3*Math.tan(m*zi/4),b=[Math.cos(f*zi)-y*Math.sin(f*zi),Math.sin(f*zi)+y*Math.cos(f*zi)],g=b[0],w=b[1],x=[Math.cos(v*zi),Math.sin(v*zi)],k=x[0],A=x[1],_=[k+y*Math.sin(v*zi),A-y*Math.cos(v*zi)],E=_[0],C=_[1];u[p]={relative:t.relative,type:Zi.CURVE_TO};var T=function(e,n){var i=ji([e*t.rX,n*t.rY],t.xRot),r=i[0],o=i[1];return[t.cX+r,t.cY+o]};i=T(g,w),u[p].x1=i[0],u[p].y1=i[1],r=T(E,C),u[p].x2=r[0],u[p].y2=r[1],o=T(k,A),u[p].x=o[0],u[p].y=o[1],t.relative&&(u[p].x1-=d,u[p].y1-=h,u[p].x2-=d,u[p].y2-=h,u[p].x-=d,u[p].y-=h),d=(a=[u[p].x,u[p].y])[0],h=a[1]}return u}(t,t.relative?0:e,t.relative?0:n):t})},t.ANNOTATE_ARCS=function(){return r(function(t,e,n){return t.relative&&(e=0,n=0),Zi.ARC===t.type&&Mi(t,e,n),t})},t.CLONE=function(){return function(t){var e={};for(var n in t)e[n]=t[n];return e}},t.CALCULATE_BOUNDS=function(){var t=e(),o=i(),a=n(),s=r(function(e,n,i){var r=a(o(t(function(t){var e={};for(var n in t)e[n]=t[n];return e}(e))));function l(t){t>s.maxX&&(s.maxX=t),t<s.minX&&(s.minX=t)}function c(t){t>s.maxY&&(s.maxY=t),t<s.minY&&(s.minY=t)}if(r.type&Zi.DRAWING_COMMANDS&&(l(n),c(i)),r.type&Zi.HORIZ_LINE_TO&&l(r.x),r.type&Zi.VERT_LINE_TO&&c(r.y),r.type&Zi.LINE_TO&&(l(r.x),c(r.y)),r.type&Zi.CURVE_TO){l(r.x),c(r.y);for(var u=0,d=Vi(n,r.x1,r.x2,r.x);u<d.length;u++)0<(T=d[u])&&1>T&&l(Hi(n,r.x1,r.x2,r.x,T));for(var h=0,p=Vi(i,r.y1,r.y2,r.y);h<p.length;h++)0<(T=p[h])&&1>T&&c(Hi(i,r.y1,r.y2,r.y,T))}if(r.type&Zi.ARC){l(r.x),c(r.y),Mi(r,n,i);for(var f=r.xRot/180*Math.PI,v=Math.cos(f)*r.rX,m=Math.sin(f)*r.rX,y=-Math.sin(f)*r.rY,b=Math.cos(f)*r.rY,g=r.phi1<r.phi2?[r.phi1,r.phi2]:-180>r.phi2?[r.phi2+360,r.phi1+360]:[r.phi2,r.phi1],w=g[0],x=g[1],k=function(t){var e=t[0],n=t[1],i=180*Math.atan2(n,e)/Math.PI;return i<w?i+360:i},A=0,_=Li(y,-v,0).map(k);A<_.length;A++)(T=_[A])>w&&T<x&&l(Fi(r.cX,v,y,T));for(var E=0,C=Li(b,-m,0).map(k);E<C.length;E++){var T;(T=C[E])>w&&T<x&&c(Fi(r.cY,m,b,T))}}return e});return s.minX=1/0,s.maxX=-1/0,s.minY=1/0,s.maxY=-1/0,s}}(Bi||(Bi={}));var Wi,$i=function(){function t(){}return t.prototype.round=function(t){return this.transform(Bi.ROUND(t))},t.prototype.toAbs=function(){return this.transform(Bi.TO_ABS())},t.prototype.toRel=function(){return this.transform(Bi.TO_REL())},t.prototype.normalizeHVZ=function(t,e,n){return this.transform(Bi.NORMALIZE_HVZ(t,e,n))},t.prototype.normalizeST=function(){return this.transform(Bi.NORMALIZE_ST())},t.prototype.qtToC=function(){return this.transform(Bi.QT_TO_C())},t.prototype.aToC=function(){return this.transform(Bi.A_TO_C())},t.prototype.sanitize=function(t){return this.transform(Bi.SANITIZE(t))},t.prototype.translate=function(t,e){return this.transform(Bi.TRANSLATE(t,e))},t.prototype.scale=function(t,e){return this.transform(Bi.SCALE(t,e))},t.prototype.rotate=function(t,e,n){return this.transform(Bi.ROTATE(t,e,n))},t.prototype.matrix=function(t,e,n,i,r,o){return this.transform(Bi.MATRIX(t,e,n,i,r,o))},t.prototype.skewX=function(t){return this.transform(Bi.SKEW_X(t))},t.prototype.skewY=function(t){return this.transform(Bi.SKEW_Y(t))},t.prototype.xSymmetry=function(t){return this.transform(Bi.X_AXIS_SYMMETRY(t))},t.prototype.ySymmetry=function(t){return this.transform(Bi.Y_AXIS_SYMMETRY(t))},t.prototype.annotateArcs=function(){return this.transform(Bi.ANNOTATE_ARCS())},t}(),Gi=function(t){return" "===t||"\t"===t||"\r"===t||"\n"===t},qi=function(t){return"0".charCodeAt(0)<=t.charCodeAt(0)&&t.charCodeAt(0)<="9".charCodeAt(0)},Xi=function(t){function e(){var e=t.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return Ri(e,t),e.prototype.finish=function(t){if(void 0===t&&(t=[]),this.parse(" ",t),0!==this.curArgs.length||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return t},e.prototype.parse=function(t,e){var n=this;void 0===e&&(e=[]);for(var i=function(t){e.push(t),n.curArgs.length=0,n.canParseCommandOrComma=!0},r=0;r<t.length;r++){var o=t[r],a=!(this.curCommandType!==Zi.ARC||3!==this.curArgs.length&&4!==this.curArgs.length||1!==this.curNumber.length||"0"!==this.curNumber&&"1"!==this.curNumber),s=qi(o)&&("0"===this.curNumber&&"0"===o||a);if(!qi(o)||s)if("e"!==o&&"E"!==o)if("-"!==o&&"+"!==o||!this.curNumberHasExp||this.curNumberHasExpDigits)if("."!==o||this.curNumberHasExp||this.curNumberHasDecimal||a){if(this.curNumber&&-1!==this.curCommandType){var l=Number(this.curNumber);if(isNaN(l))throw new SyntaxError("Invalid number ending at "+r);if(this.curCommandType===Zi.ARC)if(0===this.curArgs.length||1===this.curArgs.length){if(0>l)throw new SyntaxError('Expected positive number, got "'+l+'" at index "'+r+'"')}else if((3===this.curArgs.length||4===this.curArgs.length)&&"0"!==this.curNumber&&"1"!==this.curNumber)throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+r+'"');this.curArgs.push(l),this.curArgs.length===Yi[this.curCommandType]&&(Zi.HORIZ_LINE_TO===this.curCommandType?i({type:Zi.HORIZ_LINE_TO,relative:this.curCommandRelative,x:l}):Zi.VERT_LINE_TO===this.curCommandType?i({type:Zi.VERT_LINE_TO,relative:this.curCommandRelative,y:l}):this.curCommandType===Zi.MOVE_TO||this.curCommandType===Zi.LINE_TO||this.curCommandType===Zi.SMOOTH_QUAD_TO?(i({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),Zi.MOVE_TO===this.curCommandType&&(this.curCommandType=Zi.LINE_TO)):this.curCommandType===Zi.CURVE_TO?i({type:Zi.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===Zi.SMOOTH_CURVE_TO?i({type:Zi.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Zi.QUAD_TO?i({type:Zi.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Zi.ARC&&i({type:Zi.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!Gi(o))if(","===o&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if("+"!==o&&"-"!==o&&"."!==o)if(s)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(0!==this.curArgs.length)throw new SyntaxError("Unterminated command at index "+r+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+r+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,"z"!==o&&"Z"!==o)if("h"===o||"H"===o)this.curCommandType=Zi.HORIZ_LINE_TO,this.curCommandRelative="h"===o;else if("v"===o||"V"===o)this.curCommandType=Zi.VERT_LINE_TO,this.curCommandRelative="v"===o;else if("m"===o||"M"===o)this.curCommandType=Zi.MOVE_TO,this.curCommandRelative="m"===o;else if("l"===o||"L"===o)this.curCommandType=Zi.LINE_TO,this.curCommandRelative="l"===o;else if("c"===o||"C"===o)this.curCommandType=Zi.CURVE_TO,this.curCommandRelative="c"===o;else if("s"===o||"S"===o)this.curCommandType=Zi.SMOOTH_CURVE_TO,this.curCommandRelative="s"===o;else if("q"===o||"Q"===o)this.curCommandType=Zi.QUAD_TO,this.curCommandRelative="q"===o;else if("t"===o||"T"===o)this.curCommandType=Zi.SMOOTH_QUAD_TO,this.curCommandRelative="t"===o;else{if("a"!==o&&"A"!==o)throw new SyntaxError('Unexpected character "'+o+'" at index '+r+".");this.curCommandType=Zi.ARC,this.curCommandRelative="a"===o}else e.push({type:Zi.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal="."===o}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return e},e.prototype.transform=function(t){return Object.create(this,{parse:{value:function(e,n){void 0===n&&(n=[]);for(var i=0,r=Object.getPrototypeOf(this).parse.call(this,e);i<r.length;i++){var o=r[i],a=t(o);Array.isArray(a)?n.push.apply(n,a):n.push(a)}return n}}})},e}($i),Zi=function(t){function e(n){var i=t.call(this)||this;return i.commands="string"==typeof n?e.parse(n):n,i}return Ri(e,t),e.prototype.encode=function(){return e.encode(this.commands)},e.prototype.getBounds=function(){var t=Bi.CALCULATE_BOUNDS();return this.transform(t),t},e.prototype.transform=function(t){for(var e=[],n=0,i=this.commands;n<i.length;n++){var r=t(i[n]);Array.isArray(r)?e.push.apply(e,r):e.push(r)}return this.commands=e,this},e.encode=function(t){return function(t){var e="";Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];if(i.type===Zi.CLOSE_PATH)e+="z";else if(i.type===Zi.HORIZ_LINE_TO)e+=(i.relative?"h":"H")+i.x;else if(i.type===Zi.VERT_LINE_TO)e+=(i.relative?"v":"V")+i.y;else if(i.type===Zi.MOVE_TO)e+=(i.relative?"m":"M")+i.x+" "+i.y;else if(i.type===Zi.LINE_TO)e+=(i.relative?"l":"L")+i.x+" "+i.y;else if(i.type===Zi.CURVE_TO)e+=(i.relative?"c":"C")+i.x1+" "+i.y1+" "+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===Zi.SMOOTH_CURVE_TO)e+=(i.relative?"s":"S")+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===Zi.QUAD_TO)e+=(i.relative?"q":"Q")+i.x1+" "+i.y1+" "+i.x+" "+i.y;else if(i.type===Zi.SMOOTH_QUAD_TO)e+=(i.relative?"t":"T")+i.x+" "+i.y;else{if(i.type!==Zi.ARC)throw new Error('Unexpected command type "'+i.type+'" at index '+n+".");e+=(i.relative?"a":"A")+i.rX+" "+i.rY+" "+i.xRot+" "+ +i.lArcFlag+" "+ +i.sweepFlag+" "+i.x+" "+i.y}}return e}(t)},e.parse=function(t){var e=new Xi,n=[];return e.parse(t,n),e.finish(n),n},e.CLOSE_PATH=1,e.MOVE_TO=2,e.HORIZ_LINE_TO=4,e.VERT_LINE_TO=8,e.LINE_TO=16,e.CURVE_TO=32,e.SMOOTH_CURVE_TO=64,e.QUAD_TO=128,e.SMOOTH_QUAD_TO=256,e.ARC=512,e.LINE_COMMANDS=e.LINE_TO|e.HORIZ_LINE_TO|e.VERT_LINE_TO,e.DRAWING_COMMANDS=e.HORIZ_LINE_TO|e.VERT_LINE_TO|e.LINE_TO|e.CURVE_TO|e.SMOOTH_CURVE_TO|e.QUAD_TO|e.SMOOTH_QUAD_TO|e.ARC,e}($i),Yi=((Wi={})[Zi.MOVE_TO]=2,Wi[Zi.LINE_TO]=2,Wi[Zi.HORIZ_LINE_TO]=1,Wi[Zi.VERT_LINE_TO]=1,Wi[Zi.CLOSE_PATH]=0,Wi[Zi.QUAD_TO]=4,Wi[Zi.SMOOTH_QUAD_TO]=2,Wi[Zi.CURVE_TO]=6,Wi[Zi.SMOOTH_CURVE_TO]=4,Wi[Zi.ARC]=7,Wi),Qi={},Ki=function(t,e,n){var i=[];return t.commands.forEach(function(t,r){i.push(function(t,e,n){if(t.type!==e.type)throw new Error("Cannot diff between different command types");var i=t,r=e,o={};return["x","y","x1","y1","x2","y2"].forEach(function(t){void 0!==i[t]&&void 0!==r[t]&&(o[t]=(r[t]-i[t])*n)}),o}(t,e.commands[r],n))}),i},Ji=function(t,e,n){var i=e.max-e.min,r=n.max-n.min,o=(t-e.min)/i;return n.min+o*r},tr=function(t,e,n){for(var i=t,r=0;r<e.length;r++){var o=e[r];if(r===e.length-1)return void(i[o]=n);i[o]||(i[o]={}),i=i[o]}},er=function(){var t=i(m().m(function t(e){return m().w(function(t){for(;;)if(0===t.n)return t.a(2,"function"==typeof window.fetch?fetch(e).then(function(t){return t.json()}):new Promise(function(t,n){var i=new XMLHttpRequest;i.addEventListener("load",function(){try{t(JSON.parse(i.responseText))}catch(t){n(t)}}),i.onerror=n,i.open("GET",e),i.send()}))},t)}));return function(e){return t.apply(this,arguments)}}(),nr=function(){var t=i(m().m(function t(e){var n,i,r,o,a,s;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n=e.category,i=e.url,r=e.json,o=null,r)if("string"==typeof r)try{o=JSON.parse(r)}catch(t){}else"object"==_(r)&&(o=r);if(o||!i){t.n=4;break}return t.p=1,t.n=2,er(i);case 2:o=t.v,t.n=4;break;case 3:return t.p=3,s=t.v,console.error(s),t.a(2);case 4:if(o){t.n=5;break}return t.a(2);case 5:a=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n<=0)return t;for(var i in e)t[i]?t[i]=a(t[i],e[i],n-1):t[i]=e[i];return t},n?lr[n]=a(lr[n]||{},o,2):Object.keys(o).map(function(t){lr[t]=a(lr[t]||{},o[t],2)});case 6:return t.a(2)}},t,null,[[1,3]])}));return function(e){return t.apply(this,arguments)}}(),ir=[],rr=function(){var t=i(m().m(function t(e){var n;return m().w(function(t){for(;;)switch(t.n){case 0:return n=Promise.all(e.map(nr)),ir.push(n),t.n=1,n;case 1:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}(),or=function(){var t=i(m().m(function t(e){var n,i,r,o,a,s,l,c,u,d,h,p,f,v,y,b,w,x,k,A,E;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!(("undefined"==typeof window?"undefined":_(window))>"u")){t.n=1;break}return t.a(2,Promise.resolve(null));case 1:if(f=e.icon.split("/"),v=g(f,3),y=v[0],b=v[1],w=v[2],y&&b&&w){t.n=2;break}throw new Error("SVGIconNext: invalid icon option");case 2:return t.p=2,t.n=3,Promise.all(ir);case 3:t.n=5;break;case 4:t.p=4,t.v;case 5:if(null==(i=null==(n=lr[y])?void 0:n[b])||!i[w]){t.n=6;break}return t.a(2,null==(o=null==(r=lr[y])?void 0:r[b])?void 0:o[w]);case 6:if(null==(s=null==(a=Qi[y])?void 0:a[b])||!s[w]){t.n=7;break}return t.a(2,null==(c=null==(l=Qi[y])?void 0:l[b])?void 0:c[w]);case 7:return t.p=7,x=er("//i0.hdslb.com/bfs/svg-next/".concat(y,"/").concat(b,"/v").concat(w,".json")),tr(Qi,f,x),k=tr,A=lr,E=f,t.n=8,null==(d=null==(u=Qi[y])?void 0:u[b])?void 0:d[w];case 8:k(A,E,t.v),t.n=10;break;case 9:throw t.p=9,t.v,tr(Qi,f,null),new Error("SVGIconNext: fetch icon config failed");case 10:return t.a(2,null==(p=null==(h=lr[y])?void 0:h[b])?void 0:p[w])}},t,null,[[7,9],[2,4]])}));return function(e){return t.apply(this,arguments)}}(),ar=function(t,e){var n;if(!t.palette)return"currentColor";if(Array.isArray(t.palette))return t.palette;var i=null==(n=null==e?void 0:e.palettes)?void 0:n.find(function(e){return e.name===t.palette});return i?i.value:t.palette},sr=function(t,e){var n,i;if(!e)return[];var r=function(t){var e=[24,24];return Array.isArray(t.size)?(e[0]=t.size[0],e[1]=t.size[1]):"number"==typeof t.size&&!Number.isNaN(e)&&(e[0]=t.size,e[1]=t.size),e}(t),o=e.default.map(function(t){return new Zi(t).toAbs()}),a=(null==(n=e.axes)?void 0:n.map(function(t){return{min:t.min.map(function(t){return new Zi(t).toAbs()}),max:t.max.map(function(t){return new Zi(t).toAbs()})}}))||[];return null!=(i=e.axes)&&i.length?o.map(function(n,i){var o=e.axes.map(function(e,o){var s=a[o].min[i],l=a[o].max[i];if(!s||!l||[s,l].some(function(t){return t.commands.length!==n.commands.length}))return[];var c=function(){var n,i=null==(n=t.axes)?void 0:n[e.name];return i?"stroke"===e.name?i/(r[0]/24):i:e.value.default}(),u=0;if(c<e.value.default){var d={min:e.value.min,max:e.value.default};u=Ji(c,d,{min:-1,max:0})}else{var h={min:e.value.default,max:e.value.max};u=Ji(c,h,{min:0,max:1})}return Ki(n,u<0?s:l,Math.abs(u))});return function(t,e){var n,i=new Zi(t.encode()),r=l(e);try{var o=function(){var t=n.value;0!==t.length&&i.commands.forEach(function(e,n){Object.keys(t[n]).forEach(function(i){e[i]=e[i]+t[n][i]})})};for(r.s();!(n=r.n()).done;)o()}catch(t){r.e(t)}finally{r.f()}return i}(n,o).scale(r[0]/24,r[1]/24).encode()}):o.map(function(t){return new Zi(t.encode()).scale(r[0]/24,r[1]/24).encode()})},lr={};("undefined"==typeof window?"undefined":_(window))<"u"&&(window.__SVG_ICON_NEXT_CACHE__&&(lr=window.__SVG_ICON_NEXT_CACHE__),window.__SVG_ICON_NEXT_PRELOAD_PACKS__||(window.__SVG_ICON_NEXT_PRELOAD_PACKS__=rr));var cr=function(t){function e(){var t;return o(this,e),(t=r(this,e)).axes=null,t.palette="",t.width="",t.height="",t.attachShadow({mode:"open"}),t.shadowRoot&&(t.shadowRoot.innerHTML='\n        <style>\n          :host {\n            display: inline-flex;\n            align-items: center;\n          }\n        </style>\n        <svg\n          id="icon"\n          xmlns="http://www.w3.org/2000/svg"\n          xmlns:xlink="http://www.w3.org/1999/xlink"\n        ></svg>\n      '),t}return h(e,t),s(e,[{key:"connectedCallback",value:function(){if(this.shadowRoot){var t=this.getAttribute("icon");t&&this.updateSvg(t)}}},{key:"disconnectedCallback",value:function(){this.palette="",this.axes={}}},{key:"getSVGIconOptions",value:function(t){return{icon:t,size:[Number(this.width),Number(this.height)],axes:this.axes||{},palette:this.palette}}},{key:"initSize",value:function(){var t="24",e="24",n=this.getAttribute("size")||"";if(n){var i=n.split(",");return 2===i.length?(t=i[0],e=i[1]):t=e=i[0],this.width=t,void(this.height=e)}var r=this.getAttribute("width"),o=this.getAttribute("height");r&&o&&(t=r,e=o),this.width=t,this.height=e}},{key:"updateSvg",value:(n=i(m().m(function t(e){var n,i,r,o,a,s,l=this;return m().w(function(t){for(;;)switch(t.n){case 0:if(this.shadowRoot){t.n=1;break}return t.a(2);case 1:if(n=this.shadowRoot.querySelector("#icon")){t.n=2;break}return t.a(2);case 2:return this.initSize(),n.setAttribute("width",this.width),n.setAttribute("height",this.height),n.setAttribute("viewBox","0 0 ".concat(this.width," ").concat(this.height)),i=this.getSVGIconOptions(e),t.n=3,or(i);case 3:if(r=t.v){t.n=4;break}return t.a(2);case 4:null!=(o=sr(i,r))&&o.length&&(null!=(a=ar(i,r))&&a.length&&(this.palette=a),s=o.map(function(t,e){return'\n                    <path\n                        d="'.concat(t,'"\n                        fill="').concat("string"==typeof l.palette?l.palette:l.palette[e]||"",'"\n                    ></path>\n                ')}).join(""),n.innerHTML=s);case 5:return t.a(2)}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"attributeChangedCallback",value:function(t,e,n){if("icon"===t)n&&n!==e&&this.updateSvg(n)}}],[{key:"observedAttributes",get:function(){return["icon"]}}]);var n}(C(HTMLElement));cr.elName="bili-icon",customElements.get(cr.elName)||customElements.define(cr.elName,cr);var ur=function(t){function e(){var t;o(this,e),(t=r(this,e)).disposables=Rn(),t.deferred=On(),t.onConfirm=null,t.onCancel=null,t.final=null;var n=t.attachShadow({mode:"open"}),i=document.createElement("template");i.innerHTML='\n        <style>\n            :host {\n              position: fixed;\n              bottom: 0;\n              left: 0;\n              right: 0;\n              top: 0;\n            }\n            #mask {\n              position: absolute;\n              bottom: 0;\n              left: 0;\n              right: 0;\n              top: 0;\n              background-color: rgba(0, 0, 0, 0.5);\n            }\n            #wrap {\n              position: absolute;\n              bottom: 0;\n              left: 0;\n              right: 0;\n              top: 0;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n            }\n            #dialog {\n              -webkit-font-smoothing: antialiased;\n              background-color: var(--bg1);\n              border-radius: 8px;\n              box-sizing: border-box;\n              font-family: PingFang SC,HarmonyOS_Regular,Helvetica Neue,Microsoft YaHei,sans-serif!important;\n              font-weight: 400;\n              overflow: hidden;\n              padding-bottom: 24px!important;\n              padding: 16px;\n              position: relative;\n              width: 320px;\n              transform-origin: center center;\n            }\n            #close {\n                color: var(--text2);\n                cursor: pointer;\n                height: 22px;\n                position: absolute;\n                right: 16px;\n                top: 16px;\n                width: 22px;\n            }\n            #title {\n                color: var(--text1);\n                font-size: 16px;\n                font-weight: 600;\n                margin-top: 16px;\n                margin-bottom: 10px;\n                text-align: center;\n                padding: 0 16px;\n            }\n            #message {\n                color: var(--text2);\n                font-size: 14px;\n                margin-bottom: 14px;\n                text-align: center;\n                padding: 0 16px 10px;\n                white-space: pre-wrap;\n            }\n            #action {\n                align-items: center;\n                display: flex;\n                justify-content: center;\n                padding-right: 12px;\n            }\n            #action button {\n                -webkit-font-smoothing: antialiased;\n                border: 1px solid var(--brand_blue);\n                border-radius: 6px;\n                box-sizing: border-box;\n                cursor: pointer;\n                font-family: PingFang SC,HarmonyOS_Regular,Helvetica Neue,Microsoft YaHei,sans-serif!important;\n                font-weight: 400;\n                height: 32px;\n                outline: none;\n                transition: all .2s;\n                width: 130px;\n                margin-left: 12px;\n            }\n            #action button#cancel {\n                background-color: var(--bg1);\n                border-color: var(--line_regular);\n                color: var(--text1);\n            }\n            #action button#confirm {\n                background-color: var(--brand_blue);\n                border-color: var(--brand_blue);\n                color: var(--text_white);\n            }\n        </style>\n        <div id="mask"></div>\n        <div id="wrap">\n          <div \n              role="dialog" \n              id="dialog"\n          >\n              <div id="close"><bili-icon icon="BDC/xmark_close_line/1" size="22"></bili-icon></div>\n              <div id="title"></div>\n              <div id="message"></div>\n              <div id="action">\n                  <button id="cancel"></button>\n                  <button id="confirm"></button>\n              </div>\n          </div>\n        </div>\n    ';var a=document.importNode(i.content,!0);return n.appendChild(a),t}return h(e,t),s(e,[{key:"getEl",value:function(t){var e;return null==(e=this.shadowRoot)?void 0:e.querySelector("#".concat(t))}},{key:"connectedCallback",value:function(){var t=this;this.disposables.addEventListener(this.getEl("close"),"click",function(){t.handleActionEvent("cancel")}),this.disposables.addEventListener(this.getEl("cancel"),"click",function(){t.handleActionEvent("cancel")}),this.disposables.addEventListener(this.getEl("confirm"),"click",function(){t.handleActionEvent("confirm")})}},{key:"disconnectedCallback",value:function(){this.disposables.dispose()}},{key:"handleActionEvent",value:(l=i(m().m(function t(e){var n,i;return m().w(function(t){for(;;)switch(t.n){case 0:if(!(i="cancel"===e?this.onCancel:this.onConfirm)){t.n=2;break}return t.n=1,i(this.hide.bind(this));case 1:t.n=3;break;case 2:return t.n=3,this.hide();case 3:null==(n=this.final)||n.call(this);case 4:return t.a(2)}},t,this)})),function(t){return l.apply(this,arguments)})},{key:"handleText",value:function(t,e){this.getEl(t).textContent=e,""===e&&this.handleVisible(t,!1)}},{key:"doTransition",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,r=this.getEl(t);r.style.transition="all ".concat(i,"ms linear"),r.style.opacity="var(--bili-modal-opacity, ".concat(e?"0":"1",")"),"dialog"===t&&(r.style.transform="var(--bili-modal-transform, scale(1))"),e&&(r.style.display="block"),setTimeout(function(){r.style.setProperty("--bili-modal-opacity",e?"1":"0"),"dialog"===t&&r.style.setProperty("--bili-modal-transform",e?"scale(1)":"scale(.8)"),setTimeout(function(){e||(r.style.display="none","mask"===t&&n.handleVisible("",!1)),r.style.removeProperty("transition"),r.style.removeProperty("opacity"),r.style.removeProperty("--bili-modal-opacity"),n.deferred.resolve(!0)},i+20)},0)}},{key:"handleVisible",value:function(t,e,n){var i=""===t?this:this.getEl(t);n?"mask"!==t&&"dialog"!==t||this.doTransition(t,e):i.style.display=e?"block":"none"}},{key:"handleAction",value:function(t,e){var n=this;if(!1!==e&&""!==e){this.handleVisible(t,!0);var r=function(){var t=i(m().m(function t(){return m().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,n.hide();case 1:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),o="cancel"===t?"":"";_(e)>"u"?e={text:o,click:r}:"string"==typeof e?e={text:e,click:r}:"function"==typeof e&&(e={text:o,click:e});var a=e;this.handleText(t,a.text),this["cancel"===t?"onCancel":"onConfirm"]=a.click}else this.handleVisible(t,!1)}},{key:"show",value:(a=i(m().m(function t(e){return m().w(function(t){for(;;)switch(t.n){case 0:return this.deferred=On(),this.final=e.final||null,this.handleVisible("mask",!1!==e.mask,!0),this.handleVisible("dialog",!0),this.handleVisible("",!0),this.style.setProperty("z-index",String(e.zIndex||Nn()),"important"),this.handleText("title",e.title||""),this.handleText("message",e.message||""),this.handleAction("cancel",e.cancel),this.handleAction("confirm",e.confirm),t.n=1,this.deferred.promise;case 1:return t.a(2)}},t,this)})),function(t){return a.apply(this,arguments)})},{key:"hide",value:(n=i(m().m(function t(){return m().w(function(t){for(;;)switch(t.n){case 0:return this.deferred=On(),this.handleVisible("dialog",!1,!0),"block"===this.getEl("mask").style.display?this.handleVisible("mask",!1,!0):this.handleVisible("",!1),t.n=1,this.deferred.promise;case 1:return t.a(2)}},t,this)})),function(){return n.apply(this,arguments)})}]);var n,a,l}(C(HTMLElement));customElements.get("bili-modal")||customElements.define("bili-modal",ur);var dr=333,hr="cubic-bezier(0.4, 0, 0.22, 1)",pr=function(t){function e(){var t;return o(this,e),(t=r(this,e)).visible=!1,t.disposables=Rn(),t.imgs=[],t.isOpening=!1,t.isZoomIn=!1,t.isZooming=!1,t.isOpen=!1,t.isClosing=!1,t.currIndex=0,t.removeSelfByClose=!1,t.isZoomInDragging=!1,t.zoomInDragPos=null,t.zoomInOffset={x:0,y:0},t.viewportRect={w:0,h:0,x:0,y:0},t.attachShadow({mode:"open"}),t.render(),t}return h(e,t),s(e,[{key:"shadowRootQuerySelector",value:function(t){return this.shadowRoot.querySelector(t)}},{key:"container",get:function(){return this.shadowRootQuerySelector("#container")}},{key:"item",get:function(){return this.shadowRootQuerySelector("#container #item")}},{key:"zoomWrap",get:function(){return this.shadowRootQuerySelector("#container #item #zoom-wrap")}},{key:"currImgEl",get:function(){return this.shadowRootQuerySelector("#container #item #zoom-wrap img")}},{key:"spinner",get:function(){return this.shadowRootQuerySelector("#container #spinner")}},{key:"thumb",get:function(){return this.shadowRootQuerySelector("#wrap #thumb")}},{key:"currImg",get:function(){return this.imgs[this.currIndex]}},{key:"connectedCallback",value:(b=i(m().m(function t(){var e=this;return m().w(function(t){for(;;)switch(t.n){case 0:Pn(function(){e.initEvents()});case 1:return t.a(2)}},t)})),function(){return b.apply(this,arguments)})},{key:"timeoutPromise",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(n){t.disposables.setTimeout(function(){n(!0)},e)})}},{key:"initEvents",value:function(){var t=this;if(this.shadowRoot){var e=this.shadowRoot.querySelector("#close"),n=this.shadowRoot.querySelector("#prev"),r=this.shadowRoot.querySelector("#next");this.disposables.addEventListener(e,"click",function(){t.close()}),this.disposables.addEventListener(n,"click",function(){t.prev()}),this.disposables.addEventListener(r,"click",function(){t.next()}),this.disposables.addEventListener(this.thumb,"click",function(e){if(e.target instanceof HTMLElement){var n,i=null!==(n=e.target.dataset.index)&&void 0!==n?n:t.currIndex;i!==t.currIndex&&t.goTo(Number(i))}}),this.disposables.addEventListener(this.zoomWrap,"click",function(e){if(!t.isZoomInDragging)if(t.isZoomIn)t.zoomTo();else{var n=t.zoomWrap.getBoundingClientRect(),i=n.left,r=n.top;t.zoomTo({x:e.clientX-i,y:e.clientY-r})}});var o=function(e){t.isOpen&&e.preventDefault()};this.disposables.addEventListener(this,"touchmove",o,{passive:!1}),this.disposables.addEventListener(this.container,"click",function(e){if(e.target===t.item){if(t.isZoomIn||t.isZooming)return;t.close()}}),this.disposables.addEventListener(this.zoomWrap,"wheel",function(e){o(e),t.isZoomIn&&!t.isZooming&&t.scrollZoomWrap(e.deltaX,e.deltaY)},{passive:!0}),this.disposables.addEventListener(this.zoomWrap,"mousedown",function(e){!t.isZoomIn||t.isZooming||(t.isZoomInDragging=!0,t.zoomInDragPos={x:e.clientX,y:e.clientY,isOrigin:!0})}),this.disposables.addEventListener(this.zoomWrap,"mousemove",function(e){if(t.isZoomIn&&!t.isZooming&&t.zoomInDragPos){var n=t.zoomInDragPos.x-e.clientX,i=t.zoomInDragPos.y-e.clientY;t.scrollZoomWrap(n,i),t.zoomInDragPos={x:e.clientX,y:e.clientY,isOrigin:!1}}}),this.disposables.addEventListener(this.zoomWrap,"mouseup",i(m().m(function e(){var n;return m().w(function(e){for(;;)switch(e.n){case 0:if(!t.isZoomIn||t.isZooming){e.n=4;break}if(t.zoomInDragPos){e.n=1;break}return t.isZoomInDragging=!1,e.a(2);case 1:if(null==(n=t.zoomInDragPos)||!n.isOrigin){e.n=2;break}return t.zoomInDragPos=null,t.isZoomInDragging=!1,e.a(2);case 2:return t.zoomInDragPos=null,e.n=3,t.timeoutPromise(300);case 3:t.isZoomInDragging=!1;case 4:return e.a(2)}},e)}))),this.disposables.addEventListener(document,"keydown",function(e){var n=function(){e.stopPropagation(),e.preventDefault()};if(t.isOpen)switch(e.key){case"Escape":t.close(),n();break;case"ArrowLeft":t.prev(),n();break;case"ArrowRight":t.next(),n()}}),this.disposables.addEventListener(window,"resize",function(t,e,n){var i,r=n||{},o=r.noTrailing,a=void 0!==o&&o,s=r.noLeading,l=void 0!==s&&s,c=r.debounceMode,u=void 0===c?void 0:c,d=!1,h=0;function p(){i&&clearTimeout(i)}function f(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var s=this,c=Date.now()-h;function f(){h=Date.now(),e.apply(s,r)}function v(){i=void 0}d||(l||!u||i||f(),p(),void 0===u&&c>t?l?(h=Date.now(),a||(i=setTimeout(u?v:f,t))):f():!0!==a&&(i=setTimeout(u?v:f,void 0===u?t-c:t)))}return f.cancel=function(t){var e=(t||{}).upcomingOnly,n=void 0!==e&&e;p(),d=!n},f}(10,function(){t.getViewportRect(),!t.isZooming&&!t.isZoomInDragging&&t.currImg&&(delete t.currImg.zoom,t.calculateImgZoom(),t.animateToOpenState(!1))}))}}},{key:"disconnectedCallback",value:function(){this.disposables.dispose(),this.isOpen=!1}},{key:"getViewportRect",value:function(){var t=this.container;if(t){var e=t.getBoundingClientRect(),n=e.width,i=e.height,r=e.x,o=e.y;this.viewportRect.w=n,this.viewportRect.h=i,this.viewportRect.x=r,this.viewportRect.y=o}}},{key:"setTransitionStyle",value:function(t,e,n,i){t.style.setProperty("transition",e?"".concat(e," ").concat(n,"ms ").concat(i||hr):"none")}},{key:"removeTransitionStyle",value:function(t){t.style.removeProperty("transition")}},{key:"animateTo",value:(y=i(m().m(function t(e,n,i){return m().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.timeoutPromise();case 1:return this.setTransitionStyle(e,n,dr),t.n=2,this.timeoutPromise(30);case 2:e.style.setProperty(n,i);case 3:return t.a(2)}},t,this)})),function(t,e,n){return y.apply(this,arguments)})},{key:"initialize",value:(f=i(m().m(function t(e){var n,i,r,o,a,s,l,c;return m().w(function(t){for(;;)switch(t.n){case 0:if(n=function(){return new Error("bili photoswipe open options error")},i=e.gallery,r=e.children,o=e.dataSource,a=e.index,s=e.appendToEl,!i||!r){t.n=3;break}if(l=document.querySelector(i)){t.n=1;break}return t.a(2,Promise.reject(n()));case 1:if((c=Array.from(l.querySelectorAll(r)||[])).length){t.n=2;break}return t.a(2,Promise.reject(n()));case 2:this.imgs=Array.from(c).map(function(t){var e=t.dataset;return{src:e.pswpSrc||"",width:Number(e.pswpWidth)||0,height:Number(e.pswpHeight)||0,thumbEl:t,thumbCropped:null!==e.cropped}}),t.n=5;break;case 3:if(null==o||!o.length){t.n=4;break}this.imgs=o.map(function(t){return v({},t)}),t.n=5;break;case 4:return t.a(2,Promise.reject(n()));case 5:if("number"==typeof a&&a>=0&&a<this.imgs.length&&(this.currIndex=0|a),!s&&this.parentElement){t.n=6;break}return this.removeSelfByClose=!0,(s||document.body).appendChild(this),t.n=6,this.timeoutPromise();case 6:this.getViewportRect(),this.setAttribute("visible",""),this.style.setProperty("z-index",String(1e4+Nn())),this.setThumb();case 7:return t.a(2)}},t,this)})),function(t){return f.apply(this,arguments)})},{key:"setThumb",value:function(){if(1!==this.imgs.length){this.thumb.innerHTML=this.imgs.map(function(t,e){return function(t,e){return'\n        <div class="thumb-item" data-index="'.concat(e,'"><img src="').concat(t,'"></div>\n      ')}("".concat(t.src,"@96w_96h_1c.webp"),e)}).join(""),this.updateThumbActive()}else this.thumb.style.display="none"}},{key:"updateThumbActive",value:function(){if(1!==this.imgs.length){var t=this.thumb.querySelector(".thumb-item.active");t&&t.classList.remove("active");var e=this.thumb.children[this.currIndex];e&&e.classList.add("active")}}},{key:"getCurrImgOpenData",value:function(){var t=this.currImg,e=t.src,n=t.width,i=t.height,r=t.zoom;return{src:e,width:this.isZoomIn?n:(null==r?void 0:r.width)||n,height:this.isZoomIn?i:(null==r?void 0:r.height)||i}}},{key:"animateZoomWrapToOpenState",value:(p=i(m().m(function t(e,n){var i,r,o,a,s;return m().w(function(t){for(;;)switch(t.n){case 0:return i=this.getCurrImgOpenData(),r=i.width,o=i.height,a=(this.viewportRect.w-r)/2,s=o>=this.viewportRect.h?0:(this.viewportRect.h-o)/2,e?this.animateTo(this.zoomWrap,"transform",this.getTransform(a,s,n)):(this.removeTransitionStyle(this.zoomWrap),this.zoomWrap.style.setProperty("transform",this.getTransform(a,s,n))),t.n=1,this.timeoutPromise(30+(e?dr:0));case 1:return t.a(2)}},t,this)})),function(t,e){return p.apply(this,arguments)})},{key:"animateToOpenState",value:(d=i(m().m(function t(e){var n,i,r;return m().w(function(t){for(;;)switch(t.n){case 0:return n=this.getCurrImgOpenData(),i=n.width,r=n.height,e?(this.animateTo(this.container,"transform",this.getTransform(0,0)),this.animateTo(this.item,"transform","none"),this.animateZoomWrapToOpenState(e,1)):(this.animateZoomWrapToOpenState(e,1),this.currImgEl&&this.setElementSize(this.currImgEl,i,r)),t.n=1,this.timeoutPromise(30+(e?dr:0));case 1:return t.a(2)}},t,this)})),function(t){return d.apply(this,arguments)})},{key:"animateToClosedState",value:(u=i(m().m(function t(e){var n,i,r,o,a,s,l;return m().w(function(t){for(;;)switch(t.n){case 0:if((n=this.currImg).thumbEl){t.n=1;break}return t.a(2);case 1:if((i=n.thumbCropped?this.getCroppedBoundsByElement(n.thumbEl,n.width,n.height):this.getBoundsByElement(n.thumbEl)).innerRect){t.n=2;break}return t.a(2);case 2:return r=this.getCurrImgOpenData().width,o=-this.viewportRect.w+(i.x-i.innerRect.x)+i.innerRect.w,a=-this.viewportRect.h+(i.y-i.innerRect.y)+i.innerRect.h,s=this.viewportRect.w-i.innerRect.w,l=this.viewportRect.h-i.innerRect.h,this.zoomWrap.style.setProperty("transform-origin","0 0"),e?(this.animateTo(this.container,"transform",this.getTransform(o,a)),this.animateTo(this.item,"transform",this.getTransform(s,l)),this.animateTo(this.zoomWrap,"transform",this.getTransform(i.innerRect.x,i.innerRect.y,i.w/r))):(this.container.style.setProperty("transform",this.getTransform(o,a)),this.item.style.setProperty("transform",this.getTransform(s,l)),this.zoomWrap.style.setProperty("transform",this.getTransform(i.innerRect.x,i.innerRect.y,i.w/r))),t.n=3,this.timeoutPromise(30+(e?dr:0));case 3:this.zoomWrap.classList.add("opend");case 4:return t.a(2)}},t,this)})),function(t){return u.apply(this,arguments)})},{key:"open",value:(c=i(m().m(function t(e){var n,i,r,o;return m().w(function(t){for(;;)switch(t.n){case 0:if(!this.visible){t.n=1;break}return t.a(2);case 1:return t.n=2,this.initialize(e);case 2:if(this.triggerEvent("before-open"),this.visible=!0,n=this.calculateImgZoom(),i=n.src,!n.thumbEl){t.n=6;break}return this.isOpening=!0,this.appendPlaceholderEl(),r=this.loadImg(i),t.n=3,this.animateToClosedState(!1);case 3:return t.n=4,this.animateToOpenState(!0);case 4:return o=this,t.n=5,r;case 5:o.appendImgEl.call(o,t.v),this.isOpening=!1,t.n=7;break;case 6:return this.appendImgEl(),t.n=7,this.animateToOpenState(!1);case 7:this.isOpen=!0,this.triggerEvent("after-open");case 8:return t.a(2)}},t,this)})),function(t){return c.apply(this,arguments)})},{key:"close",value:(l=i(m().m(function t(){return m().w(function(t){for(;;)switch(t.n){case 0:if(this.visible&&!this.isOpening&&!this.isClosing){t.n=1;break}return t.a(2);case 1:if(this.isClosing=!0,this.visible=!1,this.triggerEvent("before-close"),this.removeAttribute("visible"),!this.currImg.thumbEl){t.n=2;break}return t.n=2,this.animateToClosedState(!0);case 2:this.imgs=[],this.triggerEvent("after-close"),this.removeSelfByClose&&this.parentElement&&this.parentElement.removeChild(this),this.removeSelfByClose=!1,this.isOpen=!1;case 3:return t.a(2)}},t,this)})),function(){return l.apply(this,arguments)})},{key:"triggerEvent",value:function(t){this.dispatchEvent(new CustomEvent(t))}},{key:"prev",value:function(){this.triggerEvent("prev"),this.goTo(this.currIndex-1)}},{key:"next",value:function(){this.triggerEvent("next"),this.goTo(this.currIndex+1)}},{key:"clearZoomState",value:function(){this.zoomInOffset.x=0,this.zoomInOffset.y=0,this.isZoomIn=!1,this.zoomWrap.classList.remove("zoom-in"),this.zoomWrap.classList.add("zoom-out")}},{key:"goTo",value:(a=i(m().m(function t(e){var n,i,r,o,a,s;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!(e<0||e>this.imgs.length-1)){t.n=1;break}return t.a(2);case 1:if(this.currIndex=e,this.updateThumbActive(),this.isZoomIn&&this.clearZoomState(),n=this.calculateImgZoom(),i=n.src,r=n.thumbEl,this.animateToOpenState(!1),t.p=2,!r){t.n=4;break}return this.appendPlaceholderEl(),o=this,t.n=3,this.loadImg(i);case 3:o.appendImgEl.call(o,t.v),t.n=6;break;case 4:return this.removeImgFromContent(),this.spinner.classList.add("visible"),a=this,t.n=5,this.loadImg(i);case 5:a.appendImgEl.call(a,t.v),this.spinner.classList.remove("visible");case 6:t.n=8;break;case 7:t.p=7,s=t.v,console.log(s);case 8:return t.a(2)}},t,this,[[2,7]])})),function(t){return a.apply(this,arguments)})},{key:"scrollZoomWrap",value:function(t,e){var n=this.currImg,i=n.width,r=n.height;n.zoom&&(i<this.viewportRect.w&&r<this.viewportRect.h||(this.zoomInOffset.x=i>this.viewportRect.w?-Math.max(0,Math.min(-this.zoomInOffset.x+t,i-this.viewportRect.w)):(this.viewportRect.w-i)/2,this.zoomInOffset.y=r>this.viewportRect.h?-Math.max(0,Math.min(-this.zoomInOffset.y+e,r-this.viewportRect.h)):(this.viewportRect.h-r)/2,this.zoomWrap.style.setProperty("transform",this.getTransform(this.zoomInOffset.x,this.zoomInOffset.y,1))))}},{key:"zoomTo",value:(n=i(m().m(function t(e){var n,i,r,o,a,s;return m().w(function(t){for(;;)switch(t.n){case 0:if(n=this.currImg,i=n.width,r=n.height,(o=n.zoom)&&!this.isZooming){t.n=1;break}return t.a(2);case 1:if(!this.isZoomIn){t.n=4;break}return this.isZooming=!0,this.clearZoomState(),t.n=2,this.animateZoomWrapToOpenState(!0,o.width/i);case 2:return t.n=3,this.animateToOpenState(!1);case 3:return this.isZooming=!1,t.a(2);case 4:return this.isZooming=!0,this.isZoomIn=!0,this.zoomWrap.classList.remove("zoom-out"),this.zoomWrap.classList.add("zoom-in"),a=(this.viewportRect.w-i)/2,s=0,i>this.viewportRect.w&&(a=-((null==e?void 0:e.x)||0)/o.width*(i-this.viewportRect.w)),r<this.viewportRect.h?s=(this.viewportRect.h-r)/2:null!=e&&e.y&&(s=-((null==e?void 0:e.y)||0)/o.height*(r-this.viewportRect.h)),this.zoomInOffset.x=a,this.zoomInOffset.y=s,t.n=5,this.animateTo(this.zoomWrap,"transform",this.getTransform(a,s,i/o.width));case 5:return t.n=6,this.timeoutPromise(363);case 6:this.removeTransitionStyle(this.zoomWrap),this.setElementSize(this.currImgEl,i,r),this.zoomWrap.style.setProperty("transform",this.getTransform(a,s,1)),this.isZooming=!1;case 7:return t.a(2)}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"loadImg",value:function(t,e){return new Promise(function(n,i){var r=e||new Image;r.onload=function(){n(r)},r.onerror=function(){i(new Error("load img error"))},r.src=t})}},{key:"calculateImgZoom",value:function(t){if((t=null!=t?t:this.currIndex)>=this.imgs.length||t<0)throw new Error("index out of range");if(this.imgs[t].zoom)return this.imgs[t];var e=this.imgs[t],n=e.width,i=e.height,r=!1,o=n/i,a=this.viewportRect.w/this.viewportRect.h;if(o>a)n>this.viewportRect.w&&(i=(n=this.viewportRect.w)/o,r=!0);else if(o<a)i>this.viewportRect.h&&(n=(i=this.viewportRect.h)*o,r=!0);else{var s=Math.min(this.viewportRect.w,this.viewportRect.h);s<n&&(r=!0,n=i=s)}return r&&(this.imgs[t].zoom={width:Math.round(n),height:Math.round(i)}),this.imgs[t]}},{key:"getBoundsByElement",value:function(t){var e=t.getBoundingClientRect();return{x:e.left,y:e.top,w:e.width}}},{key:"getCroppedBoundsByElement",value:function(t,e,n){var i=t.getBoundingClientRect(),r=i.width/e,o=i.height/n,a=r>o?r:o,s=(i.width-e*a)/2,l=(i.height-n*a)/2;return{x:i.left+s,y:i.top+l,w:e*a,innerRect:{w:i.width,h:i.height,x:s,y:l}}}},{key:"getTransform",value:function(t,e,n){var i="translate3d(".concat(t,"px, ").concat(e,"px, 0px)");return"number"==typeof n&&(i+=" scale3d(".concat(n,", ").concat(n,", 1)")),i}},{key:"appendImgToContent",value:function(t){var e=this.zoomWrap.querySelector("img");e?this.zoomWrap.replaceChild(t,e):this.zoomWrap.appendChild(t)}},{key:"removeImgFromContent",value:function(){var t=this.zoomWrap.querySelector("img");t&&this.zoomWrap.removeChild(t)}},{key:"appendPlaceholderEl",value:function(){var t=this.currImg.thumbEl;if(t){var e=t.querySelector("img"),n=null==e?void 0:e.getAttribute("src");if(n){var i=new Image;i.alt="",i.src=n,i.setAttribute("role","presentation"),i.setAttribute("aria-hidden","true"),this.setElementSize(i,250),i.style.setProperty("width","250px"),i.style.setProperty("height","auto"),i.style.transformOrigin="0 0",i.style.transform=this.getTransform(0,0,this.getCurrImgOpenData().width/250),this.appendImgToContent(i)}}}},{key:"setElementSize",value:function(t,e,n){t.style.setProperty("width","".concat(e,"px")),t.style.setProperty("height",n?"".concat(n,"px"):"auto")}},{key:"appendImgEl",value:function(t){var e=this.getCurrImgOpenData(),n=e.src,i=e.width,r=e.height;t||((t=new Image).src=n),this.setElementSize(t,i,r),this.appendImgToContent(t),this.currImg.zoom&&this.zoomWrap.classList.add("zoom-out"),this.zoomWrap.classList.contains("opend")||this.zoomWrap.classList.add("opend")}},{key:"render",value:function(){this.shadowRoot&&(this.shadowRoot.innerHTML="\n      <style>\n        :host {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n        }\n        #bg {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          background: #000;\n        }\n        :host([visible]) .ui-visible {\n          opacity: .8;\n          pointer-events: auto;\n        }\n        :host([visible]) #thumb.ui-visible {\n          opacity: 1;\n          pointer-events: auto;\n        }\n        .ui-visible {\n          opacity: 0.005;\n          will-change: opacity;\n          transition: opacity ".concat(dr,"ms ease;\n          pointer-events: none;\n        }\n        #wrap,\n        #wrap #container,\n        #wrap #container #item,\n        #wrap #container #zoom-wrap {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n        }\n        #wrap button {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          position: absolute;\n          z-index: 2;\n          width: 42px;\n          height: 42px;\n          border-radius: 50%;\n          color: var(--text_white);\n          background: rgba(0,0,0,.58);\n          transition-function: ").concat(hr,';\n          cursor: pointer;\n          outline: none;\n          border: none;\n        }\n        button.top {\n          top: 16px;\n        }\n        button.left {\n          left: 16px;\n        }\n        button.right {\n          right: 16px;\n        }\n        button.middle {\n          top: 50%;\n        }\n        button#prev {\n          transform: translateY(-50%);\n        }\n        button#next {\n          transform: translateY(-50%) rotate(180deg);\n        }\n        #wrap button:hover {\n          color: var(--brand_pink);\n        }\n        #wrap #container,\n        #wrap #item {\n          overflow: hidden;\n        }\n        #wrap #container #zoom-wrap.opend {\n          width: auto;\n          height: auto;\n        }\n        #zoom-wrap img {\n          max-width: none;\n          -webkit-user-drag: none;\n        }\n        #zoom-wrap.zoom-out {\n          cursor: zoom-in;\n        }\n        #zoom-wrap.zoom-in {\n          cursor: move;\n          cursor: -webkit-grab;\n          cursor: -moz-grab;\n          cursor: grab;\n        }\n        #spinner {\n          position: absolute;\n          left: 50%;\n          top: 50%;\n          transform: translate(-50%, -50%);\n          padding: 20px 0;\n          width: 100%;\n          text-align: center;\n          font-size: 14px;\n          color: var(--text3);\n          pointer-events: none;\n          display: none;\n        }\n        #spinner.visible {\n          display: block;\n        }\n        #spinner img {\n          margin-right: 8px;\n          vertical-align: bottom;\n        }\n        #thumb {\n          display: flex;\n          align-items: center;\n          position: absolute;\n          left: 50%;\n          bottom: 30px;\n          z-index: 2;\n          padding: 6px 10px;\n          border-radius: 8px;\n          background: rgba(24,25,28,.8);\n          backdrop-filter: blur(20px);\n          transform: translate(-50%);\n        }\n        #thumb .thumb-item {\n          width: 54px;\n          height: 54px;\n          padding: 1px;\n          border: 2px solid transparent;\n          border-radius: 8px;\n          transition: .3s;\n          cursor: pointer;\n          box-sizing: border-box;\n        }\n        #thumb .thumb-item img {\n          width: 100%;\n          height: 100%;\n          border-radius: 6px;\n          -webkit-user-drag: none;\n          pointer-events: none;\n        }\n        #thumb .thumb-item.active {\n          border-color: var(--brand_pink);\n        }\n      </style>\n      <div id="bg" class="ui-visible"></div>\n      <section id="wrap" aria-roledescription="carousel">\n        <div id="container">\n          <div id="item">\n            <div id="zoom-wrap"></div>\n          </div>\n          <div id="spinner">\n            <img width="24" height="24" src="//s1.hdslb.com/bfs/static/jinkela/long/gif/loading-blue.gif" />\n            <span></span>\n          </div>\n        </div>\n        <button id="close" class="right top ui-visible"><bili-icon icon="BDC/xmark_close_line/1" size="20"></bili-icon></button>\n        <button id="prev" class="left middle ui-visible"><bili-icon icon="BDC/arrow_back_left_line/3" size="20"></bili-icon></button>\n        <button id="next" class="right middle ui-visible"><bili-icon icon="BDC/arrow_back_left_line/3" size="20"></bili-icon></button>\n        <div id="thumb" class="ui-visible"></div>\n      </section>\n    '))}}]);var n,a,l,c,u,d,p,f,y,b}(C(HTMLElement));customElements.get("bili-photoswipe")||customElements.define("bili-photoswipe",pr);var fr="top",vr="bottom",mr="right",yr="left",br="auto",gr=[fr,vr,mr,yr],wr="start",xr="end",kr="viewport",Ar="popper",_r=gr.reduce(function(t,e){return t.concat([e+"-"+wr,e+"-"+xr])},[]),Er=[].concat(gr,[br]).reduce(function(t,e){return t.concat([e,e+"-"+wr,e+"-"+xr])},[]),Cr=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Tr(t){return t?(t.nodeName||"").toLowerCase():null}function Sr(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Or(t){return t instanceof Sr(t).Element||t instanceof Element}function Pr(t){return t instanceof Sr(t).HTMLElement||t instanceof HTMLElement}function Ir(t){return"undefined"!=typeof ShadowRoot&&(t instanceof Sr(t).ShadowRoot||t instanceof ShadowRoot)}var Rr={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach(function(t){var n=e.styles[t]||{},i=e.attributes[t]||{},r=e.elements[t];Pr(r)&&Tr(r)&&(Object.assign(r.style,n),Object.keys(i).forEach(function(t){var e=i[t];!1===e?r.removeAttribute(t):r.setAttribute(t,!0===e?"":e)}))})},effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(t){var i=e.elements[t],r=e.attributes[t]||{},o=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:n[t]).reduce(function(t,e){return t[e]="",t},{});Pr(i)&&Tr(i)&&(Object.assign(i.style,o),Object.keys(r).forEach(function(t){i.removeAttribute(t)}))})}},requires:["computeStyles"]};function jr(t){return t.split("-")[0]}var Dr=Math.max,Nr=Math.min,Mr=Math.round;function Lr(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Br(){return!/^((?!chrome|android).)*safari/i.test(Lr())}function zr(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=t.getBoundingClientRect(),r=1,o=1;e&&Pr(t)&&(r=t.offsetWidth>0&&Mr(i.width)/t.offsetWidth||1,o=t.offsetHeight>0&&Mr(i.height)/t.offsetHeight||1);var a=(Or(t)?Sr(t):window).visualViewport,s=!Br()&&n,l=(i.left+(s&&a?a.offsetLeft:0))/r,c=(i.top+(s&&a?a.offsetTop:0))/o,u=i.width/r,d=i.height/o;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l,x:l,y:c}}function Ur(t){var e=zr(t),n=t.offsetWidth,i=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:i}}function Fr(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Ir(n)){var i=e;do{if(i&&t.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Vr(t){return Sr(t).getComputedStyle(t)}function Hr(t){return["table","td","th"].indexOf(Tr(t))>=0}function Wr(t){return((Or(t)?t.ownerDocument:t.document)||window.document).documentElement}function $r(t){return"html"===Tr(t)?t:t.assignedSlot||t.parentNode||(Ir(t)?t.host:null)||Wr(t)}function Gr(t){return Pr(t)&&"fixed"!==Vr(t).position?t.offsetParent:null}function qr(t){for(var e=Sr(t),n=Gr(t);n&&Hr(n)&&"static"===Vr(n).position;)n=Gr(n);return n&&("html"===Tr(n)||"body"===Tr(n)&&"static"===Vr(n).position)?e:n||function(t){var e=/firefox/i.test(Lr());if(/Trident/i.test(Lr())&&Pr(t)&&"fixed"===Vr(t).position)return null;var n=$r(t);for(Ir(n)&&(n=n.host);Pr(n)&&["html","body"].indexOf(Tr(n))<0;){var i=Vr(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||e&&"filter"===i.willChange||e&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(t)||e}function Xr(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Zr(t,e,n){return Dr(t,Nr(e,n))}function Yr(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function Qr(t,e){return e.reduce(function(e,n){return e[n]=t,e},{})}var Kr={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,n=t.state,i=t.name,r=t.options,o=n.elements.arrow,a=n.modifiersData.popperOffsets,s=jr(n.placement),l=Xr(s),c=[yr,mr].indexOf(s)>=0?"height":"width";if(o&&a){var u=function(t,e){return Yr("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:Qr(t,gr))}(r.padding,n),d=Ur(o),h="y"===l?fr:yr,p="y"===l?vr:mr,f=n.rects.reference[c]+n.rects.reference[l]-a[l]-n.rects.popper[c],v=a[l]-n.rects.reference[l],m=qr(o),y=m?"y"===l?m.clientHeight||0:m.clientWidth||0:0,b=f/2-v/2,g=u[h],w=y-d[c]-u[p],x=y/2-d[c]/2+b,k=Zr(g,x,w),A=l;n.modifiersData[i]=((e={})[A]=k,e.centerOffset=k-x,e)}},effect:function(t){var e=t.state,n=t.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!=typeof i||(i=e.elements.popper.querySelector(i)))&&Fr(e.elements.popper,i)&&(e.elements.arrow=i)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Jr(t){return t.split("-")[1]}var to={top:"auto",right:"auto",bottom:"auto",left:"auto"};function eo(t){var e,n=t.popper,i=t.popperRect,r=t.placement,o=t.variation,a=t.offsets,s=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,h=a.x,p=void 0===h?0:h,f=a.y,v=void 0===f?0:f,m="function"==typeof u?u({x:p,y:v}):{x:p,y:v};p=m.x,v=m.y;var y=a.hasOwnProperty("x"),b=a.hasOwnProperty("y"),g=yr,w=fr,x=window;if(c){var k=qr(n),A="clientHeight",_="clientWidth";if(k===Sr(n)&&"static"!==Vr(k=Wr(n)).position&&"absolute"===s&&(A="scrollHeight",_="scrollWidth"),r===fr||(r===yr||r===mr)&&o===xr)w=vr,v-=(d&&k===x&&x.visualViewport?x.visualViewport.height:k[A])-i.height,v*=l?1:-1;if(r===yr||(r===fr||r===vr)&&o===xr)g=mr,p-=(d&&k===x&&x.visualViewport?x.visualViewport.width:k[_])-i.width,p*=l?1:-1}var E,C=Object.assign({position:s},c&&to),T=!0===u?function(t,e){var n=t.x,i=t.y,r=e.devicePixelRatio||1;return{x:Mr(n*r)/r||0,y:Mr(i*r)/r||0}}({x:p,y:v},Sr(n)):{x:p,y:v};return p=T.x,v=T.y,l?Object.assign({},C,((E={})[w]=b?"0":"",E[g]=y?"0":"",E.transform=(x.devicePixelRatio||1)<=1?"translate("+p+"px, "+v+"px)":"translate3d("+p+"px, "+v+"px, 0)",E)):Object.assign({},C,((e={})[w]=b?v+"px":"",e[g]=y?p+"px":"",e.transform="",e))}var no={passive:!0};var io={left:"right",right:"left",bottom:"top",top:"bottom"};function ro(t){return t.replace(/left|right|bottom|top/g,function(t){return io[t]})}var oo={start:"end",end:"start"};function ao(t){return t.replace(/start|end/g,function(t){return oo[t]})}function so(t){var e=Sr(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function lo(t){return zr(Wr(t)).left+so(t).scrollLeft}function co(t){var e=Vr(t),n=e.overflow,i=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function uo(t){return["html","body","#document"].indexOf(Tr(t))>=0?t.ownerDocument.body:Pr(t)&&co(t)?t:uo($r(t))}function ho(t,e){var n;void 0===e&&(e=[]);var i=uo(t),r=i===(null==(n=t.ownerDocument)?void 0:n.body),o=Sr(i),a=r?[o].concat(o.visualViewport||[],co(i)?i:[]):i,s=e.concat(a);return r?s:s.concat(ho($r(a)))}function po(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function fo(t,e,n){return e===kr?po(function(t,e){var n=Sr(t),i=Wr(t),r=n.visualViewport,o=i.clientWidth,a=i.clientHeight,s=0,l=0;if(r){o=r.width,a=r.height;var c=Br();(c||!c&&"fixed"===e)&&(s=r.offsetLeft,l=r.offsetTop)}return{width:o,height:a,x:s+lo(t),y:l}}(t,n)):Or(e)?function(t,e){var n=zr(t,!1,"fixed"===e);return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}(e,n):po(function(t){var e,n=Wr(t),i=so(t),r=null==(e=t.ownerDocument)?void 0:e.body,o=Dr(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=Dr(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),s=-i.scrollLeft+lo(t),l=-i.scrollTop;return"rtl"===Vr(r||n).direction&&(s+=Dr(n.clientWidth,r?r.clientWidth:0)-o),{width:o,height:a,x:s,y:l}}(Wr(t)))}function vo(t,e,n,i){var r="clippingParents"===e?function(t){var e=ho($r(t)),n=["absolute","fixed"].indexOf(Vr(t).position)>=0&&Pr(t)?qr(t):t;return Or(n)?e.filter(function(t){return Or(t)&&Fr(t,n)&&"body"!==Tr(t)}):[]}(t):[].concat(e),o=[].concat(r,[n]),a=o[0],s=o.reduce(function(e,n){var r=fo(t,n,i);return e.top=Dr(r.top,e.top),e.right=Nr(r.right,e.right),e.bottom=Nr(r.bottom,e.bottom),e.left=Dr(r.left,e.left),e},fo(t,a,i));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function mo(t){var e,n=t.reference,i=t.element,r=t.placement,o=r?jr(r):null,a=r?Jr(r):null,s=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(o){case fr:e={x:s,y:n.y-i.height};break;case vr:e={x:s,y:n.y+n.height};break;case mr:e={x:n.x+n.width,y:l};break;case yr:e={x:n.x-i.width,y:l};break;default:e={x:n.x,y:n.y}}var c=o?Xr(o):null;if(null!=c){var u="y"===c?"height":"width";switch(a){case wr:e[c]=e[c]-(n[u]/2-i[u]/2);break;case xr:e[c]=e[c]+(n[u]/2-i[u]/2)}}return e}function yo(t,e){void 0===e&&(e={});var n=e,i=n.placement,r=void 0===i?t.placement:i,o=n.strategy,a=void 0===o?t.strategy:o,s=n.boundary,l=void 0===s?"clippingParents":s,c=n.rootBoundary,u=void 0===c?kr:c,d=n.elementContext,h=void 0===d?Ar:d,p=n.altBoundary,f=void 0!==p&&p,v=n.padding,m=void 0===v?0:v,y=Yr("number"!=typeof m?m:Qr(m,gr)),b=h===Ar?"reference":Ar,g=t.rects.popper,w=t.elements[f?b:h],x=vo(Or(w)?w:w.contextElement||Wr(t.elements.popper),l,u,a),k=zr(t.elements.reference),A=mo({reference:k,element:g,strategy:"absolute",placement:r}),_=po(Object.assign({},g,A)),E=h===Ar?_:k,C={top:x.top-E.top+y.top,bottom:E.bottom-x.bottom+y.bottom,left:x.left-E.left+y.left,right:E.right-x.right+y.right},T=t.modifiersData.offset;if(h===Ar&&T){var S=T[r];Object.keys(C).forEach(function(t){var e=[mr,vr].indexOf(t)>=0?1:-1,n=[fr,vr].indexOf(t)>=0?"y":"x";C[t]+=S[n]*e})}return C}function bo(t,e){void 0===e&&(e={});var n=e,i=n.placement,r=n.boundary,o=n.rootBoundary,a=n.padding,s=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?Er:l,u=Jr(i),d=u?s?_r:_r.filter(function(t){return Jr(t)===u}):gr,h=d.filter(function(t){return c.indexOf(t)>=0});0===h.length&&(h=d);var p=h.reduce(function(e,n){return e[n]=yo(t,{placement:n,boundary:r,rootBoundary:o,padding:a})[jr(n)],e},{});return Object.keys(p).sort(function(t,e){return p[t]-p[e]})}var go={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,i=t.name;if(!e.modifiersData[i]._skip){for(var r=n.mainAxis,o=void 0===r||r,a=n.altAxis,s=void 0===a||a,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,h=n.altBoundary,p=n.flipVariations,f=void 0===p||p,v=n.allowedAutoPlacements,m=e.options.placement,y=jr(m),b=l||(y===m||!f?[ro(m)]:function(t){if(jr(t)===br)return[];var e=ro(t);return[ao(t),e,ao(e)]}(m)),g=[m].concat(b).reduce(function(t,n){return t.concat(jr(n)===br?bo(e,{placement:n,boundary:u,rootBoundary:d,padding:c,flipVariations:f,allowedAutoPlacements:v}):n)},[]),w=e.rects.reference,x=e.rects.popper,k=new Map,A=!0,_=g[0],E=0;E<g.length;E++){var C=g[E],T=jr(C),S=Jr(C)===wr,O=[fr,vr].indexOf(T)>=0,P=O?"width":"height",I=yo(e,{placement:C,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),R=O?S?mr:yr:S?vr:fr;w[P]>x[P]&&(R=ro(R));var j=ro(R),D=[];if(o&&D.push(I[T]<=0),s&&D.push(I[R]<=0,I[j]<=0),D.every(function(t){return t})){_=C,A=!1;break}k.set(C,D)}if(A)for(var N=function(t){var e=g.find(function(e){var n=k.get(e);if(n)return n.slice(0,t).every(function(t){return t})});if(e)return _=e,"break"},M=f?3:1;M>0;M--){if("break"===N(M))break}e.placement!==_&&(e.modifiersData[i]._skip=!0,e.placement=_,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function wo(t,e,n){return void 0===n&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function xo(t){return[fr,mr,vr,yr].some(function(e){return t[e]>=0})}var ko={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,n=t.options,i=t.name,r=n.offset,o=void 0===r?[0,0]:r,a=Er.reduce(function(t,n){return t[n]=function(t,e,n){var i=jr(t),r=[yr,fr].indexOf(i)>=0?-1:1,o="function"==typeof n?n(Object.assign({},e,{placement:t})):n,a=o[0],s=o[1];return a=a||0,s=(s||0)*r,[yr,mr].indexOf(i)>=0?{x:s,y:a}:{x:a,y:s}}(n,e.rects,o),t},{}),s=a[e.placement],l=s.x,c=s.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[i]=a}};var Ao={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,i=t.name,r=n.mainAxis,o=void 0===r||r,a=n.altAxis,s=void 0!==a&&a,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,h=n.tether,p=void 0===h||h,f=n.tetherOffset,v=void 0===f?0:f,m=yo(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),y=jr(e.placement),b=Jr(e.placement),g=!b,w=Xr(y),x="x"===w?"y":"x",k=e.modifiersData.popperOffsets,A=e.rects.reference,_=e.rects.popper,E="function"==typeof v?v(Object.assign({},e.rects,{placement:e.placement})):v,C="number"==typeof E?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),T=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,S={x:0,y:0};if(k){if(o){var O,P="y"===w?fr:yr,I="y"===w?vr:mr,R="y"===w?"height":"width",j=k[w],D=j+m[P],N=j-m[I],M=p?-_[R]/2:0,L=b===wr?A[R]:_[R],B=b===wr?-_[R]:-A[R],z=e.elements.arrow,U=p&&z?Ur(z):{width:0,height:0},F=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},V=F[P],H=F[I],W=Zr(0,A[R],U[R]),$=g?A[R]/2-M-W-V-C.mainAxis:L-W-V-C.mainAxis,G=g?-A[R]/2+M+W+H+C.mainAxis:B+W+H+C.mainAxis,q=e.elements.arrow&&qr(e.elements.arrow),X=q?"y"===w?q.clientTop||0:q.clientLeft||0:0,Z=null!=(O=null==T?void 0:T[w])?O:0,Y=j+G-Z,Q=Zr(p?Nr(D,j+$-Z-X):D,j,p?Dr(N,Y):N);k[w]=Q,S[w]=Q-j}if(s){var K,J="x"===w?fr:yr,tt="x"===w?vr:mr,et=k[x],nt="y"===x?"height":"width",it=et+m[J],rt=et-m[tt],ot=-1!==[fr,yr].indexOf(y),at=null!=(K=null==T?void 0:T[x])?K:0,st=ot?it:et-A[nt]-_[nt]-at+C.altAxis,lt=ot?et+A[nt]+_[nt]-at-C.altAxis:rt,ct=p&&ot?function(t,e,n){var i=Zr(t,e,n);return i>n?n:i}(st,et,lt):Zr(p?st:it,et,p?lt:rt);k[x]=ct,S[x]=ct-et}e.modifiersData[i]=S}},requiresIfExists:["offset"]};function _o(t,e,n){void 0===n&&(n=!1);var i,r,o=Pr(e),a=Pr(e)&&function(t){var e=t.getBoundingClientRect(),n=Mr(e.width)/t.offsetWidth||1,i=Mr(e.height)/t.offsetHeight||1;return 1!==n||1!==i}(e),s=Wr(e),l=zr(t,a,n),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(o||!o&&!n)&&(("body"!==Tr(e)||co(s))&&(c=(i=e)!==Sr(i)&&Pr(i)?{scrollLeft:(r=i).scrollLeft,scrollTop:r.scrollTop}:so(i)),Pr(e)?((u=zr(e,!0)).x+=e.clientLeft,u.y+=e.clientTop):s&&(u.x=lo(s))),{x:l.left+c.scrollLeft-u.x,y:l.top+c.scrollTop-u.y,width:l.width,height:l.height}}function Eo(t){var e=new Map,n=new Set,i=[];function r(t){n.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach(function(t){if(!n.has(t)){var i=e.get(t);i&&r(i)}}),i.push(t)}return t.forEach(function(t){e.set(t.name,t)}),t.forEach(function(t){n.has(t.name)||r(t)}),i}function Co(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}var To={placement:"bottom",modifiers:[],strategy:"absolute"};function So(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(t){return!(t&&"function"==typeof t.getBoundingClientRect)})}function Oo(t){void 0===t&&(t={});var e=t,n=e.defaultModifiers,i=void 0===n?[]:n,r=e.defaultOptions,o=void 0===r?To:r;return function(t,e,n){void 0===n&&(n=o);var r={placement:"bottom",orderedModifiers:[],options:Object.assign({},To,o),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},a=[],s=!1,l={state:r,setOptions:function(n){var s="function"==typeof n?n(r.options):n;c(),r.options=Object.assign({},o,r.options,s),r.scrollParents={reference:Or(t)?ho(t):t.contextElement?ho(t.contextElement):[],popper:ho(e)};var u,d,h=function(t){var e=Eo(t);return Cr.reduce(function(t,n){return t.concat(e.filter(function(t){return t.phase===n}))},[])}((u=[].concat(i,r.options.modifiers),d=u.reduce(function(t,e){var n=t[e.name];return t[e.name]=n?Object.assign({},n,e,{options:Object.assign({},n.options,e.options),data:Object.assign({},n.data,e.data)}):e,t},{}),Object.keys(d).map(function(t){return d[t]})));return r.orderedModifiers=h.filter(function(t){return t.enabled}),r.orderedModifiers.forEach(function(t){var e=t.name,n=t.options,i=void 0===n?{}:n,o=t.effect;if("function"==typeof o){var s=o({state:r,name:e,instance:l,options:i}),c=function(){};a.push(s||c)}}),l.update()},forceUpdate:function(){if(!s){var t=r.elements,e=t.reference,n=t.popper;if(So(e,n)){r.rects={reference:_o(e,qr(n),"fixed"===r.options.strategy),popper:Ur(n)},r.reset=!1,r.placement=r.options.placement,r.orderedModifiers.forEach(function(t){return r.modifiersData[t.name]=Object.assign({},t.data)});for(var i=0;i<r.orderedModifiers.length;i++)if(!0!==r.reset){var o=r.orderedModifiers[i],a=o.fn,c=o.options,u=void 0===c?{}:c,d=o.name;"function"==typeof a&&(r=a({state:r,options:u,name:d,instance:l})||r)}else r.reset=!1,i=-1}}},update:Co(function(){return new Promise(function(t){l.forceUpdate(),t(r)})}),destroy:function(){c(),s=!0}};if(!So(t,e))return l;function c(){a.forEach(function(t){return t()}),a=[]}return l.setOptions(n).then(function(t){!s&&n.onFirstUpdate&&n.onFirstUpdate(t)}),l}}var Po=Oo({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,n=t.instance,i=t.options,r=i.scroll,o=void 0===r||r,a=i.resize,s=void 0===a||a,l=Sr(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach(function(t){t.addEventListener("scroll",n.update,no)}),s&&l.addEventListener("resize",n.update,no),function(){o&&c.forEach(function(t){t.removeEventListener("scroll",n.update,no)}),s&&l.removeEventListener("resize",n.update,no)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,n=t.name;e.modifiersData[n]=mo({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,n=t.options,i=n.gpuAcceleration,r=void 0===i||i,o=n.adaptive,a=void 0===o||o,s=n.roundOffsets,l=void 0===s||s,c={placement:jr(e.placement),variation:Jr(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,eo(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,eo(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},Rr,ko,go,Ao,Kr,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,n=t.name,i=e.rects.reference,r=e.rects.popper,o=e.modifiersData.preventOverflow,a=yo(e,{elementContext:"reference"}),s=yo(e,{altBoundary:!0}),l=wo(a,i),c=wo(s,r,o),u=xo(l),d=xo(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),Io=function(t){function e(t){var n;return o(this,e),(n=r(this,e)).timer=null,_(t)<"u"&&n.reset(t),n}return h(e,t),s(e,[{key:"reset",value:function(t){var n=this;w(e,"reset",this,3)([]),_(t)<"u"&&(this.timer=window.setTimeout(function(){n.resolve(!0),n.timer=null},t))}},{key:"clear",value:function(){this.timer&&(window.clearTimeout(this.timer),this.timer=null,this.reject(new Error("User canceled")))}}])}(Sn),Ro=function(t){function e(){var t;o(this,e),(t=r(this,e)).reference=null,t.transition="",t.disposables=Rn(),t.deferred=null,t.state="hidden",t.showDelay=0,t.hideDelay=0,t.zIndex=0;var n=t.attachShadow({mode:"open"}),i=document.createElement("template");i.innerHTML='\n      <style>\n        :host {\n        }\n      </style>\n      <div id="content">\n        <slot></slot>\n      </div>\n    ';var a=document.importNode(i.content,!0);return n.appendChild(a),t}return h(e,t),s(e,[{key:"setup",value:function(t,e){var n,i=this;if(this.reference)console.warn("This popover has been setuped");else if("string"==typeof t&&(this.parentElement&&(n=this.parentElement.querySelector(t)),n||(n=document.querySelector(t))),n){if(this.reference=n,this.popperInstance=Po(n,this,{placement:(null==e?void 0:e.placement)||"bottom",modifiers:[{name:"offset",options:{offset:(null==e?void 0:e.offset)||[0,4]}}]}),null!=e&&e.zIndex&&(this.zIndex=e.zIndex),null!=e&&e.to){var r=null;(r="string"==typeof e.to?document.querySelector(e.to):e.to)?r.appendChild(this):console.warn("Popover config.to is not found:",e.to)}null!=e&&e.transition&&("string"==typeof(null==e?void 0:e.transition)?this.transition=null==e?void 0:e.transition:this.transition="bili-popover-transition");var o=(null==e?void 0:e.trigger)||"hover";null!=e&&e.delay?"number"==typeof e.delay?(this.showDelay=e.delay,this.hideDelay=e.delay):Array.isArray(e.delay)&&(this.showDelay=e.delay[0],this.hideDelay=e.delay[1]):"hover"===o&&(this.showDelay=100,this.hideDelay=200),"hover"===o?(this.disposables.addEventListener(n,"mouseenter",this.show.bind(this)),this.disposables.addEventListener(n,"mouseleave",this.hide.bind(this))):"click"===o&&this.disposables.addEventListener(n,"click",function(){"block"!==i.style.display?i.show():i.hide()}),this.disposables.mutationObserve(n,function(t){var e,r=l(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;if("childList"===o.type&&Array.from(o.removedNodes).includes(n)){i.parentElement&&i.parentElement.removeChild(i);break}}}catch(t){r.e(t)}finally{r.f()}},{childList:!0})}else console.warn("reference is not found:",t)}},{key:"getTransitionTimingClass",value:function(t){return"".concat(this.transition,"-").concat(t)}},{key:"delay",value:function(t){return new Promise(function(e){return setTimeout(e,t)})}},{key:"doTransition",value:function(t){var e=this;this.dispatchEvent(new CustomEvent(t?"before-enter":"before-leave"));var n=new Io;return Bn(this,t?{base:[],enter:[],enterFrom:[this.getTransitionTimingClass("enter-from")],enterTo:[this.getTransitionTimingClass("enter-active")],leave:[],leaveFrom:[],leaveTo:[],entered:[]}:{base:[],enter:[],enterFrom:[],enterTo:[],leave:[],leaveFrom:[this.getTransitionTimingClass("leave-from")],leaveTo:[this.getTransitionTimingClass("leave-active")],entered:[]},t,function(){e.dispatchEvent(new CustomEvent(t?"after-enter":"after-leave")),n.resolve(!0)}),this.deferred=n,n.promise}},{key:"showDeferred",value:(u=i(m().m(function t(){var e;return m().w(function(t){for(;;)switch(t.n){case 0:if(!(e=this.deferred)){t.n=5;break}if("showing"!==this.state&&"visible"!==this.state){t.n=1;break}return t.a(2,(e.clear(),this.deferred=null,Promise.reject("popover is showing or visible")));case 1:if("hiding"!==this.state){t.n=4;break}return t.n=2,e.promise;case 2:return t.n=3,this.delay(0);case 3:t.n=5;break;case 4:e.clear();case 5:return e=this.deferred=new Io(this.showDelay),t.n=6,e.promise;case 6:return t.a(2)}},t,this)})),function(){return u.apply(this,arguments)})},{key:"hideDeferred",value:(c=i(m().m(function t(){var e;return m().w(function(t){for(;;)switch(t.n){case 0:if(!(e=this.deferred)){t.n=4;break}if("hiding"!==this.state&&"hidden"!==this.state){t.n=1;break}return t.a(2,(e.clear(),this.deferred=null,Promise.reject("popover is hiding or hidden")));case 1:if("showing"!==this.state){t.n=3;break}return t.n=2,e.promise;case 2:t.n=4;break;case 3:e.clear();case 4:return e=this.deferred=new Io(this.hideDelay),t.n=5,e.promise;case 5:return t.a(2,t.v)}},t,this)})),function(){return c.apply(this,arguments)})},{key:"toggle",value:function(t){if(this.popperInstance){var e="show"===t;Array.from(this.children).forEach(function(t){if(t instanceof HTMLElement){if(!e)return void t.style.removeProperty("display");t.style.setProperty("display","block","important")}}),e?(this.popperInstance.update(),this.style.setProperty("display","block","important"),this.style.setProperty("z-index",String(this.zIndex||Nn()),"important")):this.style.removeProperty("display")}}},{key:"show",value:(a=i(m().m(function t(){return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!this.popperInstance){t.n=6;break}return t.p=1,t.n=2,this.showDeferred();case 2:t.n=4;break;case 3:return t.p=3,t.v,t.a(2);case 4:if(this.state="showing",this.toggle("show"),!this.transition){t.n=5;break}return t.n=5,this.doTransition(!0);case 5:this.state="visible",this.deferred=null;case 6:return t.a(2)}},t,this,[[1,3]])})),function(){return a.apply(this,arguments)})},{key:"hide",value:(n=i(m().m(function t(){return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!this.popperInstance){t.n=8;break}return t.p=1,t.n=2,this.hideDeferred();case 2:t.n=4;break;case 3:return t.p=3,t.v,t.a(2);case 4:if(this.state="hiding",!this.transition){t.n=6;break}return t.n=5,this.doTransition(!1);case 5:t.n=7;break;case 6:if("block"===this.style.display){t.n=7;break}return t.a(2);case 7:this.toggle("hide"),this.deferred=null;case 8:return t.a(2)}},t,this,[[1,3]])})),function(){return n.apply(this,arguments)})},{key:"connectedCallback",value:function(){var t=this.getAttribute("reference");if(t){var e=this.getAttribute("placement"),n=this.getAttribute("trigger"),i=this.getAttribute("z-index"),r=this.getAttribute("transition"),o=this.getAttribute("delay"),a=this.getAttribute("to"),s={};if(e&&(s.placement=e),n&&["hover","click"].includes(n)?s.trigger=n:s.trigger="hover",i&&(s.zIndex=Number(i)),r&&(["1","true"].includes(r)?s.transition=!0:s.transition=r),a&&(s.to=a),o){var l=o.split(",");2===l.length?s.delay=[Number(l[0]),Number(l[1])]:s.delay=Number(l[0])}this.setup(t,s)}}},{key:"disconnectedCallback",value:function(){this.disposables.dispose(),this.popperInstance&&(this.popperInstance.destroy(),this.popperInstance=void 0),this.reference=null}}]);var n,a,c,u}(C(HTMLElement));customElements.get("bili-popover")||customElements.define("bili-popover",Ro);var jo=function(t){function e(){var t;return o(this,e),(t=r(this,e)).disposables=Rn(),t.state={label:"",value:"",name:"",disabled:!1,checked:!1},t.attachShadow({mode:"open"}),t.shadowRoot&&(t.shadowRoot.innerHTML='\n        <style>\n          :host {\n            --bili-radio-size: 16px;\n            --bili-radio-font-size: 14px;\n            --bili-radio-border-width: 1px;\n            --bili-radio-checked-color: var(--brand_blue);\n            --bili-radio-margin-inline-end: 8px;\n\n            display: inline-flex;\n            align-items: baseline;\n            padding: 0;\n            margin: 0;\n            cursor: pointer;\n            margin-inline-end: var(--bili-radio-margin-inline-end);\n          }\n          #input {\n            box-sizing: border-box;\n            margin: 0;\n            padding: 0;\n            list-style: none;\n            position: relative;\n            display: inline-block;\n            outline: none;\n            cursor: pointer;\n            align-self: center;\n            border-radius: 50%;\n            width: var(--bili-radio-size);\n            height: var(--bili-radio-size);\n          }\n          #input input {\n            bottom: 0;\n            left: 0;\n            margin: 0;\n            opacity: 0;\n            outline: none;\n            position: absolute;\n            right: 0;\n            top: 0;\n            z-index: -1;\n          }\n          #input #inner {\n            display: block;\n            background-color: var(--bg1_float);\n            border: 1px solid var(--text4);\n            border-radius: 50%;\n            box-sizing: border-box;\n            width: 100%;\n            height: 100%;\n          }\n          #input[checked] #inner {\n            border-color: var(--bili-radio-checked-color);\n          }\n          #input[checked] #inner::after {\n            transform: translate(-50%,-50%) scale(1);\n          }\n          #input #inner::after {\n            width: 50%;\n            height: 50%;\n            background-color: var(--bili-radio-checked-color);\n            border-radius: 50%;\n            content: "";\n            left: 50%;\n            position: absolute;\n            top: 50%;\n            transform: translate(-50%,-50%) scale(0);\n            transition: transform .15s ease-in;\n          }\n          #label {\n            margin-left: 8px;\n            font-size: var(--bili-radio-font-size);\n            color: var(--text2);\n          }\n        </style>\n        <span id="input">\n          <input type="radio">\n          <span id="inner"></span>\n        </span>\n        <slot>\n          <span id="label"></span>\n        </slot>\n      '),t}return h(e,t),s(e,[{key:"connectedCallback",value:function(){var t=this;if(this.shadowRoot){var n=this.getAttribute("label");if(e.observedAttributes.forEach(function(e){var i=t.getAttribute(e);null!==i&&("value"===e&&!n&&t.updateAttribute("label",i),t.updateAttribute(e,i))}),this.shadowRoot&&this.disposables.addEventListener(this,"click",function(){if(!t.state.disabled&&!t.state.checked)if(t.updateInput("checked",!0),t.state.name){var e={name:t.state.name,value:t.state.value},n=new CustomEvent("bili-radio-change",{detail:e});document.dispatchEvent(n)}else{var i=new CustomEvent("change",{detail:{value:t.state.value}});t.dispatchEvent(i)}}),this.state.name){var i=function(e){var n=e.detail;n&&n.name===t.state.name&&n.value!==t.state.value&&t.updateInput("checked",!1)};document.addEventListener("bili-radio-change",i),this.disposables.add(function(){document.removeEventListener("bili-radio-change",i)})}}}},{key:"disconnectedCallback",value:function(){this.disposables.dispose()}},{key:"updateInput",value:function(t,e){var n,i,r=null==(n=this.shadowRoot)?void 0:n.querySelector("#input"),o=null==(i=this.shadowRoot)?void 0:i.querySelector("input");if(r&&o)switch(t){case"value":o.setAttribute(t,e);break;case"disabled":case"checked":e?(r.setAttribute(t,""),o.setAttribute(t,"")):(r.removeAttribute(t),o.removeAttribute(t))}}},{key:"updateLabel",value:function(t){var e,n=null==(e=this.shadowRoot)?void 0:e.querySelector("#label");n&&(n.textContent=t)}},{key:"updateAttribute",value:function(t,e){switch(t){case"name":this.state.name=e;break;case"label":this.updateLabel(e),this.state.label=e;break;case"value":this.updateInput(t,e),this.state[t]=e;break;case"disabled":case"checked":this.updateInput(t,"true"===e),this.state[t]="true"===e}}},{key:"attributeChangedCallback",value:function(t,e,n){this.updateAttribute(t,n)}}],[{key:"observedAttributes",get:function(){return["name","value","label","disabled","checked"]}}])}(C(HTMLElement));jo.elName="bili-radio";var Do=jo;customElements.get(Do.elName)||customElements.define(Do.elName,Do);var No=function(){function t(){o(this,t),this.disposables=[]}return s(t,[{key:"addEventListener",value:function(t,e,n,i){return this.add(function(t,e,n,i){return t.addEventListener(e,n,i),function(){!function(t,e,n,i){t.removeEventListener(e,n,i)}(t,e,n,i)}}(t,e,n,i))}},{key:"mutationObserve",value:function(t,e,n){var i=!1,r=new MutationObserver(e);return r.observe(t,n),function(){return function(t){i||(i=!0,t.disconnect())}(r)}}},{key:"requestAnimationFrame",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=requestAnimationFrame.apply(void 0,arguments);return this.add(function(){return cancelAnimationFrame(t)})})},{key:"nextFrame",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.requestAnimationFrame(function(){return t.requestAnimationFrame.apply(t,n)})}},{key:"setTimeout",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=setTimeout.apply(void 0,arguments);return this.add(function(){return clearTimeout(t)})})},{key:"microTask",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i={current:!0};return function(t){"function"==typeof queueMicrotask?queueMicrotask(t):Promise.resolve().then(t).catch(function(t){return setTimeout(function(){throw t})})}(function(){i.current&&e[0]()}),this.add(function(){i.current=!1})}},{key:"style",value:function(t,e,n){var i=t.style.getPropertyValue(e);return Object.assign(t.style,c({},e,n)),this.add(function(){Object.assign(t.style,c({},e,i))})}},{key:"group",value:function(e){var n=new t;return e(n),this.add(function(){return n.dispose()})}},{key:"add",value:function(t){var e=this;return this.disposables.push(t),function(){var n=e.disposables.indexOf(t);n>=0&&e.remove(n,1)}}},{key:"remove",value:function(t,e){var n,i=l(this.disposables.splice(t,null!=e?e:this.disposables.length));try{for(i.s();!(n=i.n()).done;){(0,n.value)()}}catch(t){i.e(t)}finally{i.f()}}},{key:"dispose",value:function(){this.remove(0)}}])}();("undefined"==typeof window?"undefined":_(window))<"u"&&(window.__BILI_POPPER_ZINDEX__||(window.__BILI_POPPER_ZINDEX__=1e3));var Mo,Lo,Bo,zo,Uo,Fo,Vo,Ho,Wo,$o,Go,qo,Xo,Zo=function(t){function e(){var t;return o(this,e),(t=r(this,e)).disposables=new No,t.attachShadow({mode:"open"}),t.shadowRoot&&(t.shadowRoot.innerHTML='\n        <style>\n          :host {\n            --bili-rich-text-display: block;\n            --bili-rich-text-white-space: pre-line;\n            --bili-rich-text-word-break: break-word;\n            --bili-rich-text-icon-vertical-align: sub;\n            --bili-rich-text-link-color: var(--text_link, #008AC5);\n            --bili-rich-text-link-color-hover: var(--brand_blue, #00AEEC);\n            --icon-vertical-align: var(--bili-rich-text-icon-vertical-align);\n            color: var(--bili-rich-text-color, var(--text1, #18191C));\n            font-size: var(--bili-rich-text-font-size, 15px);\n            line-height: var(--bili-rich-text-line-height, 21px);\n            font-family: var(--bili-font-family);\n          }\n          #contents {\n            margin-block-start: 0;\n            margin-block-end: 0;\n            margin-inline-start: 0;\n            margin-inline-end: 0;\n            display: var(--bili-rich-text-display);\n            white-space: var(--bili-rich-text-white-space);\n            word-break: var(--bili-rich-text-word-break);\n            -webkit-font-smoothing: antialiased;\n          }\n          #contents a {\n            color: var(--bili-rich-text-link-color);\n            text-decoration: none;\n            background-color: transparent;\n            cursor: pointer;\n          }\n\n          #contents a:hover {\n            color: var(--bili-rich-text-link-color-hover);\n          }\n          \n          #contents a bili-icon {\n            vertical-align: var(--bili-rich-text-icon-vertical-align);\n          }\n          #contents img, #contents a i {\n            display: inline-block;\n            width: 1.2em;\n            height: 1.2em;\n            vertical-align: var(--bili-rich-text-icon-vertical-align);\n          }\n        </style>\n        <p id="contents"></p>\n      '),t}return h(e,t),s(e,[{key:"contentsElement",get:function(){return this.shadowRoot.querySelector("#contents")}},{key:"connectedCallback",value:function(){var t=this;this.disposables.addEventListener(this.contentsElement,"click",function(e){var n=v({},e.target.dataset);0!==Object.keys(n).length&&t.dispatchEvent(new CustomEvent("text-click",{detail:n}))})}},{key:"disconnectedCallback",value:function(){this.disposables.dispose()}},{key:"contents",get:function(){return this.shadowRoot.querySelector("#contents")}},{key:"styleMap",value:function(t){return t?Object.keys(t).reduce(function(e,n){return t[n]?e+"".concat(n,":").concat(t[n],";"):e},""):""}},{key:"renderToString",value:function(t,e,n){var i="";return e&&(i=Object.keys(e||{}).reduce(function(t,n){return e[n]?t+" ".concat(n,'="').concat(e[n],'"'):t},"")),"<".concat(t).concat(i).concat("img"===t?"/>":">".concat(n||"","</").concat(t,">"))}},{key:"setContents",value:function(t){var e=this,n=t.map(function(t){var n=v({style:e.styleMap(t.style)},t[t.tag]||{}),i=t.dataset;if(i){Object.assign(n,Object.keys(i).reduce(function(t,e){var n=i[e];return n&&(t["data-".concat(e)]=n),t},{}))}var r="";return t.html?e.renderToString(t.tag,n,t.html):(n.text&&(n.icon&&(/^(https?:)?\/\//.test(n.icon)?r+=e.renderToString("img",{src:n.icon,loading:"lazy",style:"width:var(--icon-width);height:var(--icon-height);vertical-align:var(--icon-vertical-align);"}):r+=e.renderToString("i",{class:"holder "+n.icon}),delete n.icon),r+=n.text,delete n.text),e.renderToString(t.tag,n,r))}).join("");this.contents.innerHTML=n,setTimeout(function(){var t=Array.from(e.contents.getElementsByTagName("i"));if(t.length){var n=t[0].getBoundingClientRect().width.toString();t.forEach(function(t){var e=document.createElement("bili-icon");e.setAttribute("size",n),e.setAttribute("icon",t.classList[1]),t.parentElement.replaceChild(e,t)})}},0)}}])}(C(HTMLElement));Zo.elName="bili-rich-text",customElements.get(Zo.elName)||customElements.define(Zo.elName,Zo);var Yo=function(t){("undefined"==typeof window?"undefined":_(window))>"u"||window.__BILI_X_ENGINE_SCRIPT_CACHE__&&_(window.__BILI_X_ENGINE_SCRIPT_CACHE__[t])<"u"&&delete window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]},Qo=function(t,e){if(("undefined"==typeof window?"undefined":_(window))>"u")return Promise.reject(new Error("window is not defined"));var n=t=t.replace(/^https?:\/\//,"//"),i=function(t){return("undefined"==typeof window?"undefined":_(window))>"u"||!window.__BILI_X_ENGINE_SCRIPT_CACHE__?null:window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]||null}(n);if(null!=i&&i.promise)return i.promise;var r=new Promise(function(n,i){var r=document.createElement("script");r.src=t,null!=e&&e.behavior&&r.setAttribute(e.behavior,""),r.onload=function(){var r=window;if(e.lib)return r[e.lib]?n(r[e.lib]):i(new Error('Failed to access library "'+e.lib+'" from '+t));n(null)},r.onerror=function(){i(new Error("Failed to load "+t)),document.head.removeChild(r)},document.head.appendChild(r)});return function(t,e){("undefined"==typeof window?"undefined":_(window))>"u"||(window.__BILI_X_ENGINE_SCRIPT_CACHE__||(window.__BILI_X_ENGINE_SCRIPT_CACHE__={}),window.__BILI_X_ENGINE_SCRIPT_CACHE__[t]=e)}(n,{promise:r,lib:null==e?void 0:e.lib}),r.then(function(){!1===(null==e?void 0:e.cache)&&Yo(n)}).catch(function(){!1===(null==e?void 0:e.cache)&&Yo(n)}),r},Ko=function(){try{var t=function(){return Promise.resolve(window.__BiliUser__.get())},e=function(){if(!window.__BiliUser__)return Promise.resolve(function(){try{return Promise.resolve(Qo("//s1.hdslb.com/bfs/seed/jinkela/short/bili-user/index.js",{lib:"__BiliUser__"}))}catch(t){return Promise.reject(t)}}()).then(function(){})}();return Promise.resolve(e&&e.then?e.then(t):t())}catch(t){return Promise.reject(t)}},Jo="",ta=function(){return Jo||(Jo=function(t){if(("undefined"==typeof window?"undefined":_(window))>"u")return"";var e=document.querySelector('meta[name="'+t+'"]');return null!=e&&e.content?e.content:""}("spm_prefix"),Jo||"0.0")},ea=function(t){try{return window.Unios?Promise.resolve(window.Unios.request(t)):Promise.resolve(function(t){if(window.Unios)return Promise.resolve(window.Unios);var e=window.__LOAD_REQUEST_TYPE__||t||"web";return Qo("//s1.hdslb.com/bfs/seed/jinkela/short/unios/"+e+".min.js",{lib:"Unios"})}()).then(function(){return window.Unios.request(t)})}catch(t){return Promise.reject(t)}},na=function(t,e,n){try{return window.BToast?Promise.resolve(window.BToast.show(t,e,n)):Promise.resolve(function(){try{return window.BToast?Promise.resolve(window.BToast):Promise.resolve(Qo("//s1.hdslb.com/bfs/seed/jinkela/short/webui/toast/index.js",{lib:"BToast"}))}catch(t){return Promise.reject(t)}}()).then(function(){return window.BToast.show(t,e,n)})}catch(t){return Promise.reject(t)}};function ia(t){return new Promise(function(e,n){ea({url:"//api.bilibili.com/x/web-interface/card",params:{mid:t,photo:"true"}}).then(function(t){if(0!==t.code||!t.data)return n(new Error(t.message||"get card data error"));e(t.data)}).catch(n)})}var ra="";function oa(){var t;return ra||(ra=(null==(t=document.querySelector("meta[name=spm_prefix]"))?void 0:t.getAttribute("content"))||"")}function aa(t){return new Promise(function(e,n){ea({url:"//api.bilibili.com/x/relation/modify",method:"POST",params:{statistics:JSON.stringify({appId:100,platform:5})},data:{act:t.act,fid:t.fid,spmid:t.spmid||oa(),from_spmid:t.fromSpmid||"",re_src:0},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){if(0!==t.code)return n(new Error(t.message||"modify relation error"));e(t)}).catch(n)})}function sa(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var la="to top right";function ca(t,e){return"linear-gradient(".concat(t,",").concat(e,")")}function ua(t,e){var n=(e=e||{}).theme||"",i=e.stringType||!1,r="",o="";if(function(t){return!(!t||"object"!=_(t)||_(t.render_scheme)>"u"||!t.colors_info||!t.colors_info.color||!Array.isArray(t.colors_info.color))}(t)){var a=t.render_scheme,s=t.colors_info.color;if(1!==a&&"Colorful"!==a||!s||0===s.length)return null;var l=function(t){var e=t.length,n=[],i=[],r=function(t,n){return"".concat(function(t){return"#"===t[0]?t:"#".concat(t)}(t)," ").concat(n/(e-1)*100,"%")};return t.forEach(function(t,e){n.push(r(t.color_day,e)),i.push(r(t.color_night,e))}),{light:ca(la,n.join(",")),dark:ca(la,i.join(","))}}(s);r=l.light,o=l.dark}if(r&&o){var c,u={base:{"background-clip":"text","-webkit-background-clip":"text","-webkit-text-fill-color":"transparent"},theme:{light:{"background-image":r},dark:{"background-image":o}}};if(["light","dark"].includes(n)){var d=Object.assign({},u.base,u.theme[n]);return i?function(t){var e=Object.keys(t);if(0===e.length)return"";var n="";return e.forEach(function(e){void 0!==t[e]&&(n+="".concat(e,":").concat(t[e],";"))}),n}(d):d}if(e.variable&&"string"==typeof e.variable&&/^--[a-z]/.test(e.variable))u.variable=(sa(c={},"".concat(e.variable,"-light"),r),sa(c,"".concat(e.variable,"-dark"),o),c);return u}return null}var da=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.PAGE=1]="PAGE",t[t.IFRAME=2]="IFRAME",t[t.SITE=3]="SITE",t}({}),ha=!1;function pa(t){return pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pa(t)}function fa(t){var e=function(t,e){if("object"!=pa(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=pa(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pa(e)?e:e+""}function va(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,fa(i.key),i)}}function ma(t,e,n){return(e=fa(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ya=function(){function t(e){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),ma(this,"all",new Map),ma(this,"weakMap",new WeakMap),ma(this,"defaultEventTarget",void 0),e?e instanceof Element||e instanceof Document?this.defaultEventTarget=e:this.defaultEventTarget=document.querySelector(e)||document:this.defaultEventTarget=document,this.all.clear=function(){n.all.forEach(function(t,e){t.forEach(function(t){n.off(e,t)})}),n.all.clear()}}return function(t,e,n){e&&va(t.prototype,e),n&&va(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"on",value:function(t,e,n){this.all.has(t)||this.all.set(t,[]),this.weakMap.has(e)||this.weakMap.set(e,[]);var i=(n||this.defaultEventTarget).addEventListener,r=function(n){e({sourceType:da.PAGE,customEvent:n,event:t,payload:n.detail,samePage:!0,emitter:i})};this.all.get(t).push(e),this.weakMap.get(e).push(r),i(t,r)}},{key:"off",value:function(t,e,n){var i,r=this,o=(n||this.defaultEventTarget).removeEventListener;if(!e)return null===(i=this.all.get(t))||void 0===i||i.forEach(function(e){r.weakMap.get(e).forEach(function(e){o(t,e)})}),void this.all.delete(t);this.weakMap.get(e).forEach(function(e){o(t,e)})}},{key:"emit",value:function(t,e,n){var i=new CustomEvent(t,{detail:e}),r=(n||this.defaultEventTarget).dispatchEvent;r(i),r(new CustomEvent("*",{detail:e}))}}]),t}(),ba=function(){var t=null;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return!1===ha&&(ha=("undefined"==typeof window?"undefined":_(window))<"u"),ha?t||(t=new ya(e)):(console.error("useEvent must be used in the browser environment"),null)}}(),ga=function(t){return t[t.DEFAULT=-1]="DEFAULT",t[t.NOT_FOLLOW=0]="NOT_FOLLOW",t[t.QUIET=1]="QUIET",t[t.ONE_WAY=2]="ONE_WAY",t[t.TWO_WAY=6]="TWO_WAY",t[t.BLOCK=128]="BLOCK",t}(ga||{}),wa=function(t){return t.OPEN_BOOKMARK="follow.openBookmark",t.TRIGGER_SETTING_BOOKMARK="follow.triggerSettingBookmark",t.TRIGGER_DELETE_BOOKMARK="follow.triggerDeleteBookmark",t.TRIGGER_REMOVE_FANS="follow.triggerRemoveFans",t.CREATED_USER_BOOKMARK="follow.createdUserBookmark",t.SET_USER_BOOKMARK="follow.setUserBookmark",t.REMOVED_USER_FANS="follow.removedUserFans",t.CHANGED_USER_RELATION="follow.changedUserRelation",t}(wa||{}),xa=Object.defineProperty,ka=Object.getOwnPropertyDescriptor,Aa=function(t,e,n,i){for(var r,o=i>1?void 0:i?ka(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&xa(e,n,o),o},_a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=Math.max(0,e),"number"!=typeof t&&(t=Number(t)),isNaN(t)?0:t>1e8?(t/1e8).toFixed(e)+"":t>1e4?(t/1e4).toFixed(e)+"":t},Ea=function(t){return"".concat("data-user-profile","-").concat(t)},Ca=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).event=ba(),t.userData=null,t.uid="",t.data=null,t.showSpinner=!1,t.isFollowing=!1,t.spmid=null,t.fromSpmid="",t.disposables=Rn(),t.cacheData={},t.showTimer=null,t.hideTimer=null,t.lastShowEl=null,t}return h(e,t),s(e,[{key:"backgroundImage",get:function(){var t;return Ei.getBmgSrcNext((null==(t=this.data)?void 0:t.space.l_img)||"",{w:366,h:85,c:!0,dpr:2})}},{key:"faceSrc",get:function(){var t;return Ei.getBmgSrcNext((null==(t=this.data)?void 0:t.card.face)||"//i0.hdslb.com/bfs/face/member/noface.jpg",{w:48,h:48,dpr:2})}},{key:"ovType",get:function(){var t,e,n,i;return null!==(t=null==(i=null==(n=null==(e=this.data)?void 0:e.card)?void 0:n.Official)?void 0:i.type)&&void 0!==t?t:-1}},{key:"ovText",get:function(){var t;return this.ovType>-1?"bilibili".concat(1===this.ovType?"":"","").concat(null==(t=this.data)?void 0:t.card.Official.title):""}},{key:"name",get:function(){var t;return this.data?null==(t=this.data)?void 0:t.card.name:""}},{key:"nameRenderStyle",get:function(){var t,e,n;if(null==(e=null==(t=this.data)?void 0:t.card)||!e.name_render)return"";var i=ua(null==(n=this.data)?void 0:n.card.name_render,{variable:"--name-render-bg"});return null!=i&&i.variable?i.variable:null}},{key:"nameStyle",get:function(){var t;if(null==(t=this.data)||!t.card)return null;if(this.nameRenderStyle)return this.nameRenderStyle;var e="",n=this.data.card.vip;return 1===n.status&&n.nickname_color&&(e=n.nickname_color),e?{color:e}:null}},{key:"gender",get:function(){var t="";return this.data&&["",""].includes(this.data.card.sex)&&(t=""===this.data.card.sex?"male":"female"),t}},{key:"genderImg",get:function(){return Ei.getBmgSrcNext("//i0.hdslb.com/bfs/seed/jinkela/short/webui/user-profile/img/gender_".concat(this.gender,".png"),{dpr:2})}},{key:"level",get:function(){var t={img:"",url:"//www.bilibili.com/html/help.html#k_5"};if(!this.data)return t;var e=this.data.card,n=e.is_senior_member,i=e.level_info.current_level;return t.img=Ca.getLevelImgSrc(i,!!n),t}},{key:"vipLabel",get:function(){var t,e,n=((null==(t=this.data)?void 0:t.card)||{}).vip;return n&&null!=(e=n.label)&&e.text?{img:n.label.img_label_uri_hans_static||"",text:n.label.text,style:{backgroundColor:n.label.bg_color,color:n.label.text_color}}:null}},{key:"stats",get:function(){var t,e,n,i,r;return[{key:"follow",count:String(_a((null==(e=null==(t=this.data)?void 0:t.card)?void 0:e.attention)||0)),url:this.getSpaceLink("follow"),label:""},{key:"fans",count:String(_a((null==(i=null==(n=this.data)?void 0:n.card)?void 0:i.fans)||0)),url:this.getSpaceLink("fans"),label:""},{key:"like",count:String(_a((null==(r=this.data)?void 0:r.like_num)||0)),label:""}]}},{key:"signText",get:function(){var t;return null==(t=this.data)?void 0:t.card.sign}},{key:"appendToParent",value:function(t){var e=document.body;if(t){var n=document.querySelector(t);n&&(e=n)}e.appendChild(this)}},{key:"setup",value:function(t){var e=this.disposables.addEventListener(t,"mouseenter",this.refMouseEnter.bind(this)),n=this.disposables.addEventListener(t,"mouseleave",this.refMouseLeave.bind(this));return function(){e(),n()}}},{key:"setPosition",value:function(t){var e=window.innerWidth,n=t.getBoundingClientRect(),i=n.width,r=n.bottom,o=n.left,a=n.top,s=o+i/2;e-s<366&&(s-=366),this.style.left="".concat(s,"px"),a>290?(this.style.top="",this.style.bottom="".concat(window.innerHeight-a,"px")):(this.style.bottom="",this.style.top="".concat(r,"px")),this.style.zIndex="".concat(Nn())}},{key:"clearTimer",value:function(t){"show"!==t?this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null):this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null)}},{key:"refMouseEnter",value:function(t){var e=this,n=t.target;if(this.clearTimer("hide"),this.showTimer){if(this.lastShowEl===n)return;this.clearTimer("show")}this.lastShowEl=n,this.showTimer=window.setTimeout(function(){e.showTimer=null,e.show(n)},300)}},{key:"hide",value:function(){var t=this;this.hideTimer=window.setTimeout(function(){t.visible(!1),t.lastShowEl=null,t.hideTimer=null},300)}},{key:"refMouseLeave",value:function(t){t.target===this.lastShowEl&&(this.clearTimer("show"),this.hide())}},{key:"visible",value:function(t){this.style.display=t?"block":""}},{key:"show",value:(a=i(m().m(function t(e){var n,i,r,o,a,s;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.parentElement||this.appendToParent(e.getAttribute(Ea("parent"))||""),i=e.getAttribute(Ea("id"))){t.n=1;break}return this.uid="",t.a(2);case 1:if((r=e.getAttribute(Ea("spmid-follow")))&&(this.spmid={follow:"".concat(ta(),".").concat(r)}),this.uid=i,this.setPosition(e),this.visible(!0),t.p=2,!(o=this.cacheData[i])){t.n=3;break}this.data=o,t.n=5;break;case 3:return this.showSpinner=!0,t.n=4,ia(i);case 4:a=t.v,this.cacheData[i]=a,this.data=a;case 5:this.isFollowing=(null==(n=this.data)?void 0:n.following)||!1,t.n=7;break;case 6:t.p=6,s=t.v,console.warn(s.message);case 7:this.showSpinner=!1;case 8:return t.a(2)}},t,this,[[2,6]])})),function(t){return a.apply(this,arguments)})},{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),Ko().then(function(e){t.userData=e.data||null}),this.disposables.addEventListener(this,"mouseenter",function(){t.clearTimer("hide")}),this.disposables.addEventListener(this,"mouseleave",function(){t.hide()}),this.event.on(wa.CHANGED_USER_RELATION,function(e){var n,i;if(e.payload){var r=e.payload,o=r.mineId,a=r.targetId,s=r.attribute;if(!o||null==(n=t.userData)||!n.mid||String(o)===String(t.userData.mid)){var l=[ga.ONE_WAY,ga.TWO_WAY,ga.QUIET].includes(s);t.uid===String(a)&&(t.isFollowing=l),(null==(i=t.data)?void 0:i.card.mid)===String(a)&&(t.data.following=l),t.cacheData[a]&&(t.cacheData[a].following=l)}}}),this.disposables.add(function(){t.event.off(wa.CHANGED_USER_RELATION)});var n=/(?:\?|&)spm_id_from=([^&]+)/.exec(location.search),i=n?n[1]:null;i&&(this.fromSpmid=i)}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose(),this.cacheData={},this.lastShowEl=null,this.userData=null,this.spmid=null,this.fromSpmid=""}},{key:"handleJumpMsg",value:function(){window.open("https://message.bilibili.com/#/whisper/mid".concat(this.uid))}},{key:"getSpaceLink",value:function(t){if(!this.data)return"";var e="//space.bilibili.com/".concat(this.uid);switch(t){case"follow":return"".concat(e,"/fans/follow");case"fans":return"".concat(e,"/fans/fans");default:return e}}},{key:"handleFollow",value:(n=i(m().m(function t(){var e,n;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,aa({fid:this.uid,act:this.isFollowing?2:1,spmid:this.spmid?this.spmid.follow:"",fromSpmid:this.fromSpmid});case 1:this.isFollowing=!this.isFollowing,this.data&&(this.data.following=this.isFollowing),this.event.emit(wa.CHANGED_USER_RELATION,{mineId:(null==(e=this.userData)?void 0:e.mid)||"",targetId:this.uid,attribute:this.isFollowing?ga.ONE_WAY:ga.NOT_FOLLOW,preAttribute:this.isFollowing?ga.NOT_FOLLOW:ga.ONE_WAY}),t.n=3;break;case 2:t.p=2,n=t.v,na(n.message||"");case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return n.apply(this,arguments)})},{key:"ovIconTemplate",value:function(){return Qe(Mo||(Mo=x(['<i id="ov-icon" class="ov-','"></i>'])),this.ovType)}},{key:"ovTemplate",value:function(){return Qe(Lo||(Lo=x(['<div id="ov">\n      ',"\n      <span>","</span>\n    </div>"])),this.ovIconTemplate(),this.ovText)}},{key:"vipLabelTemplate",value:function(){return this.vipLabel?this.vipLabel.img?Qe(Bo||(Bo=x(['<div id="vip"><img src="','" /></div>'])),this.vipLabel.img):Qe(zo||(zo=x(['<div id="vip">\n      <label style="','"><span>',"</span></label>\n    </div>"])),Zn(this.vipLabel.style),this.vipLabel.text):""}},{key:"viewTemplate",value:function(){return Qe(Uo||(Uo=x(['\n      <div id="view">\n        <div\n          id="bg"\n          style="','"\n        ></div>\n        <a href="','" target="_blank" id="avatar">\n          <img id="face" src="','" />\n          ','\n        </a>\n        <div id="body">\n          <div id="title">\n            <a id="name" class="','" style="','"\n              >',"</a\n            >\n            ","\n            ","\n            ",'\n          </div>\n          <div id="content">\n            <div id="stats">\n              ',"\n            </div>\n            ",'\n            <div id="sign">','</div>\n          </div>\n          <div id="action">\n            <button id="follow" class="','" @click=','>\n              <bili-icon icon="BDC/plus_add_line/2" size="16"></bili-icon>\n              <span>','</span>\n            </button>\n            <button id="chat" @click=',"></button>\n          </div>\n        </div>\n      </div>\n    "])),Zn({backgroundImage:"url(".concat(this.backgroundImage,")")}),this.getSpaceLink(""),this.faceSrc,this.ovType>-1?this.ovIconTemplate():"",this.nameRenderStyle?"render-style":"",this.nameStyle?Zn(this.nameStyle):"",this.name,this.gender?Qe(Fo||(Fo=x(['<div id="gender"><img width="16" height="16" src="','" /></div>'])),this.genderImg):"",this.level.img?Qe(Vo||(Vo=x(['<a id="level" href="','" target="_blank"><img src="','" /></a>'])),this.level.url,this.level.img):"",this.vipLabelTemplate(),this.stats.map(function(t){return t.url?Qe(Ho||(Ho=x(['<a id="','" href="','" target="_blank"><span>',"</span>","</a>"])),t.key,t.url,t.count,t.label):Qe(Wo||(Wo=x(['<a id="','"><span>',"</span>","</a>"])),t.key,t.count,t.label)}),this.ovType>-1?this.ovTemplate():"",this.signText,this.isFollowing?"active":"",this.handleFollow,this.isFollowing?"":"",this.handleJumpMsg)}},{key:"spinnerTemplate",value:function(){return Qe($o||($o=x(['<div id="spinner">...</div>'])))}},{key:"fallbackTemplate",value:function(){return Qe(Go||(Go=x(['<div id="fallback"></div>'])))}},{key:"render",value:function(){return Qe(qo||(qo=x(['<div id="wrap">\n      ',"\n    </div>"])),this.showSpinner?this.spinnerTemplate():this.data?this.viewTemplate():this.fallbackTemplate())}}],[{key:"getLevelImgSrc",value:function(t,e){return"//i0.hdslb.com/bfs/seed/jinkela/short/webui/user-profile/img/level_".concat(e?"h":t,".svg")}}]);var n,a}(gn);Ca.styles=we(Xo||(Xo=x(["\n    :host {\n      width: ","px;\n      display: none;\n      position: fixed;\n    }\n\n    #wrap {\n      background-color: var(--bg1_float);\n      border-radius: 8px;\n      box-shadow: 0 0 30px 2px rgba(0, 0, 0, 0.1);\n      color: var(--text3);\n      font-size: 12px;\n      width: 100%;\n      font-family: var(--bili-font-family);\n      -webkit-font-smoothing: antialiased;\n    }\n    #spinner {\n      padding: 12px;\n    }\n\n    #bg {\n      background-position: 50%;\n      background-repeat: no-repeat;\n      background-size: cover;\n      border-radius: 8px 8px 0 0;\n      height: ","px;\n      left: 0;\n      overflow: hidden;\n      position: absolute;\n      top: 0;\n      width: 366px;\n    }\n\n    #avatar {\n      border-radius: 50%;\n      height: 48px;\n      left: 10px;\n      position: absolute;\n      top: 95px;\n      width: 48px;\n    }\n\n    #avatar #face {\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n    }\n    #avatar #ov-icon {\n      background-color: var(--text_white);\n      background-position: 50%;\n      background-repeat: no-repeat;\n      background-size: cover;\n      border-radius: 50%;\n      height: 14px;\n      position: absolute;\n      right: 0;\n      top: 34px;\n      width: 14px;\n    }\n    #ov-icon.ov-0 {\n      background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAASZSURBVHgBxVptThNBGJ5Wo4FAgjGBSCSuMZHon5Z4AMoN4ATACVpOwHIC6gkoJ6A3KJygNDH+8Icu0YhUCU0wEAxmfZ/d2XZnZ/ZzpvVJhk1nttPn/ZyZdygxA3Bdd44e69Sq1F7w5xxvARzeetS61E5KpZLD/hdAmtoutY5bHF1qm9QsNimEiF+5ZnEwdkHGRDyK3TycSlle4po5Yr5vq3F9zNhtjz9PGbsfMPZ34I89oFB4TFM8ojZFU8yuUquxBDjU1rLESKoARH6THk0mBqQPkPz5nrGL5ohsVkAYCPFs1xdOBibcJiHaSdMkCsDNaUsDIP5jzyduAk+3kgSxSYi9uK/GChBLvk8a/27n13gaYJFFm4TZVI3GCqEUgMgjpx9JA992zGk9DvMNxpb2VSNbJMRhtFMSgAcsFpqRz8NlPm/4AToJTFOgv+74wT8CTL4SDWyVAF/oYQmdH1f8zDJJIMAhhIhTEmAl3FEOf+B+bwlfgdtMmjwAa3/difZWiaMd7hgKwF1HGGSXLTM+jwzzzo0L0Hj0m37SEFF3/b2Xh7AFbOG1O4eyTWz2yg6QR3YpCjnjgXwj+OAJwLUvquecvvjHYVqIkr/psdwAeVmRQysEFqgJw9D+5SHTQpQ8iBSNpX4z1gqBAHXhC9C+DubrsttcnzAtXEixsIo/Ze4+VWM/hkBdUgS+7hrSl+aswY1ggZr0Q0V9H+StlnpMNxXDhWQlrEMAM9pPIg/cGFhL5CRQhQAVoeu2y3IjC3kTm7/fx9EeCwJYQtfdGcuFNPKAqZVctmKlhDOc0HX6JLu2cLp6m8FimO9+kDx+tp3uZtjcVa/CPYOHysmyAOSXO9nexQ+LO8tikLnNlVkR4PCx3DFDCsii/RhAAFGsLKRw9Ls3EJQAyP9qZXtXwQ0uBCZzwktpboR8/OFl8jsI7LTdZx7yACwvwoEFRNtNV5gRpM2TlzwgH/o9AcS8ObPGtAErTlXjx3FIyksekOfsjccCSeTPNcoxs6vRni4EaIsv1fSzy3SMACCPA0oRBIUwESdlOiQjYo+F7vkG04KsKT3y3py1aA8O+E6wDog7uIU600LUArrkgUWp5uv5YTn0YZQ74UJFrQBTh9OdCfIoPcop1FO6JwB3I/HIA4mLxEJY+ybIeyVHSfutoMAV3krIVljMVar3ESyCJsgDOJrK2h+e8oXKHC8aiaxRXOoXTHu6wNlaPp7ukfbt4IOqtIj9sRiFn9YmVxcNoN6qO0Re2MOodqNUxY1s8F4dxef2cWCmptqqg5O0TZAE4MEhFiURD2+6+utDFsBt1Fv1bdWVk/I8QC+2WChQhkDd3jpQBZU+QPj5vrok4/t9WzWQdsVks2hQAyi7IMPoVu8CBIUwddoWgjaKLJd86/QgtSsu+QJBUIrJW0vyFksivtCIIw6f3+HeEIs816yIKiv2JWQpCIIKBGqrECh8zYqGRIA9zVQl7ZoVO+QN4/+KAJdyx4ur6AWGccAa1FquWXjE3dDFxdjBBdly/X/YKIqOLvFMMZBFGOYXibHa4UhnMTFeBrzBt8/4s803kVr4B9ZWrx2gQRFMAAAAAElFTkSuQmCC);\n    }\n    #ov-icon.ov-1 {\n      background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAT3SURBVHgBxVq9bxxFFH/3kVzwWY5FAUYK4iK7oEDyhhIh4VSkTEQaqnMKKpCCK2hQLqJKBUhQUeTcx0rKUBn/A/gsUSBxUS6iiJUmTnSX2Mbn5f3mZk+zs7MfNzN3/KTx6t7e7f7e18ybNy6RB4RhuMiXqzwCHu/J66IcEXpy7PHY5bFTKpV69H8BpHnc4rEd2mOXR5NHg2YFhfjz0C/uTl2RKRHXcWsSTqUiX5KWuU+j2Dai82JI3VdD2ntxQt3BkPpDov5JKO7NV0u0dJbHuTIt1ysULFQpOF/JeKPIlctFciRXASbf5MuPFE9IARDcenpM93hEZItiqVYWSjQv1IRiBhzwuMFKPMh6TqYC0p0tXQ6ym/8cCeI+cOWtM1mKtFiJ22m/TVUgjTws3mbyk1o8D/BI892aUMaAVCWMCjB5zOn3dfkvjw+9WT0N1985S19ePGe6tc5KbOrChAIyYbHQjGMe1v7ur1fUeTmkWWBlrkw/fFAXya8AOXFJT2yTAo/50lBlX3T6PMOc0iwRLFSEEho6rMAlVRDLGhn3DVWGsJk1eQDexrs1BMyxpQrGCsjQid18+OzYS8wjObc/WqBPzQmaintPje+/GY5qLwHVAy31W/tHp2KqdAXIr/MACq2aGjaTMx7Ifx19EApI6zf1H+4fuU2VKnmg2588FKM1R8PYC5EH1tS7sP7DZ/+SC3TyIIJSwwaGlX7shUiBm+pd19D5jOdylTyAWskFhlz4BH/KMnyC+MtOyBZI1K8MC1Hnpf0zga2kAmsII3hgLfYitpRt7IP8tytvGO89Grh5ACFkMOxVKBC3vqWlssgDPtYSwzMCKLCqSmwslUse+wMPxZ/BAw0o0FAl+4eTvSiPPNAd+KmhHg0SHlitkq7AcXFXo+jKIw98/OYZCj6spt7vD0O68/fr3DDD9zQsJp5a1NVRxVgEqCq1ytIKBm6LZbIANh+Gctcad7qvrZMcChyogiKklmolbzsykC+66pu4IYSgwLi6m6/AVZnPEaXu53/0M7/zDefGlZzqcxLyAAynoQcPdFTJSr1CPrBSz47OSckDb9cSzxQKPFElq+er5Aq4OssQ2KjYFIuGZ+4lPTBnlddU9Bku7RhsMzXs4k2xxlHAHnCdXZZTrA/ybctKd9QIS0THTpk3yUji31UpymEXGF7kRB5YTbYiscHvRb7eUe9cd1RADyFX8sD6hZouQrtzvKHBh/F6gBCy9QJcrbYIfZBHvWVoOwqjC6kMo5/Uu9hR2eTCct0veRjEYP121OBS1Up4oZn8YS4GcoX2QR7A3tpg/XGfNGZi2TSKHTD8zHP21pT7oWlAGBu2p7fZ+q3og6m1iL5obJe28edgZn3RCJgIfg3mdXGPyV9UBaYV5xppBd737895WeCKIqUvCk6XdWGClUyODVWGfIA1XNeHIsA7Ukr1G6Yjp6wDjhZp+QCgX+qja6dDTBqcsClrUCzuVeQdMbXIoAQ6d5hhfnPs3kWIGmEp03YqeaDIIR9Oa+6S4ZAvUgQnk5N6JFosYfEU4oj5DSbfznrOJMes26Q1AFSg5YGZCm2Z/cNTbg6EsWNWbJRQDqNcx4QQZJftqJCvef9XBIRUOF081w8wvAPe4NEO/UIQD5WDi6lDKrIejv5hwxbbrsS99EXCUY6s0WgFR6uyQfF8OZADsf1EXh/IItIJ/wGIiiU8ye7cIAAAAABJRU5ErkJggg==);\n    }\n\n    #body {\n      box-sizing: border-box;\n      padding: 97px 20px 16px 70px;\n    }\n\n    #title {\n      align-items: center;\n      display: flex;\n      height: 21px;\n      padding-bottom: 10px;\n    }\n    #title #name {\n      color: var(--text1);\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 700;\n    }\n    #title #name.render-style {\n      background-clip: text;\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n      background-image: var(--name-render-bg-light);\n    }\n    #title #name.render-style.dark {\n      background-image: var(--name-render-bg-dark);\n    }\n    #title #gender {\n      display: block;\n      height: 16px;\n      margin-left: 6px;\n      width: 16px;\n    }\n    #title #level {\n      margin-left: 6px;\n      margin-right: -2px;\n      display: flex;\n    }\n    #level img {\n      width: 30px;\n    }\n    #vip {\n      margin-left: 6px;\n    }\n    #vip img {\n      display: flex;\n      height: 20px;\n    }\n    #vip label {\n      background-color: var(--brand_pink);\n      border-radius: 2px;\n      box-sizing: border-box;\n      color: var(--text_white);\n      font-size: 12px;\n      font-weight: 400;\n      height: 16px;\n      line-height: 16px;\n      margin-left: 0;\n      max-width: 58px;\n      overflow: hidden;\n      white-space: nowrap;\n    }\n    #vip label span {\n      align-items: center;\n      display: inline-flex;\n      justify-content: center;\n      transform: scale(0.83);\n      transform-origin: center;\n    }\n\n    #content {\n    }\n    #content #stats {\n      align-items: center;\n      display: flex;\n      font-size: 12px;\n      padding-bottom: 10px;\n    }\n    #content #stats a {\n      color: var(--text3);\n      padding-right: 18px;\n      text-decoration: none;\n    }\n    #content #stats a span {\n      color: var(--text1);\n      display: inline-block;\n      margin-right: 3px;\n    }\n    #content #ov {\n      color: var(--text3);\n      font-size: 12px;\n      line-height: 17px;\n      margin-bottom: 10px;\n    }\n    #content #ov i {\n      background-position: 50%;\n      background-repeat: no-repeat;\n      background-size: cover;\n      display: inline-block;\n      height: 14px;\n      margin-right: 2px;\n      vertical-align: sub;\n      width: 14px;\n    }\n    #content sign {\n      -webkit-line-clamp: 2;\n      color: var(--text3);\n      display: -webkit-box;\n      line-height: 16px;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      word-break: break-all;\n    }\n    #action {\n      align-items: center;\n      display: flex;\n      margin-top: 16px;\n    }\n    #action button {\n      align-items: center;\n      border-radius: 3px;\n      border-style: solid;\n      border-width: 1px;\n      cursor: pointer;\n      display: flex;\n      font-size: 14px;\n      height: 30px;\n      justify-content: center;\n      transition: all 0.3s;\n      width: 100px;\n    }\n    #action button#follow {\n      color: var(--text_white);\n      border-color: var(--brand_blue);\n      background-color: var(--brand_blue);\n    }\n    #action button#follow bili-icon {\n      margin-right: 3px;\n    }\n    #action button#follow.active {\n      background-color: var(--graph_bg_thick);\n      border-color: var(--graph_bg_thick);\n      color: var(--text3);\n    }\n    #action button#follow.active bili-icon {\n      display: none;\n    }\n    #action button#follow.active:hover {\n      background-color: var(--graph_bg_regular);\n      border-color: var(--graph_bg_regular);\n    }\n    #action button#follow:hover {\n      background-color: #00b8f6;\n      border-color: #00b8f6;\n    }\n    #action button#chat {\n      background-color: transparent;\n      border-color: var(--text3);\n      color: var(--text2);\n      margin-left: 8px;\n    }\n  "])),366,85),Aa([An()],Ca.prototype,"uid",2),Aa([An()],Ca.prototype,"data",2),Aa([An()],Ca.prototype,"showSpinner",2),Aa([An()],Ca.prototype,"isFollowing",2),Aa([An()],Ca.prototype,"backgroundImage",1),Aa([An()],Ca.prototype,"faceSrc",1),Aa([An()],Ca.prototype,"ovType",1),Aa([An()],Ca.prototype,"ovText",1),Aa([An()],Ca.prototype,"name",1),Aa([An()],Ca.prototype,"nameRenderStyle",1),Aa([An()],Ca.prototype,"nameStyle",1),Aa([An()],Ca.prototype,"gender",1),Aa([An()],Ca.prototype,"genderImg",1),Aa([An()],Ca.prototype,"level",1),Aa([An()],Ca.prototype,"vipLabel",1),Aa([An()],Ca.prototype,"stats",1),Aa([An()],Ca.prototype,"signText",1),Ca=Aa([xn("bili-user-profile")],Ca),customElements.get("bili-user-profile")||customElements.define("bili-user-profile",Ca),window.__WEB_UI_VERSION__="1.1.4";
/**
   * @license
   * Copyright 2018 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
var Ta=$n(function(t){function e(t){var n,i;if(o(this,e),n=r(this,e,[t]),t.type!==Hn||"class"!==t.name||(null===(i=t.strings)||void 0===i?void 0:i.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.");return n}return h(e,t),s(e,[{key:"render",value:function(t){return" "+Object.keys(t).filter(function(e){return t[e]}).join(" ")+" "}},{key:"update",value:function(t,e){var n,i,r=this,o=g(e,1)[0];if(void 0===this.it){for(var a in this.it=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(function(t){return""!==t}))),o)o[a]&&!(null===(n=this.nt)||void 0===n?void 0:n.has(a))&&this.it.add(a);return this.render(o)}var s=t.element.classList;for(var l in this.it.forEach(function(t){t in o||(s.remove(t),r.it.delete(t))}),o){var c=!!o[l];c===this.it.has(l)||(null===(i=this.nt)||void 0===i?void 0:i.has(l))||(c?(s.add(l),this.it.add(l)):(s.remove(l),this.it.delete(l)))}return Ke}}])}(Gn)),Sa=Symbol.for(""),Oa=function(t){if((null==t?void 0:t.r)===Sa)return null==t?void 0:t._$litStatic$},Pa=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return{_$litStatic$:n.reduce(function(e,n,i){return e+function(t){if(void 0!==t._$litStatic$)return t._$litStatic$;throw Error("Value passed to 'literal' function must be a 'literal' result: ".concat(t,". Use 'unsafeStatic' to pass non-literal values, but\n            take care to ensure page security."))}(n)+t[i+1]},t[0]),r:Sa}},Ia=new Map,Ra=function(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(var o,a,s,l=i.length,c=[],u=[],d=0,h=!1;d<l;){for(s=e[d];d<l&&void 0!==(a=i[d],o=Oa(a));)s+=o+e[++d],h=!0;d!==l&&u.push(a),c.push(s),d++}if(d===l&&c.push(e[l]),h){var p=c.join("$$lit$$");void 0===(e=Ia.get(p))&&(c.raw=c,Ia.set(p,e=c)),i=u}return t.apply(void 0,[e].concat(k(i)))}}(Qe),ja=function(t){function e(t){var n;if(o(this,e),(n=r(this,e,[t])).et=Je,t.type!==Wn)throw Error(n.constructor.directiveName+"() can only be used in child bindings");return n}return h(e,t),s(e,[{key:"render",value:function(t){if(t===Je||null==t)return this.ft=void 0,this.et=t;if(t===Ke)return t;if("string"!=typeof t)throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.et)return this.ft;this.et=t;var e=[t];return e.raw=e,this.ft={_$litType$:this.constructor.resultType,strings:e,values:[]}}}])}(Gn);
/**
   * @license
   * Copyright 2020 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */ja.directiveName="unsafeHTML",ja.resultType=1;var Da=$n(ja),Na=vn.I,Ma=function(){return document.createComment("")},La=function(t,e,n){var i,r=t._$AA.parentNode,o=void 0===e?t._$AB:e._$AA;if(void 0===n){var a=r.insertBefore(Ma(),o),s=r.insertBefore(Ma(),o);n=new Na(a,s,t,t.options)}else{var l,c=n._$AB.nextSibling,u=n._$AM,d=u!==t;if(d)null===(i=n._$AQ)||void 0===i||i.call(n,t),n._$AM=t,void 0!==n._$AP&&(l=t._$AU)!==u._$AU&&n._$AP(l);if(c!==o||d)for(var h=n._$AA;h!==c;){var p=h.nextSibling;r.insertBefore(h,o),h=p}}return n},Ba=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return t._$AI(e,n),t},za={},Ua=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:za;return t._$AH=e},Fa=function(t){var e;null===(e=t._$AP)||void 0===e||e.call(t,!1,!0);for(var n=t._$AA,i=t._$AB.nextSibling;n!==i;){var r=n.nextSibling;n.remove(),n=r}},Va=function(t,e,n){for(var i=new Map,r=e;r<=n;r++)i.set(t[r],r);return i},Ha=$n(function(t){function e(t){var n;if(o(this,e),n=r(this,e,[t]),t.type!==Wn)throw Error("repeat() can only be used in text expressions");return n}return h(e,t),s(e,[{key:"ct",value:function(t,e,n){var i;void 0===n?n=e:void 0!==e&&(i=e);var r,o=[],a=[],s=0,c=l(t);try{for(c.s();!(r=c.n()).done;){var u=r.value;o[s]=i?i(u,s):s,a[s]=n(u,s),s++}}catch(t){c.e(t)}finally{c.f()}return{values:a,keys:o}}},{key:"render",value:function(t,e,n){return this.ct(t,e,n).values}},{key:"update",value:function(t,e){var n,i=g(e,3),r=i[0],o=i[1],a=i[2],s=function(t){return t._$AH}(t),l=this.ct(r,o,a),c=l.values,u=l.keys;if(!Array.isArray(s))return this.ut=u,c;for(var d,h,p=null!==(n=this.ut)&&void 0!==n?n:this.ut=[],f=[],v=0,m=s.length-1,y=0,b=c.length-1;v<=m&&y<=b;)if(null===s[v])v++;else if(null===s[m])m--;else if(p[v]===u[y])f[y]=Ba(s[v],c[y]),v++,y++;else if(p[m]===u[b])f[b]=Ba(s[m],c[b]),m--,b--;else if(p[v]===u[b])f[b]=Ba(s[v],c[b]),La(t,f[b+1],s[v]),v++,b--;else if(p[m]===u[y])f[y]=Ba(s[m],c[y]),La(t,s[v],s[m]),m--,y++;else if(void 0===d&&(d=Va(u,y,b),h=Va(p,v,m)),d.has(p[v]))if(d.has(p[m])){var w=h.get(u[y]),x=void 0!==w?s[w]:null;if(null===x){var k=La(t,s[v]);Ba(k,c[y]),f[y]=k}else f[y]=Ba(x,c[y]),La(t,s[v],x),s[w]=null;y++}else Fa(s[m]),m--;else Fa(s[v]),v++;for(;y<=b;){var A=La(t,f[b+1]);Ba(A,c[y]),f[y++]=A}for(;v<=m;){var _=s[v++];null!==_&&Fa(_)}return this.ut=u,Ua(t,f),Ke}}])}(Gn)),Wa=function(t,e){var n,i,r=t._$AN;if(void 0===r)return!1;var o,a=l(r);try{for(a.s();!(o=a.n()).done;){var s=o.value;null===(i=(n=s)._$AO)||void 0===i||i.call(n,e,!1),Wa(s,e)}}catch(t){a.e(t)}finally{a.f()}return!0},$a=function(t){var e,n;do{if(void 0===(e=t._$AM))break;(n=e._$AN).delete(t),t=e}while(0===(null==n?void 0:n.size))},Ga=function(t){for(var e;e=t._$AM;t=e){var n=e._$AN;if(void 0===n)e._$AN=n=new Set;else if(n.has(t))break;n.add(t),$c(e)}};
/**
   * @license
   * Copyright 2020 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */function qa(t){void 0!==this._$AN?($a(this),this._$AM=t,Ga(this)):this._$AM=t}function Xa(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this._$AH,r=this._$AN;if(void 0!==r&&0!==r.size)if(e)if(Array.isArray(i))for(var o=n;o<i.length;o++)Wa(i[o],!1),$a(i[o]);else null!=i&&(Wa(i,!1),$a(i));else Wa(this,t)}var Za,Ya,Qa,Ka,Ja,ts,es,ns,is,rs,os,as,ss,ls,cs,us,ds,hs,ps,fs,vs,ms,ys,bs,gs,ws,xs,ks,As,_s,Es,Cs,Ts,Ss,Os,Ps,Is,Rs,js,Ds,Ns,Ms,Ls,Bs,zs,Us,Fs,Vs,Hs,Ws,$s,Gs,qs,Xs,Zs,Ys,Qs,Ks,Js,tl,el,nl,il,rl,ol,al,sl,ll,cl,ul,dl,hl,pl,fl,vl,ml,yl,bl,gl,wl,xl,kl,Al,_l,El,Cl,Tl,Sl,Ol,Pl,Il,Rl,jl,Dl,Nl,Ml,Ll,Bl,zl,Ul,Fl,Vl,Hl,Wl,$l,Gl,ql,Xl,Zl,Yl,Ql,Kl,Jl,tc,ec,nc,ic,rc,oc,ac,sc,lc,cc,uc,dc,hc,pc,fc,vc,mc,yc,bc,gc,wc,xc,kc,Ac,_c,Ec,Cc,Tc,Sc,Oc,Pc,Ic,Rc,jc,Dc,Nc,Mc,Lc,Bc,zc,Uc,Fc,Vc,Hc,Wc,$c=function(t){var e,n,i,r;t.type==Wn&&(null!==(e=(i=t)._$AP)&&void 0!==e||(i._$AP=Xa),null!==(n=(r=t)._$AQ)&&void 0!==n||(r._$AQ=qa))},Gc=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments))._$AN=void 0,t}return h(e,t),s(e,[{key:"_$AT",value:function(t,n,i){w(e,"_$AT",this,3)([t,n,i]),Ga(this),this.isConnected=t._$AU}},{key:"_$AO",value:function(t){var e,n,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t!==this.isConnected&&(this.isConnected=t,t?null===(e=this.reconnected)||void 0===e||e.call(this):null===(n=this.disconnected)||void 0===n||n.call(this)),i&&(Wa(this,t),$a(this))}},{key:"setValue",value:function(t){if(function(t){return void 0===t.strings}(this._$Ct))this._$Ct._$AI(t,this);else{var e=k(this._$Ct._$AH);e[this._$Ci]=t,this._$Ct._$AI(e,this,0)}}},{key:"disconnected",value:function(){}},{key:"reconnected",value:function(){}}])}(Gn),qc=s(function t(){o(this,t)}),Xc=new WeakMap,Zc=$n(function(t){function e(){return o(this,e),r(this,e,arguments)}return h(e,t),s(e,[{key:"render",value:function(t){return Je}},{key:"update",value:function(t,e){var n,i=g(e,1)[0],r=i!==this.G;return r&&void 0!==this.G&&this.ot(void 0),(r||this.rt!==this.lt)&&(this.G=i,this.dt=null===(n=t.options)||void 0===n?void 0:n.host,this.ot(this.lt=t.element)),Je}},{key:"ot",value:function(t){var e;if("function"==typeof this.G){var n=null!==(e=this.dt)&&void 0!==e?e:globalThis,i=Xc.get(n);void 0===i&&(i=new WeakMap,Xc.set(n,i)),void 0!==i.get(this.G)&&this.G.call(this.dt,void 0),i.set(this.G,t),void 0!==t&&this.G.call(this.dt,t)}else this.G.value=t}},{key:"rt",get:function(){var t,e,n;return"function"==typeof this.G?null===(e=Xc.get(null!==(t=this.dt)&&void 0!==t?t:globalThis))||void 0===e?void 0:e.get(this.G):null===(n=this.G)||void 0===n?void 0:n.value}},{key:"disconnected",value:function(){this.rt===this.lt&&this.ot(void 0)}},{key:"reconnected",value:function(){this.ot(this.lt)}}])}(Gc)),Yc=Object.defineProperty,Qc=Object.getOwnPropertyDescriptor,Kc=function(t,e,n,i){for(var r,o=i>1?void 0:i?Qc(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Yc(e,n,o),o},Jc=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disabled=!1,t.trailingIcon=!1,t.hasIcon=!1,t.href="",t.target="",t}return h(e,t),s(e,[{key:"name",get:function(){var t;return null!==(t=this.getAttribute("name"))&&void 0!==t?t:""},set:function(t){this.setAttribute("name",t)}},{key:"focus",value:function(){var t;null==(t=this.buttonElement)||t.focus()}},{key:"blur",value:function(){var t;null==(t=this.buttonElement)||t.blur()}},{key:"getRenderClasses",value:function(){return{"button--icon-leading":!this.trailingIcon&&this.hasIcon,"button--icon-trailing":this.trailingIcon&&this.hasIcon}}},{key:"render",value:function(){var t=this.disabled&&!this.href,e=this.href?Pa(Za||(Za=x(["a"]))):Pa(Ya||(Ya=x(["button"]))),n=this.ariaLabel,i=this.ariaHasPopup,r=this.ariaExpanded;return Ra(Qa||(Qa=x(["\n      <",'\n        class="button ','"\n        ?disabled=','\n        aria-label="','"\n        aria-haspopup="','"\n        aria-expanded="','"\n        href=',"\n        target=","\n      >","</",">"])),e,Ta(this.getRenderClasses()),t,n||Je,i||Je,r||Je,this.href||Je,this.target||Je,this.renderContent(),e)}},{key:"handleSlotChange",value:function(){this.hasIcon=this.assignedIcons.length>0}},{key:"renderContent",value:function(){var t,e=Qe(Ka||(Ka=x(['<slot name="icon" @slotchange="','"></slot>'])),this.handleSlotChange);return Qe(Ja||(Ja=x(["\n      "," ",'\n      <span class="button__label"><slot></slot></span>\n      ',"\n    "])),null==(t=this.renderOutline)?void 0:t.call(this),this.trailingIcon?Je:e,this.trailingIcon?e:Je)}}])}(gn);Jc.styles=we(ts||(ts=x([""]))),Kc([kn()],Jc.prototype,"disabled",2),Kc([kn()],Jc.prototype,"trailingIcon",2),Kc([kn()],Jc.prototype,"hasIcon",2),Kc([kn()],Jc.prototype,"href",2),Kc([kn()],Jc.prototype,"target",2),Kc([Cn(".button")],Jc.prototype,"buttonElement",2),Kc([function(t){var e=null!=t?t:{},n=e.slot,i=e.selector;return En({descriptor:function(e){return{get:function(){var e,r="slot"+(n?"[name=".concat(n,"]"):":not([name])"),o=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(r),a=null!=o?Tn(o,t):[];return i?a.filter(function(t){return t.matches(i)}):a},enumerable:!0,configurable:!0}}})}({slot:"icon",flatten:!0})],Jc.prototype,"assignedIcons",2),Jc=Kc([xn("bili-button")],Jc);var tu=Object.defineProperty,eu=Object.getOwnPropertyDescriptor,nu=function(t){function e(){return o(this,e),r(this,e,arguments)}return h(e,t),s(e)}(Jc);nu.styles=we(es||(es=x(['\n    :host {\n      display: inline-flex;\n      height: var(--_container-height);\n      outline: none;\n      font-family: var(--_label-text-font);\n      font-size: var(--_label-text-size);\n      line-height: var(--_label-text-line-height);\n      font-weight: var(--_label-text-weight);\n      -webkit-tap-highlight-color: transparent;\n      vertical-align: middle;\n    }\n    .button {\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      box-sizing: border-box;\n      border: none;\n      outline: none;\n      user-select: none;\n      appearance: none;\n      background: rgba(0, 0, 0, 0);\n      text-decoration: none;\n      inline-size: 100%;\n      position: relative;\n      z-index: 0;\n      height: 100%;\n      font: inherit;\n      color: var(--_label-text-color);\n      padding-inline-start: var(--_leading-space);\n      padding-inline-end: var(--_trailing-space);\n      cursor: pointer;\n    }\n    .button:not([disabled]):hover {\n      color: var(--_label-text-color-hover, var(--brand_blue));\n    }\n    .button::before {\n      background-color: var(--_container-color);\n      border-radius: inherit;\n      content: "";\n      inset: 0px;\n      position: absolute;\n    }\n  ']))),nu=function(t,e,n,i){for(var r,o=i>1?void 0:i?eu(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&tu(e,n,o),o}([xn("bili-text-button")],nu);var iu=function(t,e,n){Ai(v({content:t,duration:null!=e?e:2e3},n))},ru=function(t){return"object"==_(t)&&"[object Object]"===Object.prototype.toString.call(t)},ou=function(t){return t.replace(/[^\d]/g,"")},au=function(t){return new Promise(function(e){return setTimeout(e,t)})},su=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},lu=function(){return s(function t(){o(this,t)},[{key:"request",value:(t=i(m().m(function t(e){return m().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ki(e);case 1:return t.a(2,t.v)}},t)})),function(e){return t.apply(this,arguments)})}]);var t}(),cu=new lu,uu=function(t){return JSON.stringify(t)},du=function(){var t=i(m().m(function t(e,n,i){var r,o,a,s,l,c,u;return m().w(function(t){for(;;)switch(t.n){case 0:return e.request&&(r=e.request,o=r.method,a=r.data,"POST"===o&&ru(a)&&((s=a).statistics||(l=(null==i?void 0:i.payload)||{active:!0,appId:100,platform:5},c=l.appId,u=l.platform,!1!==l.active&&(s.statistics=uu({appId:c,platform:u}))))),t.n=1,n();case 1:return t.a(2)}},t)}));return function(e,n,i){return t.apply(this,arguments)}}(),hu=function(t){return cu.request({url:"/x/v2/reply/report/metadata",params:t})},pu=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return cu.request({method:"POST",url:"/x/v2/reply/action",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"},chainProxy:function(t){return e?t:t.with(du)}})},fu=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return cu.request({method:"POST",url:"/x/v2/reply/hate",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"},chainProxy:function(t){return e?t:t.with(du)}})},vu=function(t){return cu.request({method:"POST",url:"/x/v2/reply/del",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},mu=function(t){return cu.request({method:"POST",url:"/x/v2/reply/top",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},yu=function(t){return t[t.SELECT=1]="SELECT",t[t.UNSELECT=2]="UNSELECT",t[t.CLOSE=3]="CLOSE",t[t.OPEN=4]="OPEN",t}(yu||{}),bu=function(t){return cu.request({method:"POST",url:"/x/v2/reply/subject/modify",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},gu=function(t){return cu.request({method:"POST",url:"/x/v2/dm/subject/state/update",data:v(v({},t),{},{type:1}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},wu=function(t){return cu.request({method:"POST",url:"/x/v2/reply/vote/do",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},xu=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return cu.request({url:"/x/v2/reply/report",method:"POST",data:v(v({},t),{},{gaia_source:"main_web"}),headers:{"Content-Type":"application/x-www-form-urlencoded"},chainProxy:function(t){return e?t:t.with(du)}})},ku=function(t,e){return cu.request({url:"/x/relation/modify",method:"POST",params:e,data:v(v({},t),{},{gaia_source:"main_web"}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},Au=function(t){return cu.request({method:"POST",baseURL:"//cm.bilibili.com",url:"/commercialorder/api/web_api/v1/main_site/upper/comment/apply_remove",data:v({},t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})};var _u=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.PAGE=1]="PAGE",t[t.IFRAME=2]="IFRAME",t[t.SITE=3]="SITE",t}({});var Eu=!1;function Cu(){return!1===Eu&&(Eu=("undefined"==typeof window?"undefined":_(window))<"u"),Eu}var Tu=function(){return!Cu()};function Su(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ou="to top right";function Pu(t,e){return"linear-gradient(".concat(t,",").concat(e,")")}function Iu(t,e){var n=(e=e||{}).theme||"",i=e.stringType||!1,r="",o="";if(function(t){return!(!t||"object"!=_(t)||_(t.render_scheme)>"u"||!t.colors_info||!t.colors_info.color||!Array.isArray(t.colors_info.color))}(t)){var a=t.render_scheme,s=t.colors_info.color;if(1!==a&&"Colorful"!==a||!s||0===s.length)return null;var l=function(t){var e=t.length,n=[],i=[],r=function(t,n){return"".concat(function(t){return"#"===t[0]?t:"#".concat(t)}(t)," ").concat(n/(e-1)*100,"%")};return t.forEach(function(t,e){n.push(r(t.color_day,e)),i.push(r(t.color_night,e))}),{light:Pu(Ou,n.join(",")),dark:Pu(Ou,i.join(","))}}(s);r=l.light,o=l.dark}if(r&&o){var c,u={base:{"background-clip":"text","-webkit-background-clip":"text","-webkit-text-fill-color":"transparent"},theme:{light:{"background-image":r},dark:{"background-image":o}}};if(["light","dark"].includes(n)){var d=Object.assign({},u.base,u.theme[n]);return i?function(t){var e=Object.keys(t);if(0===e.length)return"";var n="";return e.forEach(function(e){void 0!==t[e]&&(n+="".concat(e,":").concat(t[e],";"))}),n}(d):d}if(e.variable&&"string"==typeof e.variable&&/^--[a-z]/.test(e.variable))u.variable=(Su(c={},"".concat(e.variable,"-light"),r),Su(c,"".concat(e.variable,"-dark"),o),c);return u}return null}function Ru(t){return Ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(t)}function ju(t){var e=function(t,e){if("object"!=Ru(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=Ru(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ru(e)?e:e+""}function Du(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,ju(i.key),i)}}function Nu(t,e,n){return(e=ju(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Mu=function(){function t(e){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),Nu(this,"all",new Map),Nu(this,"weakMap",new WeakMap),Nu(this,"defaultEventTarget",void 0),e?e instanceof Element||e instanceof Document?this.defaultEventTarget=e:this.defaultEventTarget=document.querySelector(e)||document:this.defaultEventTarget=document,this.all.clear=function(){n.all.forEach(function(t,e){t.forEach(function(t){n.off(e,t)})}),n.all.clear()}}return function(t,e,n){e&&Du(t.prototype,e),n&&Du(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"on",value:function(t,e,n){this.all.has(t)||this.all.set(t,[]),this.weakMap.has(e)||this.weakMap.set(e,[]);var i=(n||this.defaultEventTarget).addEventListener,r=function(n){e({sourceType:_u.PAGE,customEvent:n,event:t,payload:n.detail,samePage:!0,emitter:i})};this.all.get(t).push(e),this.weakMap.get(e).push(r),i(t,r)}},{key:"off",value:function(t,e,n){var i,r=this,o=(n||this.defaultEventTarget).removeEventListener;if(!e)return null===(i=this.all.get(t))||void 0===i||i.forEach(function(e){r.weakMap.get(e).forEach(function(e){o(t,e)})}),void this.all.delete(t);this.weakMap.get(e).forEach(function(e){o(t,e)})}},{key:"emit",value:function(t,e,n){var i=new CustomEvent(t,{detail:e}),r=(n||this.defaultEventTarget).dispatchEvent;r(i),r(new CustomEvent("*",{detail:e}))}}]),t}(),Lu=function(){var t=null;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return Cu()?t||(t=new Mu(e)):(console.error("useEvent must be used in the browser environment"),null)}}(),Bu=function(t){return{all:t=t||new Map,on:function(e,n){var i=t.get(e);i?i.push(n):t.set(e,[n])},off:function(e,n){var i=t.get(e);i&&(n?i.splice(i.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var i=t.get(e);i&&i.slice().map(function(t){t(n)}),(i=t.get("*"))&&i.slice().map(function(t){t(e,n)})}}}(),zu=Lu(),Uu="main",Fu="reply",Vu=function(t,e){var n,i,r=window;if(null!=(n=window.reportConfig)&&n.msgObjects&&r[window.reportConfig.msgObjects]){var o=e||t;r[null==(i=r.reportConfig)?void 0:i.msgObjects][t]=o}else;},Hu=function(t,e,n){var i=v(v({},n),{},{spm_id:"".concat(vi(),".").concat(e,".").concat(t)});window.reportObserver&&window.reportObserver.reportCustomData&&window.reportObserver.reportCustomData("show"===t?"appear":t,i)},Wu=function(t,e,n,i){if(e="".concat((null==i?void 0:i.spmPrefix)||vi(),".").concat(e),null!=i&&i.flush){var r=wi({globalInst:"__biliMirrorPbInstance__"});if(r){switch(t){case"show":r("exposure",e,n,{flush:!0});break;case"click":r("click",e,n,{flush:!0});break;case"tech":r("tech",e,n,{flush:!0})}return}}switch(t){case"show":xi("exposure",e,n);break;case"click":xi("click",e,n);break;case"tech":xi("tech",e,n)}},$u=function(){var t=i(m().m(function t(){var e,n;return m().w(function(t){for(;;)switch(t.n){case 0:if(!window.biliMirror&&!window.__biliMirrorPbInstance__){t.n=1;break}return t.a(2);case 1:return e=(null==window?void 0:window.__MIRROR_CONFIG__)||{},n={feature:{tech:!0},autoPv:!1,batch:!1},null!=e&&e.pbOptions&&(n=v(v(v({},n),e.pbOptions),{},{feature:v(v({},n.feature),e.pbOptions.feature)})),t.n=2,mi(n);case 2:window.__biliMirrorPbInstance__=t.v;case 3:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),Gu="bili-comments-config",qu=function(){return function(t){try{return JSON.parse(localStorage.getItem(t))}catch(t){return null}}(Gu)||{}},Xu=function(t){!function(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch(t){}}(Gu,t)},Zu=function(t){var e=qu();e.report=t,Xu(e)},Yu=function(){return qu().report||{blockChecked:!0,deleteChecked:!0}},Qu=function(){return[{name:"",options:[{label:"",value:9},{label:"",value:2},{label:"",value:10},{label:"",value:12},{label:"",value:23}]},{name:"",options:[{label:"",value:19},{label:"",value:22},{label:"",value:20}]},{name:"",options:[{label:"",value:7},{label:"",value:15}]},{name:"",options:[{label:"",value:1},{label:"",value:4},{label:"",value:5},{label:"",value:3},{label:"",value:8},{label:"",value:18},{label:"",value:17}]},{name:"",options:[{label:"",value:0}]}]},Ku=function(t){return t.reason_list?t.reason_list.map(function(t){return{label:t.tag_name,value:t.tag_id,detailIsRequired:!!t.content_required&&t.content_required}}):[]},Ju=Object.defineProperty,td=Object.getOwnPropertyDescriptor,ed=function(t,e,n,i){for(var r,o=i>1?void 0:i?td(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Ju(e,n,o),o},nd=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).type="",t.oid="",t.rpid="",t.mid="",t.uname="",t.ordering="heat",t.appId=100,t.platform=5,t.maxInputLength=200,t.optionValue=-1,t.currentDetailIsRequired=!1,t.inputValue="",t.blockValue=!0,t.canDeleteReply=!1,t.deleteValue=!0,t.groups=[],t.options=[],t}return h(e,t),s(e,[{key:"isBiliPc",get:function(){return!(!this.appId||!this.platform)&&112===Number(this.appId)}},{key:"connectedCallback",value:function(){w(e,"connectedCallback",this,3)([]);var t={oid:this.oid,type:this.type,rpid:this.rpid,mid:this.mid};this.isBiliPc?this.dispatchEvent(new CustomEvent("trackReport",{detail:{type:"show",event:"main.comment.report.all.show",data:t},bubbles:!0})):(Hu("show","comment-report-reason",t),Wu("show","comments.report.show",t)),this.initData()}},{key:"initData",value:(a=i(m().m(function t(){var e,n,i,r,o,a,s,l;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,hu({oid:this.oid,type:this.type});case 1:if(r=t.v,o=r.code,a=r.data,0===o&&a){t.n=2;break}return console.error(""),t.a(2);case 2:null!=(e=a.reason_list)&&e.length?this.options=Ku(a):null!=(n=a.report_groups)&&n.length?this.groups=a.report_groups.map(function(t){return{name:t.name,options:t.report_options}}):this.groups=Qu(),this.canDeleteReply=null!==(i=a.can_delete)&&void 0!==i&&i,s=Yu(),this.blockValue=s.blockChecked,this.canDeleteReply?this.deleteValue=s.deleteChecked:this.deleteValue=!1,console.log(this.blockValue,this.deleteValue),t.n=4;break;case 3:t.p=3,l=t.v,console.error("",l);case 4:return t.a(2)}},t,this,[[0,3]])})),function(){return a.apply(this,arguments)})},{key:"handleOptionClick",value:function(t,e){this.optionValue!==t&&(this.inputValue=""),this.optionValue=t,this.currentDetailIsRequired=e}},{key:"handleOptionChange",value:function(t){this.optionValue=parseInt(t.detail.value)}},{key:"handleInputChange",value:function(t){this.inputValue=t.target.value}},{key:"onBlockChange",value:function(t){this.blockValue=t.detail.checked}},{key:"deleteReply",value:function(t){this.deleteValue=t.detail.checked}},{key:"handleHide",value:function(){this.dispatchEvent(new CustomEvent("hide"))}},{key:"handleCancel",value:function(){this.handleHide()}},{key:"handleConfirm",value:(n=i(m().m(function t(){var e,n,i,r,o,a,s,l=this;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(-1!==this.optionValue){t.n=1;break}return iu(""),t.a(2);case 1:if(n=-1,i="",!this.options.length){t.n=3;break}if(n=this.optionValue,!this.currentDetailIsRequired||""!==this.inputValue.trim()){t.n=2;break}return iu(""),t.a(2);case 2:this.inputValue&&(i=this.inputValue),t.n=7;break;case 3:if(0!==this.optionValue){t.n=6;break}if(this.inputValue){t.n=4;break}return iu(""),t.a(2);case 4:if(!this.inputValue||!(this.inputValue.length<2||this.inputValue.length>this.maxInputLength)){t.n=5;break}return iu("2-200"),t.a(2);case 5:i=this.inputValue;case 6:n=this.optionValue;case 7:return t.p=7,r={},this.isBiliPc&&(r={appId:Number(this.appId),platform:Number(this.platform)}),t.n=8,xu({type:Number(this.type),oid:this.oid,rpid:this.rpid,reason:n,content:i,add_blacklist:this.blockValue,delete:this.deleteValue,ordering:this.ordering,statistics:this.isBiliPc?JSON.stringify(r):""});case 8:if(o=t.v,Zu({blockChecked:this.blockValue,deleteChecked:this.deleteValue}),0!==o.code){t.n=10;break}if(iu((null==(e=o.data)?void 0:e.toast)||""),a={oid:this.oid,type:this.type,rpid:this.rpid,mid:this.mid,reasonid:n,reasonLevel:1,blacklist:this.blockValue,is_block:this.blockValue?1:0,is_delete:this.deleteValue?1:0,ctime:Date.now()},this.isBiliPc?this.dispatchEvent(new CustomEvent("trackReport",{detail:{type:"click",event:"main.comment.report.submit.click",data:a},bubbles:!0})):(Hu("click","comment-report-reason-submit-button",a),Wu("click","comments.report_submit.click",a)),this.handleHide(),s={type:Number(this.type),oid:Number(this.oid),oid_str:this.oid,rpid:Number(this.rpid),rpid_str:this.rpid},!this.blockValue){t.n=9;break}return Bu.emit("remove",{namespaces:[Uu,Fu],method:"filter",predicate:function(t){var e;return(null==(e=t.member)?void 0:e.mid)===l.mid},value:s}),t.a(2);case 9:return Bu.emit("remove",{namespaces:[Uu,Fu],method:"findIndex",predicate:function(t){return t.rpid_str===l.rpid},value:s}),t.a(2);case 10:iu(o.message||""),t.n=12;break;case 11:t.p=11,t.v,iu("");case 12:return t.a(2)}},t,this,[[7,11]])})),function(){return n.apply(this,arguments)})},{key:"handleJumpJudgement",value:function(){this.isBiliPc||Hu("click","judgement",{}),window.open("//www.bilibili.com/judgement/apply"),this.isBiliPc&&Bu.emit("jump",{type:"link",link:"https://www.bilibili.com/judgement/apply"})}},{key:"textareaTemplate",value:function(t){return t?Qe(ns||(ns=x(["<textarea\n      data-key=","\n      .value=",'\n      placeholder=""\n      maxlength="','"\n      @input=',"\n      @keydown=","\n      @keyup=","\n    ></textarea>"])),t,this.inputValue,this.maxInputLength,this.handleInputChange,function(t){return t.stopPropagation()},function(t){return t.stopPropagation()}):Qe(is||(is=x(["\n        <textarea\n          .value=",'\n          placeholder=""\n          maxlength="','"\n          @input=',"\n          @keydown=","\n          @keyup=","\n        ></textarea>\n      "])),this.inputValue,this.maxInputLength,this.handleInputChange,function(t){return t.stopPropagation()},function(t){return t.stopPropagation()})}},{key:"groupsTemplate",value:function(){var t=this;return Qe(rs||(rs=x(['\n      <div id="groups">\n        ',"\n        ","\n      </div>\n    "])),this.groups.map(function(e){return Qe(os||(os=x(['<div id="group">\n              ','\n              <div id="group-options">\n                ',"\n              </div>\n            </div>"])),e.name?Qe(as||(as=x(['<div id="group-name">',"</div"])),e.name):"",e.options.map(function(e){return Qe(ss||(ss=x(['<bili-radio\n                      label="','"\n                      value="','"\n                      checked="','"\n                      @change=',"\n                    ></bili-radio>"])),e.label,e.value,e.value===t.optionValue,t.handleOptionChange)}))}),0===this.optionValue?this.textareaTemplate():"")}},{key:"optionsTemplate",value:function(){var t=this;return Qe(ls||(ls=x(['\n      <div id="options">\n        ',"\n      </div>\n    "])),this.options.map(function(e){return Qe(cs||(cs=x([' <div id="option">\n            <div id="option-name" @click=',">\n              ",'\n              <bili-radio label="" value="','" checked="','"></bili-radio>\n            </div>\n            <div id="sub-option" class="','">\n              <div id="sub-option-name">\n                \n                <span>',"</span>\n              </div>\n              ","\n            </div>\n          </div>"])),function(){return t.handleOptionClick(e.value,e.detailIsRequired)},e.label,e.value,e.value===t.optionValue,e.value===t.optionValue?"show":"",e.detailIsRequired?"()":"()",t.textareaTemplate(e.value))}))}},{key:"render",value:function(){return Qe(us||(us=x(['\n      <div id="form">\n        ','\n      </div>\n\n      \x3c!--  --\x3e\n      <div id="footer">\n        ','\n        <div id="action">\n          <button id="cancel" @click=','></button>\n          <button id="confirm" @click=',"></button>\n        </div>\n      </div>\n    "])),this.groups?Qe(ds||(ds=x(['<div id="main">\n              \x3c!--  --\x3e\n              <div id="tips" @click=','>\n                <div class="tips-prefix"></div>\n                <bili-icon size="16" icon="BDC/arrow_forward_right_line/3"></bili-icon>\n              </div>\n              ',"\n            </div>"])),this.handleJumpJudgement,this.options.length?this.optionsTemplate():this.groupsTemplate()):"",this.mid&&this.uname?Qe(hs||(hs=x(['<div id="optional">\n              <bili-checkbox\n                value="block"\n                label=" @','"\n                checked="','"\n                @change=',"\n              ></bili-checkbox>\n              ","\n            </div>"])),this.uname,this.blockValue,this.onBlockChange,this.canDeleteReply?Qe(ps||(ps=x(['<bili-checkbox\n                    value="block"\n                    label=""\n                    checked="','"\n                    @change=',"\n                  ></bili-checkbox>"])),this.deleteValue,this.deleteReply):""):"",this.handleCancel,this.handleConfirm)}}]);var n,a}(gn);nd.styles=we(fs||(fs=x(['\n    :host {\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n      position: relative;\n    }\n    #tips {\n      display: flex;\n      position: relative;\n      padding: 12px;\n      font-size: 13px;\n      border-radius: 8px;\n      color: var(--text2);\n      background-color: var(--bg2);\n      margin: 4px 0px;\n      cursor: pointer;\n    }\n    #tips .tips-prefix {\n      flex: 1;\n      line-height: 18px;\n    }\n    #form {\n      padding: 12px;\n      min-height: 400px;\n      max-height: calc(100vh - 200px);\n      overflow-y: auto;\n      padding-bottom: 80px; /*  */\n    }\n    #form::-webkit-scrollbar {\n      width: 8px;\n    }\n    #form::-webkit-scrollbar-thumb {\n      background-color: var(--bg3);\n    }\n    /*  */\n    #groups {\n      padding-top: 12px;\n    }\n    #group + #group {\n      margin-top: 12px;\n    }\n    #group-name {\n      font-size: 12px;\n      color: var(--text3);\n      margin-bottom: 15px;\n    }\n    #group-options {\n      display: flex;\n      flex-wrap: wrap;\n    }\n    /*  */\n    #option-name {\n      height: 62px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      font-size: 16px;\n      color: var(--text1);\n      border-radius: 8px;\n      padding: 0 12px;\n      transition: background-color 0.2s;\n    }\n    #option-name bili-radio {\n        display: block;\n        --bili-radio-margin-inline-end: 0;\n        height: 16px;\n        width: 16px;\n        margin-bottom: 0;\n    }\n    #option-name:hover {\n      background-color: var(--bg3);\n    }\n    #sub-option {\n      padding: 0 12px;\n      padding-bottom: 20px;\n      display: none;\n    }\n    /*  */\n    #option::after {\n      content: "";\n      display: block;\n      height: 1px;\n      background-color: var(--line_light);\n      width: calc(100% - 24px);\n      margin: 0px auto;\n    }\n    #sub-option.show {\n      display: block;\n    }\n    #sub-option-name {\n      font-size: 13px;\n      color: var(--text3);\n      margin-bottom: 8px;\n    }\n    #sub-option-name .pink-tag {\n      color: var(--brand_pink);\n    }\n    #options {\n      display: flex;\n      flex-wrap: nowrap;\n      flex-direction: column;\n    }\n    bili-radio {\n      --bili-radio-margin-inline-end: 0;\n      width: 25%;\n      margin-bottom: 16px;\n    }\n    textarea {\n      box-sizing: border-box;\n      font-size: 14px;\n      color: var(--text1);\n      background-color: var(--bg2);\n      width: 100%;\n      height: 120px;\n      padding: 8px;\n      border: none;\n      border-radius: 6px;\n      outline: none;\n      resize: none;\n    }\n\n    textarea::placeholder {\n      color: var(--text4);\n    }\n\n    #footer {\n      display: flex;\n      margin-top: 16px;\n      align-items: center;\n      justify-content: space-between;\n      position: absolute;\n      bottom: 0px;\n      left: 12px;\n      right: 12px;\n      background-color: var(--bg1);\n      padding: 16px 0;\n    }\n    #footer #action {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    #action button {\n      -webkit-font-smoothing: antialiased;\n      border: 1px solid var(--brand_blue);\n      border-radius: 6px;\n      box-sizing: border-box;\n      cursor: pointer;\n      font-family: PingFang SC, HarmonyOS_Regular, Helvetica Neue, Microsoft YaHei, sans-serif !important;\n      font-weight: 400;\n      height: 32px;\n      outline: none;\n      transition: all 0.2s;\n      width: 130px;\n      margin-left: 12px;\n    }\n    #action button#cancel {\n      width: 100px;\n      background-color: var(--bg1);\n      border-color: var(--line_regular);\n      color: var(--text1);\n    }\n    #action button#confirm {\n      width: 100px;\n      background-color: var(--brand_blue);\n      border-color: var(--brand_blue);\n      color: var(--text_white);\n    }\n    #optional {\n      color: var(--text3);\n      display: flex;\n      justify-content: center;\n      flex-direction: column;\n      gap: 8px;\n    }\n\n    /* PC  */\n    /*  -  */\n\n    :host([data-app-id="112"]) bili-radio {\n      --bili-radio-checked-color: var(--brand_pink);\n    }\n\n    :host([data-app-id="112"]) bili-checkbox {\n      --bili-checkbox-checked-color: var(--brand_pink);\n    }\n\n    :host([data-app-id="112"]) #action button {\n      border-color: var(--brand_pink);\n    }\n\n    :host([data-app-id="112"]) #action button#confirm {\n      background-color: var(--brand_pink);\n      border-color: var(--brand_pink);\n      color: var(--text_white);\n    }\n  ']))),ed([kn({type:String,attribute:"data-type"})],nd.prototype,"type",2),ed([kn({type:String,attribute:"data-oid"})],nd.prototype,"oid",2),ed([kn({type:String,attribute:"data-rpid"})],nd.prototype,"rpid",2),ed([kn({type:String,attribute:"data-mid"})],nd.prototype,"mid",2),ed([kn({type:String,attribute:"data-uname"})],nd.prototype,"uname",2),ed([kn({type:String,attribute:"data-ordering"})],nd.prototype,"ordering",2),ed([kn({type:Number,attribute:"data-app-id"})],nd.prototype,"appId",2),ed([kn({type:Number,attribute:"data-platform"})],nd.prototype,"platform",2),ed([An()],nd.prototype,"maxInputLength",2),ed([An()],nd.prototype,"optionValue",2),ed([An()],nd.prototype,"currentDetailIsRequired",2),ed([An()],nd.prototype,"inputValue",2),ed([An()],nd.prototype,"blockValue",2),ed([An()],nd.prototype,"canDeleteReply",2),ed([An()],nd.prototype,"deleteValue",2),ed([An()],nd.prototype,"groups",2),ed([An()],nd.prototype,"options",2),nd=ed([xn("bili-comment-report-form")],nd);var id=function(t){return cu.request({url:"/x/member/web/uname/update",method:"POST",data:{uname:t,source:"reply"},headers:{"Content-Type":"application/x-www-form-urlencoded"}})},rd=Object.defineProperty,od=Object.getOwnPropertyDescriptor,ad=function(t,e,n,i){for(var r,o=i>1?void 0:i?od(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&rd(e,n,o),o},sd=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).inputValue="",t}return h(e,t),s(e,[{key:"handleInputChange",value:function(t){this.inputValue=t.target.value}},{key:"handleHide",value:function(){this.dispatchEvent(new CustomEvent("hide"))}},{key:"handleCancel",value:function(){this.handleHide()}},{key:"handleConfirm",value:(n=i(m().m(function t(){var e,n,i;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,this.inputValue){t.n=1;break}return iu(""),t.a(2);case 1:return t.n=2,id(this.inputValue);case 2:if(e=t.v,n=e.code,i=e.message,0!==n){t.n=3;break}return iu(""),this.handleHide(),t.a(2);case 3:iu(i||""),t.n=5;break;case 4:t.p=4,t.v,iu("");case 5:return t.a(2)}},t,this,[[0,4]])})),function(){return n.apply(this,arguments)})},{key:"render",value:function(){return Qe(vs||(vs=x(['\n      <div id="form">\n        <div id="tips"></div>\n        <div id="input">\n          <input .value=',' placeholder="" maxlength="16" @input=',' />\n        </div>\n        <div id="footer">\n          <div id="action">\n            <button id="cancel" @click=','></button>\n            <button id="confirm" @click=',"></button>\n          </div>\n        </div>\n      </div>\n    "])),this.inputValue,this.handleInputChange,this.handleCancel,this.handleConfirm)}}]);var n}(gn);sd.styles=we(ms||(ms=x(["\n    :host {\n      padding: 24px;\n      display: flex;\n      flex-direction: column;\n    }\n\n    #tips {\n      width: 100%;\n      text-align: center;\n      font-size: 14px;\n      color: var(--text2);\n      margin-bottom: 16px;\n    }\n\n    #input {\n      width: 100%;\n      margin-bottom: 40px;\n    }\n\n    #input input {\n      box-sizing: border-box;\n      width: 100%;\n      height: 40px;\n      padding: 0 10px;\n      border: 1px solid var(--graph_weak);\n      border-radius: 4px;\n      outline: none;\n    }\n\n    #footer {\n      margin-top: 16px;\n    }\n    #footer #action {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n    #action button {\n      -webkit-font-smoothing: antialiased;\n      border: 1px solid var(--brand_blue);\n      border-radius: 6px;\n      box-sizing: border-box;\n      cursor: pointer;\n      font-family: PingFang SC, HarmonyOS_Regular, Helvetica Neue, Microsoft YaHei, sans-serif !important;\n      font-weight: 400;\n      height: 32px;\n      outline: none;\n      transition: all 0.2s;\n      width: 160px;\n    }\n    #action button#cancel {\n      background-color: var(--bg1);\n      border-color: var(--line_regular);\n      color: var(--text1);\n    }\n    #action button#confirm {\n      background-color: var(--brand_blue);\n      border-color: var(--brand_blue);\n      color: var(--text_white);\n    }\n  "]))),ad([An()],sd.prototype,"inputValue",2),sd=ad([xn("bili-comment-update-uname-form")],sd);var ld=function(){return cu.request({baseURL:"//cm.bilibili.com",url:"/commercialorder/api/web_api/v1/main_site/upper/comment/reason_list"})},cd=Object.defineProperty,ud=Object.getOwnPropertyDescriptor,dd=function(t,e,n,i){for(var r,o=i>1?void 0:i?ud(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&cd(e,n,o),o},hd=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).type="",t.oid="",t.rpid="",t.maxInputLength=100,t.optionValue=-1,t.inputValue="",t.options=[],t}return h(e,t),s(e,[{key:"connectedCallback",value:function(){w(e,"connectedCallback",this,3)([]),this.initData()}},{key:"initData",value:(a=i(m().m(function t(){var e,n,i;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,ld();case 1:0===(n=t.v).code&&null!=(e=n.result)&&e.length&&(i=n.result.map(function(t){return{label:t.reason_content,value:t.reason_index}}),this.options=i.concat({label:"",value:0})),t.n=3;break;case 2:t.p=2,t.v,iu("");case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return a.apply(this,arguments)})},{key:"handleOptionChange",value:function(t){this.optionValue=parseInt(t.detail.value)}},{key:"handleInputChange",value:function(t){this.inputValue=t.target.value}},{key:"handleHide",value:function(){this.dispatchEvent(new CustomEvent("hide"))}},{key:"handleCancel",value:function(){this.handleHide()}},{key:"handleConfirm",value:(n=i(m().m(function t(){var e,n,i,r=this;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(-1!==this.optionValue){t.n=1;break}return iu(""),t.a(2);case 1:if(0!==this.optionValue){t.n=3;break}if(this.inputValue){t.n=2;break}return iu(""),t.a(2);case 2:if(!this.inputValue||!(this.inputValue.length<2||this.inputValue.length>this.maxInputLength)){t.n=3;break}return iu("2-100"),t.a(2);case 3:return t.p=3,e="",n=this.options.find(function(t){return t.value===r.optionValue}),0===this.optionValue?e=this.inputValue:n&&(e=n.label),t.n=4,Au({av_id:this.oid,comment_id:this.rpid,reason:e});case 4:0===(i=t.v).code?iu(i.result||""):iu(i.message||""),this.handleHide(),t.n=6;break;case 5:t.p=5,t.v,iu("");case 6:return t.a(2)}},t,this,[[3,5]])})),function(){return n.apply(this,arguments)})},{key:"textareaTemplate",value:function(){return Qe(ys||(ys=x(['<div id="input">\n      <textarea\n        .value=','\n        placeholder=""\n        maxlength="','"\n        @input=',"\n      ></textarea>\n    </div>"])),this.inputValue,this.maxInputLength,this.handleInputChange)}},{key:"render",value:function(){var t=this;return Qe(bs||(bs=x(['\n      <div id="tips">\n        <span></span>\n      </div>\n      <div id="form">\n        ',"\n        ",'\n      </div>\n      <div id="footer">\n        <div id="action">\n          <button id="cancel" @click=','></button>\n          <button id="confirm" @click=',"></button>\n        </div>\n      </div>\n    "])),this.options.map(function(e){return Qe(gs||(gs=x(['<div class="option">\n              <bili-radio\n                label="','"\n                value="','"\n                checked="','"\n                @change=',"\n              ></bili-radio>\n            </div>"])),e.label,e.value,e.value===t.optionValue,t.handleOptionChange)}),0===this.optionValue?this.textareaTemplate():"",this.handleCancel,this.handleConfirm)}}]);var n,a}(gn);hd.styles=we(ws||(ws=x(["\n    :host {\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n    }\n    #tips {\n      display: flex;\n      align-items: center;\n      position: relative;\n      padding: 12px 0;\n      font-size: 14px;\n      border-radius: 4px;\n      color: var(--text1);\n      transition: 0.2s;\n      cursor: pointer;\n      margin-bottom: 12px;\n    }\n    #form {\n      min-height: 220px;\n    }\n    bili-radio {\n      --bili-radio-margin-inline-end: 0;\n      margin-bottom: 16px;\n    }\n    #input {\n    }\n    textarea {\n      box-sizing: border-box;\n      width: 100%;\n      height: 70px;\n      padding: 8px;\n      border: 1px solid var(--graph_weak);\n      border-radius: 4px;\n      outline: none;\n      resize: none;\n    }\n\n    #footer {\n      margin-top: 16px;\n    }\n    #footer #action {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    #action button {\n      -webkit-font-smoothing: antialiased;\n      border: 1px solid var(--brand_blue);\n      border-radius: 6px;\n      box-sizing: border-box;\n      cursor: pointer;\n      font-family: PingFang SC, HarmonyOS_Regular, Helvetica Neue, Microsoft YaHei, sans-serif !important;\n      font-weight: 400;\n      height: 32px;\n      outline: none;\n      transition: all 0.2s;\n      width: 130px;\n      margin-left: 12px;\n    }\n    #action button#cancel {\n      background-color: var(--bg1);\n      border-color: var(--line_regular);\n      color: var(--text1);\n    }\n    #action button#confirm {\n      background-color: var(--brand_blue);\n      border-color: var(--brand_blue);\n      color: var(--text_white);\n    }\n  "]))),dd([kn({type:String,attribute:"data-type"})],hd.prototype,"type",2),dd([kn({type:String,attribute:"data-oid"})],hd.prototype,"oid",2),dd([kn({type:String,attribute:"data-rpid"})],hd.prototype,"rpid",2),dd([An()],hd.prototype,"maxInputLength",2),dd([An()],hd.prototype,"optionValue",2),dd([An()],hd.prototype,"inputValue",2),dd([An()],hd.prototype,"options",2),hd=dd([xn("bili-comment-commercial-order-appeal-form")],hd);function pd(t,e){var n=[];if(!0!==t.can_modify)return n;var i=t.up_reply_selection,r=t.up_reply,o=t.up_dm;if(null!=i&&i.can_modify){var a=1===i.status;n.push({key:"select",text:a?"":"",data:{active:!a}})}if(null!=r&&r.can_modify){var s=1===r.status;n.push({key:"close",text:s?"":"",data:{active:!s}})}if(null!=o&&o.can_modify&&!e){var l=1===o.status;n.push({key:"close-danmaku",text:l?"":"",data:{active:!l}})}return n}function fd(t){var e={customTitle:"",hideClose:!1,origin:(null==t?void 0:t.origin)||"comments",spm_id_from:"".concat((null==t?void 0:t.spmPrefix)||vi(),".").concat((null==t?void 0:t.event)||"replyUnknowAction")};return oi(e)}var vd=Object.defineProperty,md=Object.getOwnPropertyDescriptor,yd=function(t,e,n,i){for(var r,o=i>1?void 0:i?md(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&vd(e,n,o),o},bd=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.spmPrefix="",t.oid="",t.type=0,t.root="",t.user=null,t.assist=!1,t.upMid=0,t.actionConfig={},t.likeCount=0,t.isLike=!1,t.isDislike=!1,t.showMoreMenu=!1,t.options=[],t}return h(e,t),s(e,[{key:"pubDate",get:function(){return function(t){var e=Math.floor((new Date).getTime()/1e3)-t,n=new Date;if(n.setHours(0),n.setMinutes(0),n.setSeconds(0),!(Math.floor(n.getTime()/1e3)<t&&e>=0)){var i=new Date;i.setTime(1e3*t);var r=i.getFullYear(),o=i.getMonth()+1>=10?i.getMonth()+1:"0".concat(i.getMonth()+1),a=i.getDate()>=10?i.getDate():"0".concat(i.getDate()),s=i.getHours()>=10?i.getHours():"0".concat(i.getHours()),l=i.getMinutes()>=10?i.getMinutes():"0".concat(i.getMinutes());return"".concat(r,"-").concat(o,"-").concat(a," ").concat(s,":").concat(l)}if(e<60){var c=10*Math.floor(e%60/10);return c>=10?"".concat(c,""):""}return 60<=e&&e<3600?"".concat(Math.floor(e/60),""):e>=3600?"".concat(Math.floor(e/3600),""):void 0}(this.data.ctime)}},{key:"likeIcon",get:function(){return this.isLike?"BDC/hand_thumbsup_fill/1":"BDC/hand_thumbsup_line/1"}},{key:"dislikeIcon",get:function(){return this.isDislike?"BDC/hand_thumbsdown_fill/2":"BDC/hand_thumbsdown_line/1"}},{key:"trackReport",value:function(t){Wu("click","comment.action.click",{rpid:this.data.rpid_str,action:t},{spmPrefix:this.spmPrefix})}},{key:"handleLikeState",value:(l=i(m().m(function t(e){return m().w(function(t){for(;;)switch(t.n){case 0:if(Vu("like"===e?"replyCardLikeClick":"replyCardHateClick",{rpid:this.data.rpid_str}),this.trackReport(e),"like"!==e){t.n=1;break}return!this.isLike&&this.isDislike&&(this.isDislike=!1),this.isLike=!this.isLike,this.likeCount=this.isLike?this.likeCount+1:this.likeCount-1,this.handleTrackClick(this.isLike?5:21),t.a(2);case 1:!this.isDislike&&this.isLike&&(this.isLike=!1,this.likeCount=this.likeCount-1),this.isDislike=!this.isDislike,this.handleTrackClick(this.isDislike?6:22);case 2:return t.a(2)}},t,this)})),function(t){return l.apply(this,arguments)})},{key:"handleTrackClick",value:function(t){this.dispatchEvent(new CustomEvent("track",{detail:t}))}},{key:"connectedCallback",value:function(){w(e,"connectedCallback",this,3)([]),this.initData()}},{key:"initData",value:function(){var t=this;this.likeCount=this.data.like,this.isLike=1===this.data.action,this.isDislike=2===this.data.action,this.options=function(t){var e=t.upMid,n=t.reply,i=t.user,r=t.top,o=t.assist,a=t.upFilter,s=t.isBiliPc,l=t.share;if(!e)return console.warn("get comments actions warning: no up mid"),[];var c=[],u=(null==i?void 0:i.mid)===e;u&&"main"===t.ns&&c.push({key:"top",text:r?"":"",data:{active:!r}}),l&&c.push({key:"share",text:""});var d=!i||String(i.mid)!==n.member.mid;if(d)if(s||c.push({key:"block",text:""}),i){var h=i.is_jury,p=i.is_senior_member;h?c.push({key:"report",text:"",data:{hiddenJuryTips:!0}}):c.push({key:"report",text:p?"":""})}else c.push({key:"report",text:""});return(u||!d||o)&&c.push({key:"delete",text:""}),a&&c.push({key:"filter",text:a.text,data:{link:a.link}}),c}(v({upMid:this.upMid,reply:this.data,user:this.user,top:this.data.reply_control.is_up_top||!1,ns:this.root?"reply":"main",assist:this.assist,share:this.data.reply_control.support_share||!1},this.actionConfig)),setTimeout(function(){t.disposables.addEventListener(t.menu,"mouseleave",function(){t.showMoreMenu=!1})})}},{key:"updated",value:function(t){t.get("data")&&this.initData()}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose()}},{key:"handleLike",value:(a=i(m().m(function t(){var e;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.user){t.n=1;break}return fd({event:"selfDef.replyCardLikeClick",spmPrefix:this.spmPrefix}),t.a(2);case 1:return t.p=1,t.n=2,pu({oid:this.oid,type:this.type,rpid:this.data.rpid,action:this.isLike?0:1});case 2:if(0===t.v.code){t.n=3;break}return t.a(2);case 3:this.handleLikeState("like"),t.n=5;break;case 4:t.p=4,e=t.v,console.error(e);case 5:return t.a(2)}},t,this,[[1,4]])})),function(){return a.apply(this,arguments)})},{key:"handleHate",value:(n=i(m().m(function t(){var e;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.user){t.n=1;break}return fd({event:"selfDef.replyCardDisikeClick",spmPrefix:this.spmPrefix}),t.a(2);case 1:return t.p=1,t.n=2,fu({oid:this.oid,type:this.type,rpid:this.data.rpid,action:this.isDislike?0:1});case 2:if(0===t.v.code){t.n=3;break}return t.a(2);case 3:this.handleLikeState("dislike"),t.n=5;break;case 4:t.p=4,e=t.v,console.error(e);case 5:return t.a(2)}},t,this,[[1,4]])})),function(){return n.apply(this,arguments)})},{key:"handleReply",value:function(t){t.stopPropagation(),Vu("replyCardReplyClick",{rpid:this.data.rpid_str}),this.trackReport("reply"),this.dispatchEvent(new CustomEvent("reply")),this.handleTrackClick(28)}},{key:"handleMore",value:function(){Vu("replyCardMoreClick",{rpid:this.data.rpid_str}),this.trackReport("more"),this.showMoreMenu=!0,this.handleTrackClick(8)}},{key:"handleSelectOption",value:function(t){this.trackReport(t.detail.key),this.showMoreMenu=!1,this.user?this.dispatchEvent(new CustomEvent("action",{detail:t.detail})):fd({event:"selfDef.replyCardOptionClick",spmPrefix:this.spmPrefix})}},{key:"render",value:function(){return Qe(xs||(xs=x(['\n      <div id="pubdate">','</div>\n      <div id="like">\n        <button @click=','>\n          <bili-icon\n            size="16"\n            icon="','"\n            style="','"\n          ></bili-icon>\n          <span id="count">','</span>\n        </button>\n      </div>\n      <div id="dislike">\n        <button @click=','>\n          <bili-icon\n            size="16"\n            icon="','"\n            style="','"\n          ></bili-icon>\n        </button>\n      </div>\n      <div id="reply">\n        <button @click=','></button>\n      </div>\n      <div id="more">\n        <button @click=','>\n          <bili-icon size="16" icon="BDC/more_vertical_fill/1"></bili-icon>\n        </button>\n        <bili-comment-menu\n          style="','"\n          .options=',"\n          @select=","\n        ></bili-comment-menu>\n      </div>\n    "])),this.pubDate,this.handleLike,this.likeIcon,this.isLike?Zn({color:"var(--brand_blue)"}):"",this.likeCount>0?this.likeCount:"",this.handleHate,this.dislikeIcon,this.isDislike?Zn({color:"var(--brand_blue)"}):"",this.handleReply,this.handleMore,this.showMoreMenu?Zn({"--bili-comment-menu-display":"block"}):"",this.options,this.handleSelectOption)}}]);var n,a,l}(gn);bd.styles=we(ks||(ks=x(["\n    :host {\n      width: 100%;\n      display: flex;\n      align-items: center;\n      position: relative;\n      margin-top: 3px;\n      font-size: 13px;\n      color: var(--text3);\n    }\n    :host > *:not(:first-child) {\n      margin-left: 20px;\n    }\n\n    button {\n      padding: 0;\n      outline: none;\n      border: none;\n      background: transparent;\n      height: 24px;\n      font-size: 13px;\n      color: var(--text3);\n      display: inline-flex;\n      align-items: center;\n      cursor: pointer;\n    }\n    button:hover {\n      color: var(--brand_blue);\n    }\n    button span {\n      margin-left: 5px;\n      display: inline-block;\n    }\n    button bili-icon {\n      vertical-align: middle;\n    }\n\n    #more {\n      margin-left: auto;\n      margin-right: 20px;\n      width: 24px;\n      height: 24px;\n      position: relative;\n    }\n    #more button {\n      width: 24px;\n      height: 24px;\n      text-align: center;\n      display: var(--bili-comment-action-buttons-more-display, none);\n    }\n  "]))),yd([kn({type:String})],bd.prototype,"spmPrefix",2),yd([kn()],bd.prototype,"data",2),yd([kn()],bd.prototype,"oid",2),yd([kn()],bd.prototype,"type",2),yd([kn()],bd.prototype,"root",2),yd([kn()],bd.prototype,"user",2),yd([kn()],bd.prototype,"assist",2),yd([kn()],bd.prototype,"upMid",2),yd([kn()],bd.prototype,"actionConfig",2),yd([An()],bd.prototype,"pubDate",1),yd([An()],bd.prototype,"likeCount",2),yd([An()],bd.prototype,"isLike",2),yd([An()],bd.prototype,"isDislike",2),yd([An()],bd.prototype,"showMoreMenu",2),yd([An()],bd.prototype,"likeIcon",1),yd([An()],bd.prototype,"options",2),yd([Cn("bili-comment-menu")],bd.prototype,"menu",2),bd=yd([xn("bili-comment-action-buttons-renderer")],bd);var gd=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=v({},t);return null!=(e=t.pictures)&&e.length&&(i.pictures=JSON.stringify(t.pictures)),t.has_vote_option&&(i.has_vote_option="true"),cu.request({method:"POST",url:"/x/v2/reply/add",data:v(v({},i),{},{gaia_source:"main_web"}),chainProxy:function(t){return n?t:t.with("UNIOS_RISK_USER_LOG",{active:!0}).with(du).with("UNIOS_WBI_ENCODE",{active:!0})},headers:{"Content-Type":"application/x-www-form-urlencoded"}})};function wd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xd(t,e){return xd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xd(t,e)}function kd(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xd(t,e)}function Ad(t){return Ad=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ad(t)}function _d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_d=function(){return!!t})()}function Ed(t){return Ed="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(t)}function Cd(t){var e=_d();return function(){var n,i=Ad(t);if(e){var r=Ad(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){if(e&&("object"===Ed(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return wd(t)}(this,n)}}function Td(t){var e=function(t,e){if("object"!=Ed(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=Ed(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ed(e)?e:String(e)}function Sd(t,e,n){return(e=Td(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Od(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Td(i.key),i)}}function Pd(t,e,n){return e&&Od(t.prototype,e),n&&Od(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Id(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Rd=Pd(function t(){Id(this,t)}),jd="widget-layer-avatar",Dd=function(t){kd(n,t);var e=Cd(n);function n(){var t;Id(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Sd(wd(t=e.call.apply(e,[this].concat(r))),"pos",{axis_x:1,axis_y:1,coordinate_pos:0}),Sd(wd(t),"size",{height:1,width:1}),Sd(wd(t),"render",{opacity:1}),t}return Pd(n,[{key:"setPos",value:function(t,e,n){return this.pos={axis_x:t,axis_y:e,coordinate_pos:n},this}},{key:"setSize",value:function(t,e){return this.size={height:e,width:t},this}},{key:"getValue",value:function(){return{pos_spec:this.pos,size_spec:this.size,render_spec:this.render}}}]),n}(Rd),Nd=function(t){kd(n,t);var e=Cd(n);function n(){var t;Id(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Sd(wd(t=e.call.apply(e,[this].concat(r))),"tags",{}),Sd(wd(t),"isCritical",!1),Sd(wd(t),"allowOverPaint",!1),Sd(wd(t),"mask",null),t}return Pd(n,[{key:"setIsCritical",value:function(){return this.isCritical=!0,this}},{key:"setTag",value:function(t,e){return this.tags[t]=e,this}},{key:"getTag",value:function(t){return this.tags[t]}},{key:"setMask",value:function(t){return this.mask=t,this}},{key:"getValue",value:function(){return{tags:this.tags,is_critical:this.isCritical,allow_over_paint:this.allowOverPaint,layer_mask:this.mask}}}]),n}(Rd),Md=function(t){kd(n,t);var e=Cd(n);function n(){var t;Id(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Sd(wd(t=e.call.apply(e,[this].concat(r))),"type",3),Sd(wd(t),"image",void 0),Sd(wd(t),"animation",void 0),Sd(wd(t),"nativeDraw",void 0),t}return Pd(n,[{key:"setImage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return this.type=3,this.image=e?{image_src:{src_type:1,remote:{url:e,bfs_style:jd},placeholder:t}}:{image_src:{src_type:2,local:t,placeholder:t}},this}},{key:"setAnimation",value:function(t,e){return this.type=4,this.animation={webp_src:{src_type:1,remote:{url:t,bfs_style:jd},placeholder:e}},this}},{key:"setNativeDraw",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff";return this.type=5,this.nativeDraw={draw_src:{src_type:3,placeholder:0,draw:{draw_type:t,fill_mode:null!=e?e:0,color_config:{day:{argb:n},is_dark_mode_aware:!1,night:{argb:n}},edge_weight:0}}},this}},{key:"getValue",value:function(){switch(this.type){case 3:return{res_type:this.type,res_image:this.image};case 4:return{res_type:this.type,res_animation:this.animation};case 5:return{res_type:this.type,res_native_draw:this.nativeDraw};default:return{res_type:this.type}}}}]),n}(Rd),Ld=function(t){kd(n,t);var e=Cd(n);function n(){var t;Id(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Sd(wd(t=e.call.apply(e,[this].concat(r))),"spec",new Dd),Sd(wd(t),"config",new Nd),Sd(wd(t),"resource",new Md),t}return Pd(n,[{key:"getConfigTag",value:function(t){return this.config.getTag(t)}},{key:"getValue",value:function(){return{layer_id:"",visible:!0,general_spec:this.spec.getValue(),layer_config:this.config.getValue(),resource:this.resource.getValue()}}}]),n}(Rd),Bd=function(t){kd(n,t);var e=Cd(n);function n(){var t;Id(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Sd(wd(t=e.call.apply(e,[this].concat(r))),"layers",[]),Sd(wd(t),"mask",null),Sd(wd(t),"isCritical",!1),t}return Pd(n,[{key:"setMask",value:function(t){return this.mask=t,this}},{key:"addLayer",value:function(t){return this.layers.push(t),this}},{key:"setIsCritical",value:function(){return this.isCritical=!0,this}},{key:"getValue",value:function(){return{group_id:"",layers:this.layers.map(function(t){return t.getValue()}),group_mask:this.mask,is_critical_group:this.isCritical}}}]),n}(Rd),zd=function(t){return"string"==typeof t?t:t.image||""},Ud=function(){var t=new Ld;return t.config.setIsCritical().setTag("PENDENT_LAYER",{config_type:0}).setTag("GENERAL_CFG",{config_type:1,general_config:{web_css_style:{borderRadius:"50%"}}}),t},Fd=function(){var t=new Ld;return t.config.setTag("ICON_LAYER",{config_type:0}).setTag("GENERAL_CFG",{config_type:1,general_config:{web_css_style:{"background-color":"rgb(255,255,255)",border:"2px solid rgba(255,255,255,1)",borderRadius:"50%",boxSizing:"border-box"}}}),t},Vd=function(t,e){var n,i=new Bd,r=t.face,o=t.pendant,a=t.official,s=t.vip,l=t.nft,c=null!==(n=t.a)&&void 0!==n?n:48,u=function(t){var e=new Ld;return e.config.setIsCritical().setTag("AVATAR_LAYER",{config_type:0}).setTag("GENERAL_CFG",{config_type:1,general_config:{web_css_style:{borderRadius:"50%"}}}),e.resource.setImage(6,t),e}(r),d=1,h=null,p=o?zd(o):"";p&&(h=Ud()).resource.setImage(0,p);var f=[];l&&[1,2].includes(l)?(f.push(function(t){var e=Fd();return e.resource.setAnimation(1===t?"https://i0.hdslb.com/bfs/activity-plat/static/20220506/334553dd7c506a92b88eaf4d59ac8b4d/j8AeXAkEul.gif":"https://i0.hdslb.com/bfs/activity-plat/static/20220506/334553dd7c506a92b88eaf4d59ac8b4d/IOHoVs1ebP.gif",5),e}(l)),h?(h.spec.setSize(e,e).setPos(e/2,e/2,2),d=.94,u.spec.setSize(d,d).setPos(e/2,e/2,2)):(d=c>48?1.2:1.3,u.spec.setSize(d,d).setPos(e/2,e/2,2))):h?(h.spec.setPos(.6875,.6875,2).setSize(1.375,1.375),d=.787,u.spec.setSize(d,d).setPos(.6875,.6875,2)):u.spec.setSize(1,1).setPos(.675,.675,2);var v=function(t){var e=-1;return t&&(e="number"==typeof t?t:t.type),e}(a),m=function(t){if(!t)return!1;if(!0===t)return!0;if("string"==typeof t)return t;var e=t.type,n=t.status,i=t.avatar_subscript_url;return e>0&&1===n&&(i||!0)}(s);if(-1!==v?f.push(function(t){var e=Fd();return e.resource.setImage(0===t?3:4),e}(v)):m&&f.push(function(t){var e=Fd();return e.resource.setImage(1,t),e}("string"==typeof m?m:"")),i.addLayer(u),h&&i.addLayer(h),f.length){var y=function(t,e,n){switch(t){case 64:case 80:return(16+2*e)/t;default:return((1===n?16:14)+2*e)/t}}(c,2,f.length),b=(y*c-2)/c,g=e/2+d/2-b,w=g;h&&(g+=1/15,w+=.05),f.slice(0,2).reverse().forEach(function(t,e){t.spec.setSize(y,y).setPos(w-e*b,g,1),i.addLayer(t)})}return i},Hd=function(t){var e=function(t){var e,n=null!==(e=t.a)&&void 0!==e?e:48,i=t.pendant?zd(t.pendant):"";return 80===n?t.nft?i?1.8:1.65:1.5:t.nft?i?1.65:1.5:i?1.375:1.35}(t),n=Vd(t,e),i={container_size:{width:e,height:e},fallback_layers:n.getValue(),mid:t.mid},r=function(t,e){var n=t.pendant;if(!n||"string"==typeof n||!n.image_enhance)return[];Ud().resource.setAnimation(n.image_enhance,0);var i=[];return e.layers.forEach(function(t){var e=new Bd;t.getConfigTag("PENDENT_LAYER")&&t.resource.setAnimation(n.image_enhance,0),e.addLayer(t),i.push(e)}),i.map(function(t){return t.getValue()})}(t,n);return r.length&&(i.layers=r),i},Wd=function(t){var e=t.lastIndexOf("@");if(-1===e)return null;var n=t.substring(e+1);return n.length<=16&&!/\s/.test(n)?n:null},$d=!1,Gd=null;("undefined"==typeof window?"undefined":_(window))<"u"&&($d="IntersectionObserver"in window);var qd=function(t){t.forEach(function(t){var e=function(t){return t.__i18r_callback__}(t.target);"function"==typeof e&&e(t)})},Xd={start:"start_time",end:"end_time",duration:"duration"},Zd=function(){return s(function t(e){o(this,t),this.isIntersecting=!1,this.showFinished=!1,this.showSupport=$d,this.showDurational=!1,this.showDurationConfig=Xd,this.showDurationStart=0,this.type=e.type,this.el=e.el,this.handler=e.handler,this.value=e.value,this.modifiers=e.modifiers||{},e.durational&&(this.showDurational=!0,"object"==_(e.durational)&&(this.showDurationConfig=e.durational)),this.init()},[{key:"observeShow",value:function(t,e){Gd||(Gd=new IntersectionObserver(qd)),function(t,e){t.__i18r_callback__=e}(t,e),Gd.observe(t)}},{key:"unobserveShow",value:function(t){this.showFinished=!0,Gd&&(Gd.unobserve(t),function(t){delete t.__i18r_callback__}(t))}},{key:"observeClick",value:function(t,e){t.addEventListener("click",e)}},{key:"unobserveClick",value:function(t,e){t.removeEventListener("click",e)}},{key:"report",value:function(t){var e=this.value.event,n=v({},this.value.data),i=this.modifiers.raw,r=!1;"both"===this.type&&i&&console.warn("show and click event use raw will be same"),this.showDurational&&["tech","show"].includes(t)&&(this.showDurationStart?(Object.assign(n,c(c({},this.showDurationConfig.end||Xd.end,Date.now()),this.showDurationConfig.duration||Xd.duration,Date.now()-this.showDurationStart)),this.showDurationConfig.repeat&&(this.showDurationStart=0),this.showDurationConfig.endEvent?e=this.showDurationConfig.endEvent:(e=e.replace(".all",".end"),this.showDurationStart=0),this.showDurationConfig.beforeunload&&(r=!0)):(this.showDurationStart=Date.now(),delete n[this.showDurationConfig.end||Xd.end],delete n[this.showDurationConfig.duration||Xd.duration],Object.assign(n,c({},this.showDurationConfig.start||Xd.start,this.showDurationStart)))),this.handler(t,i?e:"".concat(e,".").concat(t),n,{flush:r})}},{key:"reportShowDuration",value:function(t){if(this.showDurational&&!this.showFinished){if(t){if(!this.isIntersecting||0!==this.showDurationStart)return;return void this.report("show")}0!==this.showDurationStart&&(this.report("show"),this.showDurationConfig.repeat||(this.showFinished=!0))}}},{key:"init",value:function(){var t=this;if(this.el){var e=this.el,n=[];if("click"===this.type||"both"===this.type){var i=function(){t.report(t.modifiers.tech?"tech":"click")};n.push(function(){t.unobserveClick(e,i)}),this.observeClick(e,i)}if("show"===this.type||"both"===this.type)if(this.showSupport){n.push(function(){t.showFinished||(t.showDurational&&t.showDurationStart&&t.report(t.modifiers.tech?"tech":"show"),t.unobserveShow(e))});var r=function(){};if(this.showDurationConfig.beforeunload){var o=!1,a=function(){t.showFinished||(t.showDurationStart&&t.report(t.modifiers.tech?"tech":"show"),t.unobserveShow(e))};window.addEventListener("beforeunload",a),window.addEventListener("pagehide",a),r=function(){o||(o=!0,window.removeEventListener("beforeunload",a),window.removeEventListener("pagehide",a))},n.push(r)}this.observeShow(e,function(n){if(t.isIntersecting=n.isIntersecting,t.showDurational)if(n.isIntersecting){if(t.showDurationStart)return;t.report(t.modifiers.tech?"tech":"show")}else{if(!t.showDurationStart||(t.report(t.modifiers.tech?"tech":"show"),t.showDurationConfig.repeat))return;t.showDurationConfig.beforeunload&&r(),t.unobserveShow(e)}else n.isIntersecting&&(t.report(t.modifiers.tech?"tech":"show"),t.unobserveShow(e))})}else console.warn("IntersectionObserver not supported");this.removeListener=function(){n.forEach(function(t){t()})}}}},{key:"update",value:function(t){this.value=t}},{key:"dispose",value:function(){var t;null==(t=this.removeListener)||t.call(this),this.el=null}}])}();function Yd(t){var e=document.createElement("bili-modal");document.body.appendChild(e),e.show(v(v({},t),{},{final:function(){var n;null==(n=t.final)||n.call(t),document.body.removeChild(e)}}))}function Qd(t){return new Promise(function(e,n){var r=v({},t),o=!1===t.confirm,a=!1===t.cancel;if(o&&a)return n("Not allow confirm and cancel both false");function s(n){var o,a,s,l="confirm"===n,c=null!==(o=t[n])&&void 0!==o?o:l?"":"";if("function"==typeof c)r[n]=function(){var t=i(m().m(function t(n){return m().w(function(t){for(;;)switch(t.n){case 0:if(!("function"==typeof c)){t.n=1;break}return t.n=1,c(n);case 1:e(l);case 2:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}();else if("string"==typeof c)r[n]={text:c,click:(s=i(m().m(function t(n){return m().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,n();case 1:e(l);case 2:return t.a(2)}},t)})),function(t){return s.apply(this,arguments)})};else{var u=c;r[n]={text:u.text||("confirm"===n?"":""),click:(a=i(m().m(function t(n){return m().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,u.click(n);case 1:e(l);case 2:return t.a(2)}},t)})),function(t){return a.apply(this,arguments)})}}}o||a?t.final=function(){return e(o)}:(s("confirm"),s("cancel")),Yd(r)})}var Kd="//www.bilibili.com",Jd="//space.bilibili.com",th="//search.bilibili.com",eh=function(t){return/https?:/.test(t)?t:(t.startsWith("//")||(t="//".concat(t)),"".concat(location.protocol).concat(t))},nh=function(t,e){var n=new URL(eh(t));return Object.keys(e).forEach(function(t){n.searchParams.has(t)&&n.searchParams.delete(t),n.searchParams.append(t,encodeURIComponent(e[t]))}),n.toJSON()},ih=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"".concat(Jd,"/").concat(t).concat(e)},rh=function(t){var e=t.bvid,n=t.avid,i=t.ssid,r=t.epid;return e?"".concat(Kd,"/video/").concat(e,"/"):n?"".concat(Kd,"/video/av").concat(n,"/"):i?"".concat(Kd,"/bangumi/play/ss").concat(i):r?"".concat(Kd,"/bangumi/play/ep").concat(i):""},oh=function(t){return"".concat(Kd,"/read/cv").concat(t,"/")},ah=function(t){return nh("".concat(th,"/all"),{keyword:t})},sh=function(t,e){return e||(e="comment"),"//t.bilibili.com/h5/dynamic/vote/#/result?vote_id=".concat(t,"&from=").concat(e,"&isWeb=1")};function lh(t){return Object.keys(t).map(function(e){return"".concat(e,":").concat(t[e])}).join(";")}function ch(t,e){return function(t,e,n){var i=[];return e&&Object.keys(e).forEach(function(t){void 0!==e[t]&&i.push("".concat(t,'="').concat(e[t],'"'))}),"<".concat(t).concat(i.length?" ".concat(i.join(" ")):"",">").concat(n?Array.isArray(n)?n.join(""):n:"","</").concat(t,">")}("iframe",{src:t,style:e||""})}function uh(t){var e,n=document.createElement("bili-comments-popup");if(t.mask&&(n.setAttribute("mask",""),!1!==t.maskClosable&&n.setAttribute("maskClosable","")),n.style.zIndex=(null!==(e=t.zIndex)&&void 0!==e?e:Nn()+2e3).toString(),t.title&&n.setAttribute("title",t.title),t.width){var i="";i="number"==typeof t.width?"".concat(t.width,"px"):t.width,n.setAttribute("width",i)}t.transparent&&n.setAttribute("transparent","true");var r=t.render();return"string"==typeof r?n.innerHTML=r:n.appendChild(r),document.body.appendChild(n),n}function dh(t){return uh({title:"",width:550,render:function(){return ch(sh(t),lh({"min-height":"550px"}))},mask:!0})}function hh(t){var e,n,i,r,o=document.createElement("bili-comment-report-form");o.dataset.type=String(t.type),o.dataset.oid=t.oid,o.dataset.rpid=t.rpid,o.dataset.mid=null!==(e=null==(i=t.member)?void 0:i.mid)&&void 0!==e?e:"",o.dataset.uname=null!==(n=null==(r=t.member)?void 0:r.uname)&&void 0!==n?n:"",o.dataset.ordering=t.ordering;var a=uh({title:"",width:520,mask:!0,maskClosable:!0,render:function(){return o}});o.addEventListener("hide",function(){a.parentElement&&a.parentElement.removeChild(a)})}function ph(){var t=document.createElement("bili-comment-update-uname-form"),e=uh({title:"",width:380,mask:!0,maskClosable:!0,render:function(){return t}});t.addEventListener("hide",function(){e.parentElement&&e.parentElement.removeChild(e)})}function fh(t){var e=document.createElement("bili-comment-commercial-order-appeal-form");e.dataset.type=String(t.type),e.dataset.oid=String(t.oid),e.dataset.rpid=t.rpid;var n=uh({title:"",width:520,mask:!0,maskClosable:!0,render:function(){return e}});e.addEventListener("hide",function(){n.parentElement&&n.parentElement.removeChild(n)})}function vh(t){var e=function(t,e){var n=document.createElement("bili-comments-webview");return n.setAttribute("iframe-src",t),e.width&&n.setAttribute("iframe-width","".concat(e.width,"px")),e.height&&n.setAttribute("iframe-height","".concat(e.height,"px")),e.onMessage&&(n.onmessage=e.onMessage),document.body.appendChild(n),function(){n.remove()}}(t,{width:700,height:460,onMessage:function(t){var n;"destroy-interactive-dialog"===(null==(n=t.data)?void 0:n.action)&&e()}});return e}var mh=function(){return s(function t(){o(this,t),this.target=null,this.events={}},[{key:"addEventListener",value:function(t,e){("undefined"==typeof window?"undefined":_(window))>"u"?console.warn("EventBridge is not supported in server side"):(this.events[t]?this.events[t].push(e):this.events[t]=[e],this.target&&this.target.addEventListener(t,e))}},{key:"removeEventListener",value:function(t,e){if(("undefined"==typeof window?"undefined":_(window))>"u")console.warn("EventBridge is not supported in server side");else if(this.target&&this.target.removeEventListener(t,e),this.events[t].length){var n=this.events[t];this.events[t]=n.filter(function(t){return t!==e})}}},{key:"connect",value:function(t){var e=this;this.target||t&&(this.target=t,Object.keys(this.events).forEach(function(n){e.events[n].forEach(function(e){t.addEventListener(n,e)})}))}},{key:"disconnect",value:function(){var t=this;if(this.target){var e=this.target;Object.keys(this.events).forEach(function(n){t.events[n].forEach(function(t){e.removeEventListener(n,t)})})}this.events={},this.target=null}}])}(),yh=function(){return s(function t(e){o(this,t),this.el={current:null},this.parent=null,this.props={},this.methods={},this.emits=[],this.dispose=null,this.eventBridge=new mh,e&&(this.props=e)},[{key:"engine",get:function(){return{core:"custom"}}},{key:"addEventListener",value:function(t,e){!this.emits.length||this.emits.includes(t)?this.eventBridge.addEventListener(t,e):console.warn("Event ".concat(String(t)," is not defined in emits"))}},{key:"removeEventListener",value:function(t,e){this.eventBridge.removeEventListener(t,e)}},{key:"dispatchAction",value:function(t){var e,n=t.type,i=t.args,r=t.callback,o=null==(e=this.methods)?void 0:e[n];if("function"==typeof o){var a=o.apply(void 0,k(i||[]));return null==r||r(a),a}console.warn("Action ".concat(String(n)," is undefined or not a function"))}},{key:"renderToString",value:function(){return""}},{key:"renderAsync",value:function(){var t=this;return new Promise(function(e){try{t.render(),e(!0)}catch(t){e(!1)}})}},{key:"update",value:function(t){var e=!!this.el.current,n=this.parent;return e&&this.unmount(),this.props=t,e&&(this.parent=n,this.render()),this}},{key:"mount",value:function(t,e){return this.el.current?(console.warn("Component is already mounted"),this):this.parent?(t===this.parent||console.warn("Component maybe in mounting, please wait mounted, and then use update or unmount first"),this):(this.parent=t,e?this.renderAsync():this.render(),this)}},{key:"unmount",value:function(){var t;if(null==(t=this.dispose)||t.call(this),this.eventBridge.disconnect(),this.props={},this.methods={},this.el.current){var e=this.parent||this.el.current.parentElement;e!==this.el.current&&null!=e&&e.contains(this.el.current)&&(e.removeChild(this.el.current),this.parent=null),this.el.current=null}}}])}();function bh(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function gh(t,e,n){return e=Ch(e),function(t,e){if(e&&("object"==_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Sh()?Reflect.construct(e,n||[],Ch(t).constructor):e.apply(t,n))}function wh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Ph(i.key),i)}}function kh(t,e,n){return e&&xh(t.prototype,e),n&&xh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ah(t,e){var n=("undefined"==typeof Symbol?"undefined":_(Symbol))<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return bh(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bh(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _h(t,e,n){return(e=Ph(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eh(){return Eh=("undefined"==typeof Reflect?"undefined":_(Reflect))<"u"&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Ch(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},Eh.apply(null,arguments)}function Ch(t){return Ch=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ch(t)}function Th(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oh(t,e)}function Sh(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Sh=function(){return!!t})()}function Oh(t,e){return Oh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Oh(t,e)}function Ph(t){var e=function(t){if("object"!=_(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_(e)?e:e+""}function Ih(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)}var Rh=function(){function t(){wh(this,t),this.disposables=[]}return kh(t,[{key:"addEventListener",value:function(t,e,n,i){return this.add(function(t,e,n,i){return t.addEventListener(e,n,i),function(){!function(t,e,n,i){t.removeEventListener(e,n,i)}(t,e,n,i)}}(t,e,n,i))}},{key:"mutationObserve",value:function(t,e,n){var i=!1,r=new MutationObserver(e);return r.observe(t,n),function(){i||(i=!0,r.disconnect())}}},{key:"requestAnimationFrame",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=requestAnimationFrame.apply(void 0,arguments);return this.add(function(){return cancelAnimationFrame(t)})})},{key:"nextFrame",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.requestAnimationFrame(function(){return t.requestAnimationFrame.apply(t,n)})}},{key:"setTimeout",value:function(t,e){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];var a=(n=window).setTimeout.apply(n,[t,e].concat(r));return this.add(function(){return clearTimeout(a)})}},{key:"microTask",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i,r={current:!0};return i=function(){r.current&&e[0]()},"function"==typeof queueMicrotask?queueMicrotask(i):Promise.resolve().then(i).catch(function(t){return setTimeout(function(){throw t})}),this.add(function(){r.current=!1})}},{key:"style",value:function(t,e,n){var i=t.style.getPropertyValue(e);return Object.assign(t.style,_h({},e,n)),this.add(function(){Object.assign(t.style,_h({},e,i))})}},{key:"group",value:function(e){var n=new t;return e(n),this.add(function(){return n.dispose()})}},{key:"add",value:function(t){var e=this;return this.disposables.push(t),function(){var n=e.disposables.indexOf(t);n>=0&&e.remove(n,1)}}},{key:"remove",value:function(t,e){var n,i=Ah(this.disposables.splice(t,null!=e?e:this.disposables.length));try{for(i.s();!(n=i.n()).done;)(0,n.value)()}catch(t){i.e(t)}finally{i.f()}}},{key:"dispose",value:function(){this.remove(0)}}])}();function jh(){return new Rh}var Dh=kh(function t(){wh(this,t)});Dh.nodeName="",Dh.attributes=[],Dh.create=function(t,e){if("#text"===t)return document.createTextNode(e.raw);var n=document.createElement(t),i=e.attributes;i&&Object.keys(i).forEach(function(t){var e=i[t];e&&n.setAttribute(t,e)});var r=e.data;return r&&Object.keys(r).forEach(function(t){var e=r[t];e&&n.setAttribute("data-".concat(t),e)}),n},Dh.from=function(t){return console.warn("RichNode.from is not implemented",t),null};var Nh={TEXT:"text",IMG:"img",BREAK:"break",HIGHLIGHT:"highlight",LINK:"link"},Mh=function(){function t(e){var n;return wh(this,t),(n=gh(this,t)).raw=e,n}return Th(t,Dh),kh(t,[{key:"block",get:function(){return!1}},{key:"rawValue",get:function(){return(this.raw.nodeValue||"").replace(new RegExp("","g"),"")}},{key:"length",get:function(){return this.rawValue.length}},{key:"getValue",value:function(){return{type:Nh.TEXT,raw:this.rawValue}}}],[{key:"create",value:function(t){return document.createTextNode(t)}}])}();Mh.nodeName="#text",Mh.from=function(t){return t.type!==Nh.TEXT?null:Mh.create(t.raw)};var Lh=function(){function t(e){var n;return wh(this,t),(n=gh(this,t)).raw=e,n}return Th(t,Dh),kh(t,[{key:"block",get:function(){return!0}},{key:"rawValue",get:function(){return this.raw.textContent||""}},{key:"length",get:function(){return this.rawValue.length}},{key:"getValue",value:function(){var t=Array.from(this.raw.classList),e={};return t.length&&(e.class=t[0]),{type:Nh.HIGHLIGHT,raw:this.rawValue,attributes:e,data:JSON.parse(JSON.stringify(this.raw.dataset))}}}])}();Lh.nodeName="SPAN",Lh.attributes=["class"],Lh.className="brt-hl",Lh.from=function(t){if(t.type!==Nh.HIGHLIGHT)return null;var e=Dh.create(Lh.nodeName,t);return e.setAttribute("contenteditable","false"),e.classList.add(Lh.className),e.textContent=t.raw,e},Lh.match=function(t){return t.nodeName===Lh.nodeName&&t.classList.contains(Lh.className)};var Bh=function(){function t(e){var n;return wh(this,t),(n=gh(this,t)).raw=e,n}return Th(t,Dh),kh(t,[{key:"block",get:function(){return!0}},{key:"rawValue",get:function(){return this.raw.getAttribute("alt")||""}},{key:"length",get:function(){return this.rawValue.length}},{key:"getValue",value:function(){return{type:Nh.IMG,raw:this.rawValue,attributes:{src:this.raw.src,alt:this.raw.alt,width:this.raw.width.toString(),height:this.raw.height.toString()}}}}])}();Bh.nodeName="IMG",Bh.attributes=["src","alt","width","height"],Bh.from=function(t){return t.type!==Nh.IMG?null:t.attributes?Bh.create(Bh.nodeName,t):null};var zh=function(){function t(e){var n;return wh(this,t),(n=gh(this,t)).raw=e,n}return Th(t,Dh),kh(t,[{key:"block",get:function(){return!0}},{key:"rawValue",get:function(){return this.raw.getAttribute("href")||""}},{key:"length",get:function(){return this.rawValue.length}},{key:"getValue",value:function(){return{type:Nh.LINK,raw:this.rawValue,data:JSON.parse(JSON.stringify(this.raw.dataset))}}}])}();zh.nodeName="A",zh.attributes=["href"],zh.from=function(t){if(t.type!==Nh.LINK)return null;var e=Dh.create(zh.nodeName,t);return e.setAttribute("contenteditable","false"),e.setAttribute("target","_blank"),e.textContent=t.raw,e};var Uh=function(){function t(e){var n;return wh(this,t),(n=gh(this,t)).raw=e,n}return Th(t,Dh),kh(t,[{key:"block",get:function(){return!0}},{key:"rawValue",get:function(){return t.value.raw}},{key:"length",get:function(){return this.rawValue.length}},{key:"getValue",value:function(){return t.value}}])}();Uh.nodeName="BR",Uh.from=function(t){return t.type!==Nh.BREAK?null:Dh.create(Uh.nodeName,t)},Uh.value={type:Nh.BREAK,raw:"\n"};var Fh,Vh,Hh,Wh,$h,Gh,qh,Xh,Zh,Yh,Qh,Kh,Jh,tp,ep,np,ip,rp,op,ap,sp,lp,cp=function(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(var r=0,o=n;r<o.length;r++){var a=o[r];if(t[a]!==e[a])return!1}return!0},up=function(t){return t.nodeType===Node.TEXT_NODE},dp=function(t){if(up(t))return new Mh(t);if("SPAN"===t.nodeName)return Lh.match(t)?new Lh(t):new Mh(Mh.create(t.textContent||""));switch(t.nodeName){case Mh.nodeName:return new Mh(t);case Bh.nodeName:return new Bh(t);case zh.nodeName:return new zh(t);case Uh.nodeName:return new Uh(t);default:return null}},hp=function(t){if(!t)return window.getSelection();var e=t.getRootNode();return e?e===document?window.getSelection():e.getSelection():window.getSelection()},pp=function(t,e){var n=[],i=e.start,r=e.end,o=t.textContent||"",a=o.slice(0,i),s=o.slice(r);if(o.slice(i,r).length!==o.length)if(a){if(t.textContent=a,n.push(t),s){var l=document.createTextNode(s);n.push(l)}}else t.textContent=s,n.push(t);return n},fp=function(t,e){var n=Array.from(t.childNodes),i=e.startOffset,r=i,o=e.endOffset,a=o;if(up(e.startContainer)){var s=e.startContainer;r=n.indexOf(s)}else i=0;if(up(e.endContainer)){var l=e.endContainer;a=n.indexOf(l)}else o=0;return{startIndex:r,startOffset:i,endIndex:a,endOffset:o,collapsed:e.collapsed}},vp=function(t,e){var n=Array.from(t.childNodes),i=e.startIndex,r=e.endIndex,o=e.collapsed,a=e.startOffset,s=e.endOffset,l=t,c=t,u=n[i],d=n[r];return u&&up(u)?l=u:a=i,d&&up(d)?c=d:s=r,{startContainer:l,endContainer:c,startOffset:a,endOffset:s,collapsed:o}},mp=function(t,e){var n=[];return t.forEach(function(t){var i=t.type;if(e){var r=e.get(t.type);if(r){var o=r.from(t);return void(o&&n.push(o))}}if(i!==Nh.BREAK)if(i!==Nh.TEXT)if(i!==Nh.HIGHLIGHT)if(i!==Nh.IMG){if(i===Nh.LINK){var a=zh.from(t);a&&n.push(a)}}else{var s=Bh.from(t);s&&n.push(s)}else{var l=Lh.from(t);l&&n.push(l)}else{var c=Mh.from(t);c&&n.push(c)}else{var u=Uh.from(t);u&&n.push(u)}}),n},yp=kh(function t(e){var n=this;if(wh(this,t),this.disposables=jh(),"TEXTAREA"!==e.tagName&&null===e.getAttribute("contenteditable"))throw new Error("TextareaAutoSize can only be used on textarea elements");this.element=e,this.verticalBorderSize=this.getStyleProp("borderTopWidth")+this.getStyleProp("borderBottomWidth")||0,this.disposables.addEventListener(this.element,"input",function(){n.update()}),this.update()},[{key:"destroy",value:function(){this.disposables.dispose(),this.element=null}},{key:"update",value:function(){var t=this.getStyleProp("fontSize");this.element.style.height="".concat(t,"px");var e=this.element.scrollHeight+this.verticalBorderSize;this.element.style.height="".concat(e,"px")}},{key:"getStyleProp",value:function(t){var e=getComputedStyle(this.element,null);return parseInt(e[t])}}]),bp=kh(function t(e){wh(this,t),this.stack=[],this.index=-1,this.editor=e.editor,this.depth=e.depth||50},[{key:"isLatest",value:function(){return-1===this.index||this.index===this.stack.length-1}},{key:"reset",value:function(){this.stack=[],this.index=-1}},{key:"record",value:function(t,e){this.isLatest()||this.stack.splice(this.index,this.stack.length-this.index);var n=e?fp(this.editor,e):null;this.stack.push({value:t,range:n}),this.stack.length>this.depth&&this.stack.shift(),this.index=this.stack.length-1}},{key:"undo",value:function(){if(0!==this.index)return this.index--,this.stack[this.index]}},{key:"redo",value:function(){if(!(this.index<0)&&this.index!==this.stack.length-1)return this.index++,this.stack[this.index]}}]),gp=function(t,e){return e===t.key&&(t.ctrlKey||t.metaKey)},wp=function(){function t(){var e;return wh(this,t),e=gh(this,t,arguments),Fh.add(e),e.disposables=jh(),e.autosize=null,e.history=null,e.historyRecording=!1,e.historyRecordTimer=null,e.isFoused=!1,e.range=null,e.content={nodes:[]},e.contentValue={raw:"",nodes:[]},e}return Th(t,yh),kh(t,[{key:"update",value:function(e){var n,i,r;return this.el.current?Ih(this,Fh,"m",lp).call(this,e):(n=t,i=this,r=Eh(Ch(1&3?n.prototype:n),"update",i),function(t){return r.apply(i,t)})([e]),this}},{key:"render",value:function(){var t,e=this;if(this.parent){var n=document.createElement("div");n.innerHTML=this.renderToString();var i=n.firstChild;this.el.current=i,this.placeholder=i.querySelector(".".concat(Ih(this,Fh,"m",Vh).call(this,"placeholder"))),Ih(this,Fh,"m",sp).call(this),this.eventBridge.connect(i);var r=this.editor;this.methods={focus:Ih(this,Fh,"m",Qh).bind(this),blur:Ih(this,Fh,"m",Kh).bind(this),setContent:function(t){Ih(e,Fh,"m",Yh).call(e,t);var n=Ih(e,Fh,"m",ep).call(e,r);Ih(e,Fh,"m",ip).call(e,n),setTimeout(function(){var t;null===(t=e.autosize)||void 0===t||t.update()})},insertNodes:function(t,n){var i;n&&(i=vp(r,n)),Ih(e,Fh,"m",np).call(e,t,i)}},this.parent.appendChild(this.el.current),this.dispose=function(){e.disposables.dispose()},this.history=new bp({editor:r,depth:null===(t=this.props.history)||void 0===t?void 0:t.maxDepth}),this.history.record(this.contentValue,this.range),this.props.autosize&&window.setTimeout(function(){e.autosize=new yp(r),e.disposables.add(function(){var t;null===(t=e.autosize)||void 0===t||t.destroy(),e.autosize=null})}),this.props.value&&Ih(this,Fh,"m",Yh).call(this,this.props.value)}}},{key:"renderAsync",value:function(){var t=this;return new Promise(function(e){t.render(),e(!0)})}},{key:"renderToString",value:function(){return'<div class="'.concat(Ih(this,Fh,"m",Vh).call(this,"root"),'">').concat(['<div class="'.concat(Ih(this,Fh,"m",Vh).call(this,"placeholder"),'">').concat(this.props.placeholder||"","</div>"),'<div class="'.concat(Ih(this,Fh,"m",Vh).call(this,"editor"),'" contenteditable="true"></div>')].join(""),"</div>")}}],[{key:"register",value:function(t,e){this.nodeMap.set(t,e)}}])}();Fh=new WeakSet,Vh=function(t){return"brt-".concat(t)},Hh=function(){if(this.editor){var t=function(t){var e=hp(t);if(!e)return null;var n=e.rangeCount>0?e.getRangeAt(0):null;return n?n.startContainer!==t&&n.startContainer.parentElement!==t?null:n:null}(this.editor);if(t){this.range=t;var e=function(t,e){var n=fp(t,e);return Object.assign(Object.assign({},n),{getBoundingClientRect:function(){return e.getBoundingClientRect?e.getBoundingClientRect():null}})}(this.editor,t);Ih(this,Fh,"m",Wh).call(this,"selection-change",e)}}},Wh=function(t,e){this.el.current&&function(t,e,n){t.dispatchEvent(new CustomEvent(e,{detail:n}))}(this.el.current,t,e)},$h=function(){if(this.editor&&this.el.current){var t,e,n=(t=Array.from(this.editor.childNodes||[]),e=[],t.forEach(function(t){var n=dp(t);n&&e.push(n)}),{nodes:e});this.content=n,this.contentValue=function(t){var e,n="",i=[],r=Ah(t.nodes);try{for(r.s();!(e=r.n()).done;){var o=e.value.getValue();n+=o.raw,i.push(o)}}catch(t){r.e(t)}finally{r.f()}return{raw:n,nodes:i}}(n);var i=Ih(this,Fh,"m",tp).call(this);this.placeholder&&(i?this.placeholder.style.setProperty("display","none"):this.placeholder.style.removeProperty("display")),i?Ih(this,Fh,"m",Wh).call(this,"change",Object.assign({},this.contentValue)):Ih(this,Fh,"m",Wh).call(this,"change",{raw:"",nodes:[]})}},Gh=function(t){Ih(this,Fh,"m",$h).call(this),Ih(this,Fh,"m",Hh).call(this),Ih(this,Fh,"m",ap).call(this,t)},qh=function(){this.autosize&&this.autosize.update()},Xh=function(){if(this.editor&&this.range){var t=this.range.getBoundingClientRect(),e=this.editor.getBoundingClientRect(),n=t.top-e.top,i=this.editor.scrollTop,r=n+i+t.height-e.height;r>0&&this.editor.scrollTo({top:i+r,behavior:"auto"})}},Zh=function(){var t=this;Ih(this,Fh,"m",qh).call(this),window.setTimeout(function(){Ih(t,Fh,"m",Xh).call(t)})},Yh=function(t){if(this.editor){var e=[];if(t.nodes)e=mp(t.nodes,wp.nodeMap);else if(t.raw){var n=Mh.from({type:"text",raw:t.raw});n&&e.push(n)}var i=this.editor;e.length?i.childNodes.length?function(t,e){for(var n,i,r,o=Array.from(t.childNodes||[]),a=Array.from(e),s=Math.max(o.length,a.length),l=0;l<s;l++){var c=a[l],u=o[l];if(u)if(c)if(c.nodeType===u.nodeType&&c.nodeName===u.nodeName)if(c.nodeType===Node.TEXT_NODE)c.textContent!==u.textContent&&(u.textContent=c.textContent);else{var d=dp(u),h=dp(c);if(d&&h){if(n=h,void 0,void 0,i=d.getValue(),r=n.getValue(),i.type===r.type&&i.raw===r.raw&&cp(i.attributes,r.attributes)&&cp(i.data,r.data))continue;t.replaceChild(c,u)}else if(d)t.removeChild(u);else{if(!h)continue;t.appendChild(c)}}else t.replaceChild(c,u);else t.removeChild(u);else t.appendChild(c)}}(i,e):e.forEach(function(t){i.appendChild(t)}):i.innerHTML="",Ih(this,Fh,"m",$h).call(this)}},Qh=function(){this.editor&&this.editor.focus()},Kh=function(){this.editor&&this.editor.blur()},Jh=function(){if(!this.editor)return!1;var t=this.range;if(!t)return!1;var e=t.endContainer;return e===this.editor?t.endOffset===this.editor.childNodes.length:e.parentElement===this.editor&&e===this.editor.childNodes[this.editor.childNodes.length-1]},tp=function(t){return t&&Ih(this,Fh,"m",$h).call(this),this.contentValue.raw.trim().length>0},ep=function(t){return{startContainer:t,startOffset:0,endContainer:t,endOffset:t.childNodes.length,collapsed:!0}},np=function(t,e){var n=this;if(this.editor){var i=this.editor,r=mp(t,wp.nodeMap);if(r.length){var o=e||this.range||Ih(this,Fh,"m",ep).call(this,i);if(o){Ih(this,Fh,"m",ap).call(this,!0),o=function(t,e){if(e.collapsed)return e;var n=Array.from(t.childNodes);if(e.startContainer===e.endContainer)if(up(e.startContainer)){var i=e.startContainer,r=i.textContent||"",o={start:e.startOffset,end:e.endOffset},a=pp(i,o);if(a.length)if(2===a.length)i.nextSibling?t.insertBefore(a[1],i.nextSibling):t.appendChild(a[1]),e={startContainer:i,startOffset:o.start,endContainer:i,endOffset:o.start,collapsed:!0};else{var s=o.end===r.length?o.start:0;e={startContainer:i,startOffset:s,endContainer:i,endOffset:s,collapsed:!0}}else{var l=Math.max(0,n.indexOf(i));i.remove(),e={startContainer:t,startOffset:l,endContainer:t,endOffset:l,collapsed:!0}}}else{var c=e,u=c.startOffset,d=c.endOffset;n.slice(u,d).forEach(function(t){return t.remove()}),e={startContainer:t,startOffset:u,endContainer:t,endOffset:u,collapsed:!0}}else{var h=e,p=h.startContainer,f=h.startOffset,v=h.endContainer,m=h.endOffset,y=up(p)?n.indexOf(p):f,b=up(v)?n.indexOf(v):m;if(up(p)){var g=p,w={start:f,end:(g.textContent||"").length},x=pp(g,w),k=Math.max(0,n.indexOf(g)-1);x.length?e={startContainer:g,startOffset:w.start,endContainer:g,endOffset:w.start,collapsed:!0}:(g.remove(),e={startContainer:t,startOffset:k,endContainer:t,endOffset:k,collapsed:!0})}if(up(v)){var A=v;if(pp(A,{start:0,end:m}).length){if(up(e.startContainer)){var _=e.startContainer,E=A.textContent||"";A.remove(),e.startContainer.textContent=(_.textContent||"")+E}}else A.remove()}b-y>1&&n.slice(y+1,b).forEach(function(t){return t.remove()})}return e}(i,o);var a=null,s=0,l=o.endContainer,c=Array.from(i.childNodes);if(l===i)a=c.length?c[o.endOffset]:null,s=o.endOffset;else if(up(l)){var u=l.textContent||"";if(0===o.endOffset)a=l;else if(o.endOffset===u.length)s=(a=l.nextSibling||null)?c.indexOf(a):c.length;else{var d=u.slice(0,o.endOffset),h=u.slice(o.endOffset),p=Mh.create(h);l.nextSibling?i.insertBefore(p,l.nextSibling):i.appendChild(p),l.textContent=d,a=p}}else a=l,s=o.endOffset;var f=r[r.length-1];if(r.forEach(function(t,e){if(a)i.insertBefore(t,a);else{if(up(t)&&i.lastChild){var n=i.lastChild;if(up(n))return n.textContent=(n.textContent||"")+(t.textContent||""),void(e===r.length-1&&(f=n))}i.appendChild(t)}}),up(f)){var v=f.length;Ih(this,Fh,"m",ip).call(this,{startContainer:f,startOffset:v,endContainer:f,endOffset:v,collapsed:!0})}else if(f.nextSibling&&up(f.nextSibling))Ih(this,Fh,"m",ip).call(this,{startContainer:f.nextSibling,startOffset:0,endContainer:f.nextSibling,endOffset:0,collapsed:!0});else{var m=s+r.length;Ih(this,Fh,"m",ip).call(this,{startContainer:i,startOffset:m,endContainer:i,endOffset:m,collapsed:!0})}window.setTimeout(function(){var t;null===(t=n.autosize)||void 0===t||t.update(),Ih(n,Fh,"m",Gh).call(n,!0)})}}}},ip=function(t){!function(t,e){var n=hp(e);if(!n)return console.warn("Selection is not found.");var i=document.createRange();i.setStart(t.startContainer,t.startOffset),t.collapsed?i.collapse(!0):(i.setEnd(t.endContainer,t.endOffset),i.collapse(!1)),n.removeAllRanges(),n.addRange(i)}(t,this.editor)},rp=function(){if(this.editor&&this.history){var t=this.editor,e=this.history.undo();e&&(Ih(this,Fh,"m",Yh).call(this,e.value),e.range&&Ih(this,Fh,"m",ip).call(this,vp(t,e.range)))}},op=function(){if(this.editor&&this.history){var t=this.editor,e=this.history.undo();e&&(Ih(this,Fh,"m",Yh).call(this,e.value),e.range&&Ih(this,Fh,"m",ip).call(this,vp(t,e.range)))}},ap=function(t){var e,n,i=this;if(this.history){if(t)this.historyRecordTimer&&(window.clearTimeout(this.historyRecordTimer),this.historyRecordTimer=null);else if(this.historyRecording)return;this.historyRecording=!0,this.history.record(this.contentValue,this.range),this.historyRecordTimer=window.setTimeout(function(){i.historyRecording=!1},null!==(n=null===(e=this.props.history)||void 0===e?void 0:e.recordInterval)&&void 0!==n?n:500)}},sp=function(){var t=this;if(this.el.current){var e=this.el.current.querySelector(".".concat(Ih(this,Fh,"m",Vh).call(this,"editor")));e.className=Ih(this,Fh,"m",Vh).call(this,"editor"),e.contentEditable="true",this.editor=e,this.el.current.appendChild(e),this.disposables.addEventListener(e,"blur",function(){t.isFoused=!1,Ih(t,Fh,"m",Wh).call(t,"focus-change",!1)}),this.disposables.addEventListener(e,"focus",function(){t.isFoused=!0,Ih(t,Fh,"m",Wh).call(t,"focus-change",!0)}),this.disposables.addEventListener(e,"input",function(){Ih(t,Fh,"m",Gh).call(t)}),this.disposables.addEventListener(e,"copy",function(){}),this.disposables.addEventListener(e,"cut",function(){}),this.disposables.addEventListener(e,"paste",function(e){e.stopPropagation(),e.preventDefault();var n=e.clipboardData;if(n){var i=n.getData("Text").trim().replace(/\r/g,"\n"),r=[],o=i.split("\n");o.length>1?o.forEach(function(t,e){r.push({type:"text",raw:t}),e<o.length-1&&r.push(Uh.value)}):r.push({type:"text",raw:i}),Ih(t,Fh,"m",np).call(t,r),Ih(t,Fh,"m",Zh).call(t)}}),this.disposables.addEventListener(e,"drop",function(t){t.preventDefault()}),this.disposables.addEventListener(e,"dragstart",function(t){t.preventDefault()}),this.disposables.addEventListener(e,"keydown",function(e){var n,i,r;e.stopPropagation();var o=e.key;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End"].includes(o))window.setTimeout(function(){Ih(t,Fh,"m",Hh).call(t)});else if(function(t){return gp(t,"a")}(e))window.setTimeout(function(){Ih(t,Fh,"m",Hh).call(t)},20);else{if(function(t){return gp(t,"z")&&!t.shiftKey}(e))return e.preventDefault(),void Ih(t,Fh,"m",rp).call(t);if(function(t){return gp(t,"z")&&t.shiftKey}(e))return e.preventDefault(),void Ih(t,Fh,"m",op).call(t);if(function(t){return"Enter"===t.key}(e))return e.preventDefault(),Ih(t,Fh,"m",Jh).call(t)?Ih(t,Fh,"m",np).call(t,[Uh.value,{type:Nh.TEXT,raw:""}]):Ih(t,Fh,"m",np).call(t,[Uh.value]),void Ih(t,Fh,"m",Zh).call(t);if(function(t){return"Backspace"===t.key}(e)&&null!==(n=t.range)&&void 0!==n&&n.endContainer&&up(t.range.endContainer)){var a=t.range.endContainer;1===a.length&&""===a.nodeValue&&(null===(i=a.previousSibling)||void 0===i?void 0:i.nodeName)===Uh.nodeName&&(null===(r=a.previousSibling)||void 0===r||r.remove())}}}),this.disposables.addEventListener(e,"keyup",function(t){t.stopPropagation()}),this.disposables.addEventListener(e,"mousedown",function(){}),this.disposables.addEventListener(document,"mouseup",function(){Ih(t,Fh,"m",Hh).call(t)})}},lp=function(t){var e=t.placeholder,n=t.value;e&&this.props.placeholder&&e!==this.props.placeholder&&(this.props.placeholder=e,this.placeholder&&(this.placeholder.textContent=e)),n&&n!==this.contentValue&&(this.props.value=n,Ih(this,Fh,"m",Yh).call(this,n))},wp.nodeMap=new Map,wp.NodeType=Nh,wp.isSupportShadowDOM=function(){return("undefined"==typeof window?"undefined":_(window))<"u"&&void 0!==ShadowRoot.prototype.getSelection};var xp=function(){var t=i(m().m(function t(){return m().w(function(t){for(;;)if(0===t.n)return t.a(2,ni("//s1.hdslb.com/bfs/static/jinkela/long/growup/risk-control-captcha.js",{lib:"RiskControlCaptcha"}))},t)}));return function(){return t.apply(this,arguments)}}(),kp=function(){var t=i(m().m(function t(e){var n,i;return m().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,xp();case 1:return n=t.v,i=n.verify,t.n=2,i(e);case 2:return t.a(2,t.v.token)}},t)}));return function(e){return t.apply(this,arguments)}}(),Ap=Object.defineProperty,_p=Object.getOwnPropertyDescriptor,Ep=function(t,e,n,i){for(var r,o=i>1?void 0:i?_p(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Ap(e,n,o),o},Cp=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.spmPrefix="",t.oid="",t.type=0,t.mode=3,t.reply=null,t.user=null,t.avatarSize=48,t.keepActive=!1,t.useRichTextarea="function"==typeof ShadowRoot.prototype.getSelection,t.active=!1,t.activeToggleTimer=0,t.defaultInputValue="",t.inputValue="",t.nodes=[],t.placeholder="",t.voteOption=null,t.scrollContainer=null,t.pubBtnText="",t.uploadPicState=1,t.goodsState=3,t.goodsIds="",t.voteOptionHidden=!1,t.syncToDynamic=!1,t.showEmojiPicker=!1,t.mountEmojiPicker=!1,t.pics=[],t.mentionMap={},t.mentionText="",t.mentionDisabled=!1,t.trackObserver=null,t}return h(e,t),s(e,[{key:"cmGoodsEventId",get:function(){return"cm_goods_comments"}},{key:"hasContent",get:function(){return!!this.inputValue||this.pics.length>0||this.syncToDynamic}},{key:"uploadImgExts",get:function(){return["jpg","jpeg","png"]}},{key:"addNamespace",get:function(){return this.reply?Fu:Uu}},{key:"showPicBtn",get:function(){return this.addNamespace===Uu&&3!==this.uploadPicState}},{key:"showGoodsBtn",get:function(){return!(this.addNamespace!==Uu||!this.useRichTextarea)&&3!==this.goodsState}},{key:"showSyncToDynamic",get:function(){return this.addNamespace===Uu}},{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),this.nodes.length?this.updateState():this.inputValue=this.defaultInputValue,setTimeout(function(){var e,n,i,r,o,a,s;t.biliAvatar.load(Hd({face:(null==(n=t.user)?void 0:n.face)||"",mid:(null==(i=t.user)?void 0:i.mid)||0,pendant:(null==(r=t.user)?void 0:r.pendant)||"",vip:null==(o=t.user)?void 0:o.vip,official:null==(a=t.user)?void 0:a.official,nft:null!==(e=null==(s=t.user)?void 0:s.face_nft_type)&&void 0!==e?e:0}),{baseSize:t.avatarSize,isFloat:!0})}),this.disposables.addEventListener(document.documentElement,"click",function(e){"none"!==t.style.getPropertyValue("--bili-comment-box-display")&&e.composedPath&&(e.composedPath().includes(t.shadowRoot)||t.handleDeactive())},!0),this.trackObserver=new Zd({el:this,type:"show",value:{event:"comment_box.all",data:{type:this.type,oid:this.oid,version:"v2",tools:JSON.stringify({pic:this.showPicBtn?1:0,goods:this.showGoodsBtn?1:0})}},handler:function(e,n,i){"show"===e&&(t.trackReport(e,n,i),t.showGoodsBtn&&t.trackReportGoods("show"))}}),this.disposables.add(function(){t.trackObserver&&(t.trackObserver.dispose(),t.trackObserver=null)})}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose()}},{key:"trackReport",value:function(t,e,n){Wu(t,e,n,{spmPrefix:this.spmPrefix})}},{key:"handleFocusChange",value:function(t){t.detail&&this.handleActive()}},{key:"handleActive",value:function(){var t=this,e={type:this.type,oid:this.oid,position:this.addNamespace===Uu?1:3};Vu("replyInputClick",e),this.trackReport("click","comment_box.textarea.click",e),this.active||this.voteOption&&this.voteOptionHidden&&(this.voteOptionHidden=!1),this.toggleActive(!0,20),this.useRichTextarea?setTimeout(function(){t.mentionDisabled?t.mentionPopover.refresh(null):t.handleMentionStart(t.richTextarea.getSelection())},200):this.handleRawMentionStart(this.textarea.getSelection())}},{key:"handleDeactive",value:function(){this.keepActive||(this.mentionPopover.refresh(null),this.showEmojiPicker=!1,!this.hasContent&&this.toggleActive(!1,0))}},{key:"toggleActive",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;this.activeToggleTimer&&(window.clearTimeout(this.activeToggleTimer),this.activeToggleTimer=0),this.activeToggleTimer=window.setTimeout(function(){e.active=t},n)}},{key:"handleFocusInput",value:function(){var t=this;window.setTimeout(function(){t.focus()},20)}},{key:"handleRawInputChange",value:function(t){this.inputValue=t.detail}},{key:"handleRawMentionStart",value:function(t){if(!this.showEmojiPicker){var e=t.start;if(e===t.end){var n=this.inputValue.slice(0,e),i=Wd(n);if(null!==i){this.mentionText=i;var r=this.getBoundingClientRect(),o=window.innerHeight;this.scrollContainer&&this.scrollContainer!==document.body&&(o=this.scrollContainer.getBoundingClientRect().height),o<r.y+325?(this.mentionPopover.style.top="",this.mentionPopover.style.bottom="".concat(r.height,"px"),this.mentionPopover.style.setProperty("--max-content-height","160px")):(this.mentionPopover.style.removeProperty("--max-content-height"),this.mentionPopover.style.bottom="",this.mentionPopover.style.top="32px"),this.mentionPopover.style.zIndex="".concat(Nn())}if(this.mentionPopover.refresh(i),null!==i){var a={oid:this.oid,type:this.type};Hu("show","comment.at_recomlist",a),this.trackReport("show","comment_box.mention_popover.show",a)}}}}},{key:"updateState",value:function(t){t&&(this.nodes=t);var e="",n=[],i={};this.nodes.forEach(function(t){var r;switch(t.type){case wp.NodeType.IMG:e+=t.raw;break;case wp.NodeType.HIGHLIGHT:if(null!=(r=t.data)&&r.type){if("mention"===t.data.type){e+=t.raw,i[t.data.uname]=Number(t.data.uid);break}if("goods"===t.data.type){e+=t.data.goods_url,n.push(t.data.goods_id);break}}else e+=t.raw;break;case wp.NodeType.TEXT:default:e+=t.raw}}),this.inputValue=e,this.mentionMap=i,this.goodsIds=n.join(",")}},{key:"handleInputChange",value:function(t){this.updateState(t.detail.nodes)}},{key:"handleMentionStart",value:function(t){if(!this.showEmojiPicker){var e=t.collapsed,n=t.startIndex,i=t.startOffset;if(e){var r=this.nodes[n];if(r){if("text"===r.type){var o=r.raw.slice(0,i),a=Wd(o);if(null!==a){this.mentionText=a;var s=this.getBoundingClientRect(),l=window.innerHeight;this.scrollContainer&&this.scrollContainer!==document.body&&(l=this.scrollContainer.getBoundingClientRect().height),l<s.y+325?(this.mentionPopover.style.top="",this.mentionPopover.style.bottom="".concat(s.height,"px"),this.mentionPopover.style.setProperty("--max-content-height","160px")):(this.mentionPopover.style.removeProperty("--max-content-height"),this.mentionPopover.style.bottom="",this.mentionPopover.style.top="32px"),this.mentionPopover.style.zIndex="".concat(Nn())}if(this.mentionPopover.refresh(a),null!==a){var c={oid:this.oid,type:this.type};Hu("show","comment.at_recomlist",c),this.trackReport("show","comment_box.mention_popover.show",c)}}}else this.mentionPopover.refresh(null)}}}},{key:"handleMentionEnd",value:function(t){var e=this,n=t.detail,i=n.name,r=n.mid,o=this.mentionText;if(this.useRichTextarea){var a=this.richTextarea.getSelection(),s="@".concat(i),l={startIndex:a.startIndex,startOffset:a.startOffset-o.length-1,endIndex:a.startIndex,endOffset:a.startOffset,collapsed:!1};this.richTextarea.insertNodes([{type:wp.NodeType.HIGHLIGHT,raw:s,attributes:{class:"mention"},data:{type:"mention",uname:i,uid:String(r)}}],l),this.mentionDisabled=!0,window.setTimeout(function(){e.mentionDisabled=!1},300)}else{var c=this.textarea.getSelection();this.textarea.insertText("@".concat(i," "),{start:c.start-o.length-1,end:c.end}),this.mentionMap[i]=r}this.mentionText="";var u={oid:this.oid,type:this.type,mid:r};Hu("click","comment.at_recomlist",u),this.trackReport("click","comment_box.mention_popover.show",u)}},{key:"handleRawSelectionChange",value:function(t){this.handleRawMentionStart(t.detail)}},{key:"handleSelectionChange",value:function(t){this.handleMentionStart(t.detail)}},{key:"handleHideVoteOption",value:function(t){t.stopPropagation(),this.voteOptionHidden=!0}},{key:"handleReset",value:function(){var t,e;this.picturesUpload.reset(),this.syncToDynamic&&(this.syncToDynamic=!1),this.useRichTextarea?this.richTextarea.reset():(this.inputValue="",this.mentionMap={},this.textarea&&(null==(e=(t=this.textarea).reset)||e.call(t))),this.toggleActive(!1),this.addNamespace===Fu&&Bu.emit("hideReply")}},{key:"handleTool",value:function(t,e){var n=this;e.stopPropagation();var i={tool_type:t,type:this.type,oid:this.oid,position:this.addNamespace===Uu?1:3};if(this.trackReport("click","comment_box.tool.click",i),"emoji"!==t){if(this.showEmojiPicker=!1,"mention"===t)return Hu("click","comment.at_button",i),void setTimeout(function(){n.useRichTextarea?n.richTextarea.insertText("@"):n.textarea.insertText("@")});"pic"!==t?"goods"===t&&(this.trackReportGoods("click"),function(t){var e={"event-id":t.eventId,"data-select-ids":t.selectIds,"source-from":"1","content-oid":t.contentOid};t.spmIdFrom&&(e["spm-id-from"]=t.spmIdFrom);var n=document.createElement("bili-cm-goods");Object.keys(e).forEach(function(t){n.setAttribute(t,e[t])});var i=Rn();i.addEventListener(n,"confirm",function(e){t.onConfirm(e.detail),i.dispose()}),i.addEventListener(n,"cancel",function(){t.onCancel(),i.dispose()});var r=uh({title:"",width:"auto",zIndex:1e4,render:function(){return n}});i.add(function(){r.remove()})}({eventId:this.cmGoodsEventId,selectIds:this.goodsIds,contentOid:"".concat(this.type,"_").concat(this.oid),onConfirm:function(t){var e=[],i=n.nodes.filter(function(e){var n;if(e.type===wp.NodeType.HIGHLIGHT&&"goods"===(null==(n=e.data)?void 0:n.type)){var i=e.data.goods_id;return t.findIndex(function(t){return t.itemIdStr===i})>-1}return!0});t.forEach(function(t){if(-1===i.findIndex(function(e){var n;return e.type===wp.NodeType.HIGHLIGHT&&"goods"===(null==(n=e.data)?void 0:n.type)&&e.data.goods_id===t.itemIdStr})){var n={type:wp.NodeType.HIGHLIGHT,raw:t.name,attributes:{class:"goods"},data:{type:"goods",goods_url:t.shortUrl||t.jumpUrl,goods_id:t.itemIdStr}};e.push(n,{type:wp.NodeType.TEXT,raw:" "})}}),n.richTextarea.reset([].concat(k(i),e))},onCancel:function(){console.log("cancel")}})):this.handleUploadPic()}else{if(Vu("replyEmojiClick",i),!this.mountEmojiPicker&&!this.showEmojiPicker&&(this.mountEmojiPicker=!0),this.showEmojiPicker=!this.showEmojiPicker,this.showEmojiPicker){this.emojiPopover.style.zIndex="".concat(Nn());var r=this.getBoundingClientRect().bottom;window.innerHeight-r<300?(this.emojiPopover.style.removeProperty("bottom"),this.emojiPopover.style.setProperty("top","0"),this.emojiPopover.style.setProperty("transform","translateY(-100%)")):(this.emojiPopover.style.removeProperty("top"),this.emojiPopover.style.setProperty("bottom","0"),this.emojiPopover.style.setProperty("transform","translateY(100%)"))}this.useRichTextarea?this.richTextarea.focus():this.textarea.focus()}}},{key:"trackReportGoods",value:function(t){var e;this.trackReport(t,"comment_box.tool_goods.".concat(t),{mid:(null==(e=this.user)?void 0:e.mid)||0,source_from:1,content_oid:"".concat(this.type,"_").concat(this.oid)})}},{key:"handleUploadPic",value:function(){this.picturesUpload.trigger()}},{key:"handlePicsChange",value:(l=i(m().m(function t(e){return m().w(function(t){for(;;)switch(t.n){case 0:try{this.pics=k(e.detail)}catch(t){iu(t.message)}case 1:return t.a(2)}},t,this)})),function(t){return l.apply(this,arguments)})},{key:"handleSelectEmoji",value:function(t){var e=this;setTimeout(function(){var n=t.detail,i=n.type,r=n.webp_url,o=n.gif_url,a=n.url,s=n.text;e.useRichTextarea?4===i?e.richTextarea.insertNodes([{type:wp.NodeType.TEXT,raw:s}]):e.richTextarea.insertNodes([{type:wp.NodeType.IMG,raw:s,attributes:{src:Ei.getBmgSrcNext(r||o||a,{w:20,h:20}),alt:s,width:"20",height:"20"}}]):e.textarea.insertText(t.detail.text)})}},{key:"handleSyncToDynamicChange",value:function(t){this.syncToDynamic=t.detail.checked}},{key:"handlePublish",value:(a=i(m().m(function t(e){var n,i;return m().w(function(t){for(;;)switch(t.n){case 0:if(e.stopPropagation(),this.showEmojiPicker=!1,this.inputValue){t.n=1;break}return iu(""),t.a(2);case 1:return n={plat:1,oid:this.oid,type:this.type,message:""},i=this.inputValue,this.reply&&(this.reply.root?(n.root=this.reply.root_str,n.parent=this.reply.rpid_str,this.placeholder&&(i="".concat(this.placeholder).concat(i))):(n.root=this.reply.rpid_str,n.parent=n.root)),n.message=i,this.voteOption&&!this.voteOptionHidden&&(n.has_vote_option=!0),Object.keys(this.mentionMap)&&(n.at_name_to_mid=this.mentionMap),this.pics.length&&(n.pictures=this.pics),this.syncToDynamic&&(n.sync_to_dynamic=1),t.n=2,this.doPublishRequest(n);case 2:return t.a(2)}},t,this)})),function(t){return a.apply(this,arguments)})},{key:"doPublishRequest",value:(n=i(m().m(function t(e){var n,i,r,o,a,s,l,c,u,d,h,p,f,y,b=this;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return n=0,t.p=1,t.n=2,gd(e);case 2:if(i=t.v,r=i.code,o=i.data,a=i.message,0===r&&o){t.n=8;break}f=r,t.n=12015===f?3:12074===f?4:61001===f?5:6;break;case 3:return null!=o&&o.need_captcha_v2&&(n=3),t.a(3,7);case 4:return n=1,t.a(3,7);case 5:return n=2,t.a(3,7);case 6:return t.a(3,7);case 7:throw new Error(a||"");case 8:if(iu(o.success_toast||""),Bu.emit("add",{namespaces:[this.addNamespace],method:this.addNamespace===Uu?"unshift":"push",value:o.reply}),this.handleReset(),o.easter_egg&&(s=o.easter_egg,l=s.resource,c=s.jump_url,Bu.emit("displayAlphaVideo",{src:l,jumpUrl:c})),u={spmid:this.spmPrefix||vi()},this.reply){if(d="","string"==typeof this.reply.track_info)try{null!=(h=JSON.parse(this.reply.track_info))&&h.track_id&&(d=h.track_id)}catch(t){}u.track_id=d}p=v({type:this.type,oid:this.oid,root:e.root,parent:e.parent,ordering:3===this.mode?"heat":"time",position:this.addNamespace===Uu?1:3},u),Vu("reply-send-click",p),Vu("replySendClick",p),this.trackReport("click","comment_box.pub_btn.click",p),t.n=13;break;case 9:if(t.p=9,y=t.v,1!==n){t.n=10;break}return ph(),t.a(2);case 10:if(2!==n){t.n=11;break}return Qd({title:"",message:"",cancel:!1,confirm:function(){window.open("//passport.bilibili.com/account/security#/bindphone/unverify/set")}}),t.a(2);case 11:if(3!==n){t.n=12;break}return kp({verifyMethod:"biliword",verifyRelation:"0",extraInfo:{type:this.type,page:e.root?"detail":"list",ordering:3===this.mode?"heat":"time"},biz:"reply",theme:"primary"}).then(function(t){b.doPublishRequest(v(v({},e),{},{code_v2:t}))}).catch(function(){iu(",~")}),t.a(2);case 12:iu(y.message);case 13:return t.a(2)}},t,this,[[1,9]])})),function(t){return n.apply(this,arguments)})},{key:"focus",value:function(){this.useRichTextarea?this.richTextarea.focus():this.textarea.focus()}},{key:"blur",value:function(){this.useRichTextarea?this.richTextarea.blur():this.textarea.blur()}},{key:"voteOptionTemplate",value:function(){return Qe(As||(As=x(['<div\n      id="vote-option"\n      class="','"\n    >\n      <bili-comment-vote-option .data=',"></bili-comment-vote-option>\n      <bili-icon @click=",' size="12" icon="BDC/xmark_close_circle_fill/1"></bili-icon>\n    </div>'])),this.voteOptionHidden?Ta({hidden:!0}):"",this.voteOption,this.handleHideVoteOption)}},{key:"render",value:function(){var t=this;return Qe(_s||(_s=x(['\n      <div id="user-avatar">\n        <bili-avatar></bili-avatar>\n      </div>\n      <div id="comment-area">\n        <div\n          id="emoji-popover"\n          style=',"\n        >\n          ",'\n        </div>\n        <div id="body">\n          <div\n            id="editor"\n            class=',"\n            @click=","\n          >\n            ","\n            ","\n\n            <bili-comment-pictures-upload .accept="," @change=",'></bili-comment-pictures-upload>\n          </div>\n        </div>\n        <div\n          id="footer"\n          class=','\n        >\n          <button class="tool-btn emoji" @click=','>\n            <bili-icon icon="BDC/emoji_circle_line/1" size="16"></bili-icon>\n          </button>\n          <button\n            class="tool-btn mention"\n            @click=','\n          >\n            <bili-icon icon="BDC/at_line/1" size="16"></bili-icon>\n          </button>\n          <bili-comment-mention-popover @select=',"></bili-comment-mention-popover>\n          ","\n          ","\n          ",'\n          <div id="pub">\n            <button\n              class=','\n              data-v-risk="fingerprint"\n              @click=',"\n            >\n              ","\n            </button>\n          </div>\n        </div>\n      </div>\n    "])),Zn({display:this.showEmojiPicker?"block":"none"}),this.mountEmojiPicker?Qe(Es||(Es=x(["<bili-emoji-picker @select=","></bili-emoji-picker>"])),this.handleSelectEmoji):"",this.keepActive||this.active?Ta({active:!0}):"",this.handleFocusInput,this.voteOption?this.voteOptionTemplate():"",this.useRichTextarea?Qe(Cs||(Cs=x(["<bili-comment-rich-textarea\n                  .defaultValue=","\n                  .nodes=","\n                  .placeholder=","\n                  @change=","\n                  @focus-change=","\n                  @selection-change=","\n                ></bili-comment-rich-textarea>"])),this.defaultInputValue,this.nodes,this.placeholder,this.handleInputChange,this.handleFocusChange,this.handleSelectionChange):Qe(Ts||(Ts=x(["\n                  <bili-comment-textarea\n                    .value=","\n                    .placeholder=","\n                    @focus=","\n                    @change=","\n                    @selection-change=","\n                  ></bili-comment-textarea>\n                "])),this.defaultInputValue,this.placeholder,this.handleActive,this.handleRawInputChange,this.handleRawSelectionChange),this.uploadImgExts,this.handlePicsChange,Ta({hidden:!this.keepActive&&!this.active}),function(e){return t.handleTool("emoji",e)},function(e){t.handleTool("mention",e)},this.handleMentionEnd,this.showPicBtn?Qe(Ss||(Ss=x(['<button\n                class="','"\n                @click=','\n              >\n                <bili-icon icon="BDC/image_line/3" size="16"></bili-icon>\n              </button>'])),Ta({"tool-btn":!0,disabled:2===this.uploadPicState}),function(e){2!==t.uploadPicState&&t.handleTool("pic",e)}):"",this.showGoodsBtn?Qe(Os||(Os=x(['<button\n                class="','"\n                @click=','\n              >\n                <bili-icon icon="BDC/bag_commodity_line/2" size="16"></bili-icon>\n              </button>'])),Ta({"tool-btn":!0,disabled:2===this.goodsState}),function(e){2!==t.goodsState&&t.handleTool("goods",e)}):"",this.showSyncToDynamic?Qe(Ps||(Ps=x(['<div id="optional">\n                <bili-checkbox\n                  checked=','\n                  value="sync"\n                  label=""\n                  @change=',"\n                ></bili-checkbox>\n              </div>"])),this.syncToDynamic,this.handleSyncToDynamicChange):"",Ta({active:!!this.inputValue}),this.handlePublish,this.pubBtnText)}}]);var n,a,l}(gn);Cp.styles=we(Is||(Is=x(["\n    :host {\n      --bili-comment-box-display: flex;\n      display: var(--bili-comment-box-display);\n    }\n\n    #user-avatar {\n      flex-shrink: 0;\n      width: 80px;\n      height: 50px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #user-avatar img {\n      border-radius: 50%;\n    }\n    #comment-area {\n      position: relative;\n      width: calc(100% - 80px);\n    }\n    #emoji-popover {\n      position: absolute;\n      left: 0;\n    }\n\n    #body {\n      width: 100%;\n      transition: height 0.2s;\n    }\n    #editor {\n      width: 100%;\n      padding: 8px 0;\n      border: 1px solid var(--Ga1);\n      box-sizing: border-box;\n      border-radius: 6px;\n      background-color: var(--bg3);\n      transition: 0.2s;\n      cursor: text;\n    }\n    #editor:hover,\n    #editor.active {\n      background-color: var(--bg1);\n      border-color: var(--graph_weak);\n    }\n    #editor.active #vote-option {\n      display: flex;\n    }\n    #editor #vote-option {\n      display: none;\n      padding: 0 8px;\n      align-items: center;\n      margin-bottom: 4px;\n    }\n    #editor #vote-option.hidden {\n      display: none;\n    }\n    #editor #vote-option bili-comment-vote-option {\n      margin-right: 4px;\n    }\n    #editor #vote-option bili-icon {\n      color: var(--text4);\n      cursor: pointer;\n    }\n    #editor bili-comment-pictures-upload {\n      margin-top: 8px;\n    }\n    bili-comment-mention-popover {\n      left: 38px;\n      z-index: 2;\n    }\n    #pub {\n      height: 32px;\n      width: 70px;\n      margin-left: auto;\n    }\n    #pub button {\n      cursor: pointer;\n      border-radius: 4px;\n      outline: none;\n      border: none;\n      width: 100%;\n      height: 100%;\n      font-size: 16px;\n      color: var(--text_white);\n      background-color: rgba(var(--brand_blue_rgb), 0.5);\n    }\n    #pub button:hover,\n    #pub button.active {\n      background-color: var(--brand_blue);\n    }\n\n    #footer {\n      position: relative;\n      margin-top: 10px;\n      display: flex;\n      align-items: center;\n    }\n\n    #footer.hidden {\n      display: none;\n    }\n\n    #footer #optional bili-checkbox {\n      transform: scale(0.8);\n    }\n    #footer #optional bili-checkbox label {\n      margin-left: 6px;\n    }\n\n    /* slot  */\n    #footer bili-popover > * {\n      display: none;\n    }\n\n    .tool-btn {\n      outline: none;\n      border: none;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      position: relative;\n      width: 32px;\n      height: 26px;\n      border: 1px solid var(--Ga1);\n      background-color: var(--bg1);\n      border-radius: 4px;\n      color: var(--text2);\n      cursor: pointer;\n      margin-right: 6px;\n    }\n    .tool-btn.disabled {\n      color: var(--text4);\n      cursor: not-allowed;\n    }\n  "]))),Ep([kn()],Cp.prototype,"spmPrefix",2),Ep([kn()],Cp.prototype,"oid",2),Ep([kn()],Cp.prototype,"type",2),Ep([kn()],Cp.prototype,"mode",2),Ep([kn()],Cp.prototype,"reply",2),Ep([kn()],Cp.prototype,"user",2),Ep([kn({type:Boolean})],Cp.prototype,"keepActive",2),Ep([An()],Cp.prototype,"useRichTextarea",2),Ep([An()],Cp.prototype,"active",2),Ep([kn({type:String})],Cp.prototype,"defaultInputValue",2),Ep([An()],Cp.prototype,"inputValue",2),Ep([kn({type:String})],Cp.prototype,"placeholder",2),Ep([kn({type:Object})],Cp.prototype,"voteOption",2),Ep([kn()],Cp.prototype,"scrollContainer",2),Ep([kn({type:String})],Cp.prototype,"pubBtnText",2),Ep([kn()],Cp.prototype,"uploadPicState",2),Ep([kn()],Cp.prototype,"goodsState",2),Ep([An()],Cp.prototype,"voteOptionHidden",2),Ep([An()],Cp.prototype,"syncToDynamic",2),Ep([An()],Cp.prototype,"showEmojiPicker",2),Ep([An()],Cp.prototype,"mountEmojiPicker",2),Ep([An()],Cp.prototype,"pics",2),Ep([An()],Cp.prototype,"hasContent",1),Ep([An()],Cp.prototype,"uploadImgExts",1),Ep([An()],Cp.prototype,"addNamespace",1),Ep([An()],Cp.prototype,"showPicBtn",1),Ep([An()],Cp.prototype,"showGoodsBtn",1),Ep([An()],Cp.prototype,"showSyncToDynamic",1),Ep([Cn("bili-avatar")],Cp.prototype,"biliAvatar",2),Ep([Cn("#editor bili-comment-rich-textarea")],Cp.prototype,"richTextarea",2),Ep([Cn("#editor bili-comment-textarea")],Cp.prototype,"textarea",2),Ep([Cn("#emoji-popover")],Cp.prototype,"emojiPopover",2),Ep([Cn("bili-comment-mention-popover")],Cp.prototype,"mentionPopover",2),Ep([Cn("#editor bili-comment-pictures-upload")],Cp.prototype,"picturesUpload",2),Cp=Ep([xn("bili-comment-box")],Cp);var Tp=function(t){return cu.request({url:"/x/v2/reply/at",params:v({},t)})},Sp=Object.defineProperty,Op=Object.getOwnPropertyDescriptor,Pp=function(t,e,n,i){for(var r,o=i>1?void 0:i?Op(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Sp(e,n,o),o},Ip=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).keyword="",t.groups=[],t}return h(e,t),s(e,[{key:"handleVisible",value:function(t){this.style[t?"setProperty":"removeProperty"]("display","flex")}},{key:"refresh",value:(n=i(m().m(function t(e){var n,i,r,o;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.groups=[],null!==e){t.n=1;break}return this.keyword="",this.handleVisible(!1),t.a(2);case 1:return this.keyword=e,t.p=2,t.n=3,Tp({keyword:e});case 3:n=t.v,i=n.code,r=n.data,0===i&&null!=r&&r.groups&&(this.groups=r.groups),t.n=5;break;case 4:t.p=4,o=t.v,console.error(o);case 5:this.handleVisible(!0);case 6:return t.a(2)}},t,this,[[2,4]])})),function(t){return n.apply(this,arguments)})},{key:"handleSelect",value:function(t){var e=t.target.dataset,n=Number(e.group),i=Number(e.item);if(!isNaN(n)&&!isNaN(i)){var r=this.groups[n].items[i];r&&this.dispatchEvent(new CustomEvent("select",{detail:{mid:r.mid,name:r.name}}))}}},{key:"renderKeywordName",value:function(t){if(this.keyword){var e=t.indexOf(this.keyword);if(e>-1)return Qe(Rs||(Rs=x(["","<em>","</em>",""])),t.slice(0,e),this.keyword,t.slice(e+this.keyword.length))}return Qe(js||(js=x(["",""])),t)}},{key:"renderCountDesc",value:function(t){return"".concat(function(t,e){var n=parseInt(t,10);return Number.isNaN(n)||n<0?"":n>=1e4&&n<1e8?(n/1e4).toFixed(1)+(e?"":""):n>=1e8?(n/1e8).toFixed(1)+(e?"":""):/\./.test(t)?t:n}(t),"")}},{key:"itemTemplate",value:function(t,e,n){return Qe(Ds||(Ds=x(['<li class="item" data-group="','" data-item="','" @click=','>\n      <div class="item-avatar">\n        <img\n          src="','"\n        />\n      </div>\n      <div class="item-info">\n        <div class="item-name">','</div>\n        <div class="item-desc">',"</div>\n      </div>\n    </li>"])),n,e,this.handleSelect,Ei.getBmgSrcNext(t.face,{w:36,h:36,dpr:2}),this.renderKeywordName(t.name),this.renderCountDesc(t.fan))}},{key:"render",value:function(){var t=this;return Qe(Ns||(Ns=x(['<div id="title">@</div>\n      ',""])),this.groups.length?Qe(Ms||(Ms=x(['<div id="content">\n            ',"\n          </div>"])),this.groups.map(function(e,n){return Qe(Ls||(Ls=x(['<div class="group">\n                <div class="group-name">','</div>\n                <ul class="group-items">\n                  ',"\n                </ul>\n              </div>"])),e.group_name,e.items.map(function(e,i){return t.itemTemplate(e,i,n)}))})):"")}}]);var n}(gn);Ip.styles=we(Bs||(Bs=x(["\n    :host {\n      --max-content-height: 282px;\n      position: absolute;\n      display: none;\n      flex-direction: column;\n      width: 219px;\n      border: 1px solid var(--graph_bg_thick);\n      border-radius: 6px;\n      font-size: 12px;\n      background-color: var(--bg1);\n      box-shadow: 0 2px 10px #00000014;\n    }\n    #title {\n      width: 100%;\n      height: 41px;\n      padding: 12px;\n      color: var(--text2);\n      font-size: 12px;\n      box-sizing: border-box;\n    }\n    #content {\n      max-height: var(--max-content-height);\n      overflow-x: hidden;\n      overflow-y: scroll;\n    }\n    #content::-webkit-scrollbar {\n      width: 4px;\n      border-radius: 4px;\n      background-color: transparent;\n    }\n    #content::-webkit-scrollbar-thumb {\n      border-radius: 4px;\n      border-radius: 4px;\n      background-color: var(--graph_bg_thick);\n      transition: 0.3s ease-in-out;\n    }\n    #content::-webkit-scrollbar-track {\n      border-radius: 4px;\n      background-color: transparent;\n    }\n\n    .group {\n    }\n    .group-name {\n      padding: 0 12px;\n      color: var(--text2);\n    }\n    .group-items {\n      padding: 0;\n      margin: 0;\n    }\n    .item {\n      display: flex;\n      align-items: center;\n      height: 52px;\n      padding: 0 12px;\n      margin: 4px 0;\n      cursor: pointer;\n      box-sizing: border-box;\n    }\n    .item:hover {\n      background-color: var(--bg2_float);\n    }\n    .item-avatar {\n      width: 36px;\n      height: 36px;\n      margin-right: 8px;\n      pointer-events: none;\n    }\n    .item-avatar img {\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n    }\n    .item-info {\n      font-size: 12px;\n      color: var(--text1);\n      pointer-events: none;\n    }\n    .item-name em {\n      color: var(--brand_blue);\n      font-style: normal;\n    }\n    .item-desc {\n      color: var(--text3);\n    }\n  "]))),Pp([An()],Ip.prototype,"keyword",2),Pp([An()],Ip.prototype,"groups",2),Ip=Pp([xn("bili-comment-mention-popover")],Ip);var Rp=Object.defineProperty,jp=Object.getOwnPropertyDescriptor,Dp=function(t,e,n,i){for(var r,o=i>1?void 0:i?jp(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Rp(e,n,o),o},Np=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).options=[],t}return h(e,t),s(e,[{key:"handleClick",value:function(t){this.dispatchEvent(new CustomEvent("select",{detail:t}))}},{key:"render",value:function(){var t=this;return Qe(zs||(zs=x(['\n      <ul id="options">\n        ',"\n      </ul>\n    "])),this.options.map(function(e){return Qe(Us||(Us=x([" <li @click=",">","</li> "])),function(){return t.handleClick(e)},e.text)}))}}])}(gn);Np.styles=we(Fs||(Fs=x(["\n    :host {\n      --bili-comment-menu-display: none;\n      --bili-comment-menu-position: absolute;\n      --bili-comment-menu-top: 20px;\n      --bili-comment-menu-right: 0;\n    }\n    #options {\n      display: var(--bili-comment-menu-display);\n      position: var(--bili-comment-menu-position);\n      top: var(--bili-comment-menu-top);\n      right: var(--bili-comment-menu-right);\n      margin: 0;\n      padding: 0;\n      z-index: 10;\n      width: 120px;\n      list-style: none;\n      border-radius: 4px;\n      font-size: 14px;\n      color: var(--text2);\n      background-color: var(--bg1_float);\n      box-shadow: 0 0 5px #0003;\n      overflow: hidden;\n    }\n\n    #options li {\n      box-sizing: border-box;\n      width: 100%;\n      display: flex;\n      align-items: center;\n      height: 36px;\n      padding: 0 15px;\n      cursor: pointer;\n      user-select: none;\n    }\n    #options li:hover {\n      background-color: var(--graph_bg_regular_float);\n    }\n  "]))),Dp([kn()],Np.prototype,"options",2),Np=Dp([xn("bili-comment-menu")],Np);var Mp=function(){return ni("//s1.hdslb.com/bfs/seed/water-ui/common/bili-photoswipe.js",{lib:"BiliPhotoswipe"})},Lp=function(){var t=i(m().m(function t(e,n){var i;return m().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Mp();case 1:if(i=t.v){t.n=2;break}return iu(""),t.a(2);case 2:i.open(null!=n?n:0,e);case 3:return t.a(2)}},t)}));return function(e,n){return t.apply(this,arguments)}}(),Bp=Object.defineProperty,zp=Object.getOwnPropertyDescriptor,Up=function(t,e,n,i){for(var r,o=i>1?void 0:i?zp(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Bp(e,n,o),o},Fp=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).list=[],t}return h(e,t),s(e,[{key:"items",get:function(){return function(t,e){var n,i=[],r=1===t.length,o=l(t);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=a.img_src,c=a.img_width,u=a.img_height,d=e.multiple,h=d.width,p=d.height,f=c>u,m=Math.floor(f?c/u:u/c)>=3,y={x:0,y:0,w:h,h:p};if(r){var b=e.single[f?"horizontal":"vertical"],g=b.width/b.height,w=c/u;m||!f&&c>b.width&&u>b.height?(h=b.width,p=b.height,y.w=h,y.h=p):w>g?(h=b.width,p=Math.floor(h/w)):(p=b.height,h=Math.floor(p*w))}i.push({width:h,height:p,src:Ei.getBmgSrcNext(s,v(v({w:m&&f?0:h,h:m&&!f?0:p,s:!0},m?{a:y}:{c:!r}),{},{dpr:2})),original:a})}}catch(t){o.e(t)}finally{o.f()}return i}(this.list,{single:{horizontal:{width:240,height:135},vertical:{width:135,height:180}},multiple:{width:88,height:88}}).slice(0,8)}},{key:"handleView",value:function(t){Lp(this.list.map(function(t){var e;return{src:t.img_src,width:t.img_width,height:t.img_height,warning:null==(e=null==t?void 0:t.picture_badge)?void 0:e.text}}),t||0)}},{key:"render",value:function(){var t=this;return Qe(Vs||(Vs=x(['\n      <div id="content">\n        ',"\n        ","\n      </div>\n    "])),this.items.map(function(e,n){return Qe(Hs||(Hs=x([' <img\n            src="','"\n            width="','"\n            height="','"\n            loading="lazy"\n            @click=',"\n          />"])),e.src,e.width,e.height,function(){return t.handleView(n)})}),this.list.length>this.items.length?Qe(Ws||(Ws=x(['<div id="more-tag">+',"</div>"])),this.list.length-this.items.length):"")}}])}(gn);function Vp(t){return new Promise(function(e,n){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.onerror=function(){n(new Error("blobToBase64 error"))},i.readAsDataURL(t)})}function Hp(){var t={};return t.promise=new Promise(function(e,n){t.resolve=e,t.reject=n}),t}Fp.styles=we($s||($s=x(["\n    :host {\n    }\n    #content {\n      position: relative;\n      display: flex;\n      flex-wrap: wrap;\n      gap: 4px;\n      max-width: 364px;\n    }\n    #content img {\n      display: block;\n      border-radius: var(--bili-comment-picutres-border-radius, 6px);\n      cursor: zoom-in;\n    }\n    #more-tag {\n      position: absolute;\n      right: 4px;\n      bottom: 4px;\n      height: 20px;\n      padding: 0 6px;\n      border-radius: 4px;\n      font-size: 13px;\n      color: var(--text_white);\n      font-weight: 500;\n      line-height: 18px;\n      background: rgba(0, 0, 0, 0.7);\n      pointer-events: none;\n    }\n  "]))),Up([kn({type:Array})],Fp.prototype,"list",2),Up([An()],Fp.prototype,"items",1),Fp=Up([xn("bili-comment-pictures-renderer")],Fp);var Wp,$p,Gp,qp,Xp,Zp,Yp,Qp,Kp,Jp,tf,ef,nf,rf,of,af,sf,lf,cf=function(t,e,n){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},uf=function(t,e,n){return function(t,e,n){if(!e.has(t))throw TypeError("Cannot "+n)}(t,e,"access private method"),n},df=1048576,hf=function(t){return t[t.PICTURE_UPLOAD_STATUS_INITIAL=0]="PICTURE_UPLOAD_STATUS_INITIAL",t[t.PICTURE_UPLOAD_STATUS_SUCCESS=1]="PICTURE_UPLOAD_STATUS_SUCCESS",t[t.PICTURE_UPLOAD_STATUS_FAILURE=2]="PICTURE_UPLOAD_STATUS_FAILURE",t}(hf||{}),pf=function(){return s(function t(e){o(this,t),cf(this,Wp),cf(this,Gp),cf(this,Xp),cf(this,Yp),cf(this,Kp),cf(this,tf),cf(this,nf),cf(this,of),cf(this,sf),this.defer=null,this.config=Object.assign({},{remoteOptions:{url:"",body:function(){return{}}},accept:["png","jpeg","jpg","gif"],multiple:!1,maxSize:20,minWidth:10,minHeight:10,onComplete:function(){},onError:function(){}},e||{}),uf(this,Wp,$p).call(this)},[{key:"trigger",value:function(){return this.defer=Hp(),this.el.click(),this.defer.promise}}])}();Wp=new WeakSet,$p=function(){var t=document.createElement("input");t.type="file",this.config.multiple&&t.setAttribute("multiple","multiple");var e=this.config.accept.filter(Boolean).map(function(t){return"image/".concat(t)}).join(", ");t.accept=e||"image/png, image/jpeg, image/jpg, image/gif",t.name="upload",t.addEventListener("change",uf(this,of,af).bind(this)),this.el=t,this.defer=null},Gp=new WeakSet,qp=function(t){for(var e=t.type||"",n=0;n<this.config.accept.length;n++)if(e.indexOf(this.config.accept[n])>-1)return"";return"".concat(this.config.accept.map(function(t){return t.toLocaleUpperCase()}).join(" "))},Xp=new WeakSet,Zp=function(t){return((null==t?void 0:t.type)||"").indexOf("gif")>-1?Math.floor(t.size/df)>=8?"".concat(8,"MBGif"):"":Math.floor(t.size/df)>=this.config.maxSize?"".concat(this.config.maxSize,"MB"):""},Yp=new WeakSet,Qp=function(t){return t<this.config.minWidth?"".concat(this.config.minWidth,""):""},Kp=new WeakSet,Jp=function(t){return t<this.config.minHeight?"".concat(this.config.minHeight,""):""},tf=new WeakSet,ef=function(t,e){var n=this;return new Promise(function(r,o){var a=function(e){t.status=2,t.msg=e},s=uf(n,Gp,qp).call(n,e);if(s)return a(s),o(t);var l=uf(n,Xp,Zp).call(n,e);if(l)return a(l),o(t);var c=new Image;c.src=URL.createObjectURL(e),c.onload=i(m().m(function i(){var s,l,u,d;return m().w(function(i){for(;;)switch(i.p=i.n){case 0:if(!(s=uf(n,Yp,Qp).call(n,c.width))){i.n=1;break}return i.a(2,(a(s),o(t)));case 1:if(!(l=uf(n,Kp,Jp).call(n,c.height))){i.n=2;break}return i.a(2,(a(l),o(t)));case 2:return i.p=2,i.n=3,Vp(e);case 3:t.src=i.v,i.n=5;break;case 4:i.p=4,d=i.v,console.log(d);case 5:return i.p=5,i.n=6,cu.request({url:n.config.remoteOptions.url,method:"POST",data:n.config.remoteOptions.body(e)});case 6:if(0===(u=i.v).code){i.n=7;break}throw new Error(u.message);case 7:t.data=n.config.remoteOptions.response(u),t.status=1,r(t),i.n=9;break;case 8:i.p=8,i.v,a(""),o(t);case 9:return i.a(2)}},i,null,[[5,8],[2,4]])}))})},nf=new WeakSet,rf=function(){return{status:0,msg:"",src:"",data:null}},of=new WeakSet,af=function(t){var e,n,r=this,o=[],a=t.target,s=Array.from(a.files);if(a.value="",0===s.length)return null==(e=this.defer)?void 0:e.reject("empty");this.config.onBeforeUpload&&this.config.onBeforeUpload(s);var l=[];s.forEach(function(t){var e=uf(r,nf,rf).call(r);o.push(e),l.push(uf(r,tf,ef).call(r,e,t))}),setTimeout(i(m().m(function t(){var e;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(l.length!==o.length){t.n=4;break}return t.p=1,t.n=2,Promise.all(l);case 2:uf(r,sf,lf).call(r,r.config.onComplete,o),t.n=4;break;case 3:t.p=3,e=t.v,uf(r,sf,lf).call(r,r.config.onError,e);case 4:return t.a(2)}},t,null,[[1,3]])}))),null==(n=this.defer)||n.resolve(o)},sf=new WeakSet,lf=function(){var t=i(m().m(function t(e){var n,i,r,o=arguments;return m().w(function(t){for(;;)switch(t.n){case 0:if("function"==typeof e){t.n=1;break}throw new Error("cb is not a function");case 1:for(n=o.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=o[r];return t.n=2,e.apply(void 0,i);case 2:return t.a(2,t.v)}},t)}));return function(e){return t.apply(this,arguments)}}(),pf.status=hf;var ff=Object.defineProperty,vf=Object.getOwnPropertyDescriptor,mf=function(t,e,n,i){for(var r,o=i>1?void 0:i?vf(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&ff(e,n,o),o},yf=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.items=[],t.showSlideLeft=!1,t.showSlideRight=!1,t.slideOffsetX=0,t.slideToRight=!1,t}return h(e,t),s(e,[{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),this.uploader=new pf({remoteOptions:{url:"/x/dynamic/feed/draw/upload_bfs",body:function(t){var e=new FormData;return e.append("file_up",t),e.append("biz","new_dyn"),e.append("category","daily"),e},response:function(t){return{img_src:t.data.image_url,img_width:t.data.image_width,img_height:t.data.image_height,img_size:t.data.img_size,ai_gen_pic:t.data.ai_gen_pic}}},accept:this.accept||["png","jpeg","jpg"],multiple:!0,onComplete:function(){t.requestUpdate(),t.updateState()},onBeforeUpload:function(e){var n=e.length+t.items.length-9;n>0&&(e.splice(e.length-n),iu("9"))}}),this.disposables.addEventListener(window,"resize",this.handleSlideBtnVisible.bind(this))}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose()}},{key:"reset",value:function(){this.items=[],this.updateState()}},{key:"trigger",value:(n=i(m().m(function t(){var e,n;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.uploader.trigger();case 1:e=t.v,this.items=[].concat(k(this.items),k(e)),this.items.length&&this.updateVisible(!0),t.n=3;break;case 2:t.p=2,n=t.v,iu(n.message);case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return n.apply(this,arguments)})},{key:"updateState",value:function(){this.handleSlideBtnVisible(),this.dispatchEvent(new CustomEvent("change",{detail:this.items.filter(function(t){return t.data&&t.status===pf.status.PICTURE_UPLOAD_STATUS_SUCCESS}).map(function(t){return t.data})}))}},{key:"handleComputeOffset",value:function(){var t=this.contentEl.parentElement.offsetWidth,e=this.contentEl.offsetWidth;this.slideOffsetX=Math.max(0,e+16-t)}},{key:"handleSlideBtnVisible",value:function(){if(this.handleComputeOffset(),this.slideOffsetX<=0)return this.showSlideLeft=!1,void(this.showSlideRight=!1);this.showSlideLeft=this.slideToRight,this.showSlideRight=!this.showSlideLeft}},{key:"handleSlide",value:function(t){0!==this.slideOffsetX&&(this.slideToRight=t,this.showSlideLeft=t,this.showSlideRight=!this.showSlideLeft)}},{key:"updateVisible",value:function(t){this.style.display=t?"flex":"none"}},{key:"removeItem",value:function(t){var e=k(this.items);e.splice(t,1),this.items=e,0===this.items.length&&this.updateVisible(!1),this.updateState()}},{key:"itemTemplate",value:function(t,e){var n=this;return Qe(Xs||(Xs=x(['<div class="item">\n      <div class="close" @click=','>\n        <bili-icon icon="BDC/xmark_close_line/1" size="12"> </bili-icon>\n      </div>\n      '," ","\n    </div>"])),function(){return n.removeItem(e)},t.src?Qe(Zs||(Zs=x(["<img src=",' alt="" />'])),t.src):"",function(){switch(t.status){case pf.status.PICTURE_UPLOAD_STATUS_INITIAL:return Qe(Gs||(Gs=x(['<div class="mask">\n            <img class="loading" width="24" height="24" src="//i0.hdslb.com/bfs/static/jinkela/long/gif/loading-blue.gif" />\n          </div>'])));case pf.status.PICTURE_UPLOAD_STATUS_FAILURE:return Qe(qs||(qs=x(['<div class="mask error"><div class="msg">',"</div></div>"])),t.msg||"");case pf.status.PICTURE_UPLOAD_STATUS_SUCCESS:default:return""}}())}},{key:"render",value:function(){var t=this;return Qe(Ys||(Ys=x(['\n      <div\n        id="wrapper"\n        class="','"\n      >\n        <div id="shadow" class="left"></div>\n        <div id="slide-btn" class="left" @click=','>\n          <bili-icon icon="BDC/arrow_back_left_line/3" size="12"></bili-icon>\n        </div>\n        <div\n          id="content"\n          style="','"\n        >\n          ','\n        </div>\n        <div id="slide-btn" class="right" @click=','>\n          <bili-icon icon="BDC/arrow_back_left_line/3" size="12"></bili-icon>\n        </div>\n        <div id="shadow" class="right"></div>\n      </div>\n    '])),Ta({"slide-left":this.showSlideLeft,"slide-right":this.showSlideRight}),function(){return t.handleSlide(!1)},Zn({transform:"translateX(".concat(this.slideToRight?-this.slideOffsetX:0,"px)")}),this.items.map(function(e,n){return t.itemTemplate(e,n)}),function(){return t.handleSlide(!0)})}}]);var n}(gn);yf.styles=we(Qs||(Qs=x(["\n    :host {\n      display: none;\n    }\n    #wrapper {\n      position: relative;\n      padding: 0 8px;\n      width: 100%;\n      overflow: hidden;\n    }\n    #wrapper.slide-left #slide-btn.left,\n    #wrapper.slide-left #shadow.left {\n      display: flex;\n    }\n    #wrapper.slide-right #slide-btn.right,\n    #wrapper.slide-right #shadow.right {\n      display: flex;\n    }\n    #slide-btn {\n      position: absolute;\n      top: 50%;\n      display: none;\n      justify-content: center;\n      align-items: center;\n      width: 24px;\n      height: 24px;\n      border-radius: 50%;\n      border: 1px solid var(--line_regular);\n      background-color: #fff;\n      color: var(--text3);\n      cursor: pointer;\n      z-index: 2;\n    }\n    #slide-btn.left {\n      left: 8px;\n      transform: translateY(-50%);\n    }\n    #slide-btn.right {\n      right: 8px;\n      transform: translateY(-50%) rotate(180deg);\n    }\n    #shadow {\n      display: none;\n      position: absolute;\n      top: 0;\n      width: 20px;\n      height: 100%;\n      pointer-events: none;\n      z-index: 1;\n    }\n    #shadow.left {\n      left: 0;\n      background: linear-gradient(to right, #fff, #fff 28.5%, rgba(255, 255, 255, 0) 100%);\n    }\n    #shadow.right {\n      right: 0;\n      background: linear-gradient(to left, #fff 28.5%, rgba(255, 255, 255, 0) 100%);\n    }\n    #content {\n      width: fit-content;\n      display: flex;\n      flex-wrap: nowrap;\n      transition: 0.2s ease-in-out;\n    }\n    .item {\n      position: relative;\n      width: 72px;\n      height: 72px;\n      border-radius: 4px;\n      background-color: #f1f2f3;\n      overflow: hidden;\n      flex-shrink: 0;\n    }\n    .item .close {\n      position: absolute;\n      top: 0;\n      right: 0;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: 20px;\n      height: 20px;\n      border-radius: 0 4px;\n      background-color: #0003;\n      color: #fff;\n      cursor: pointer;\n      z-index: 2;\n    }\n    .item > img {\n      width: 100%;\n      height: 100%;\n      object-fit: cover;\n    }\n    .item .mask {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      background-color: #0005;\n      flex-direction: column;\n      color: #fff;\n      font-size: 20px;\n      z-index: 1;\n    }\n    .item .mask.error {\n      color: #f85a54;\n    }\n    .item .mask .msg {\n      height: 14px;\n      font-size: 20px;\n      transform: scale(0.5);\n      transform-origin: center center;\n      font-weight: 500;\n      white-space: nowrap;\n    }\n\n    #content .item:not(:last-child) {\n      margin-right: 8px;\n    }\n  "]))),mf([kn()],yf.prototype,"accept",2),mf([An()],yf.prototype,"items",2),mf([An()],yf.prototype,"showSlideLeft",2),mf([An()],yf.prototype,"showSlideRight",2),mf([An()],yf.prototype,"slideOffsetX",2),mf([An()],yf.prototype,"slideToRight",2),mf([Cn("#content")],yf.prototype,"contentEl",2),yf=mf([xn("bili-comment-pictures-upload")],yf);var bf=function(t){return t.PC_BROWSER="pc_browser",t.MOBILE_BROWSER="mobile_browser",t.DESKTOP_APP="desktop_app",t}(bf||{}),gf=function(t,e){if(!t)return[];var n=t.match(e);if(!n)return[{type:0,text:t}];var i=0,r=n.reduce(function(e,n){var r=[],o=t.slice(i).indexOf(n),a=t.slice(i,i+o);return a&&r.push({type:0,text:a}),r.push({type:1,text:n}),i=i+o+n.length,e.concat(r)},[]);return i<t.length&&r.push({type:0,text:t.slice(i)}),r};function wf(t,e){return function(n,i){for(var r=0;r<i.length;r++){var o=i[r];o.type?n.push(t(o.text)):e(n,o.text)}}}var xf=Object.defineProperty,kf=Object.defineProperties,Af=Object.getOwnPropertyDescriptors,_f=Object.getOwnPropertySymbols,Ef=Object.prototype.hasOwnProperty,Cf=Object.prototype.propertyIsEnumerable,Tf=function(t,e,n){return e in t?xf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},Sf=function(t,e){for(var n in e||(e={}))Ef.call(e,n)&&Tf(t,n,e[n]);if(_f){var i,r=l(_f(e));try{for(r.s();!(i=r.n()).done;){n=i.value;Cf.call(e,n)&&Tf(t,n,e[n])}}catch(t){r.e(t)}finally{r.f()}}return t},Of=function(t,e,n){return Tf(t,"symbol"!=_(e)?e+"":e,n),n},Pf=/(https?:\/\/)((?:[a-zA-Z0-9]|[_-](?=[a-zA-Z0-9]))+(?:\.(?:[a-zA-Z0-9]|[_-](?=[a-zA-Z0-9]))*)+)((?:\/(?!\/)(?:[a-zA-Z0-9]|[.~!@$%^&*=+_-](?=[a-zA-Z0-9]))*)*)([?#][a-zA-Z0-9\[{\]}\\\|;:'",<.>/?`~!@#$%^&*()=+_-]{0,256})?/,If=/(https?:\/\/)((?:[a-zA-Z0-9]|[_-](?=[a-zA-Z0-9]))+(?:\.(?:[a-zA-Z0-9]|[_-](?=[a-zA-Z0-9]))*)+)((?:\/(?!\/)(?:[a-zA-Z0-9]|[.~!@$%^&*=+_-](?=[a-zA-Z0-9]))*)*)/,Rf="default",jf={blacklist:{domain:[],rex:[]},whitelist:{domain:[],rex:[]}},Df=function(t){return function(t,e){return kf(t,Af(e))}(Sf({},null!=t?t:{}),{appKey:"333.1339",nscode:7})},Nf=function(t){for(var e=[],n=0;n<t.length;n++)/[^a-zA-Z0-9]/.test(t[n])?e.push("\\".concat(t[n])):e.push(t[n]);return e.join("")},Mf=function(t,e){var n,i,r,o,a,s,l,c,u=null!=e?e:Rf,d=Sf({},jf);try{var h=t,p=Sf({},jf),f=Sf({},jf);p={blacklist:JSON.parse(null!=(i=null==(n=null==h?void 0:h[Rf])?void 0:n.blacklist)?i:"{}"),whitelist:JSON.parse(null!=(o=null==(r=null==h?void 0:h[Rf])?void 0:r.whitelist)?o:"{}")},u!==Rf&&(f={blacklist:JSON.parse(null!=(s=null==(a=null==h?void 0:h[u])?void 0:a.blacklist)?s:"{}"),whitelist:JSON.parse(null!=(c=null==(l=null==h?void 0:h[u])?void 0:l.whitelist)?c:"{}")}),d=function(t){var e={domain:[],rex:[]},n={domain:[],rex:[]};return null==t||t.forEach(function(t){var i,r,o,a,s,l,c,u,d,h,p,f,v,m,y,b;null==(c=e.domain)||(i=c).push.apply(i,k(null!=(l=null==(s=null==t?void 0:t.whitelist)?void 0:s.domain)?l:[])),null==(h=e.rex)||(r=h).push.apply(r,k(null!=(d=null==(u=null==t?void 0:t.whitelist)?void 0:u.rex)?d:[])),null==(v=n.domain)||(o=v).push.apply(o,k(null!=(f=null==(p=null==t?void 0:t.blacklist)?void 0:p.domain)?f:[])),null==(b=n.rex)||(a=b).push.apply(a,k(null!=(y=null==(m=null==t?void 0:t.blacklist)?void 0:m.rex)?y:[]))}),{whitelist:e,blacklist:n}}([p,f])}catch(h){console.warn(h)}return d},Lf=function(t,e){var n,i,r,o,a,s,c,u,d,h;if("string"!=typeof t)return!1;var p=null!=(i=null==(n=If.exec(t))?void 0:n[0])?i:"";if(!p)return!1;var f,v=l(null!=(o=null==(r=null==e?void 0:e.blacklist)?void 0:r.rex)?o:[]);try{for(v.s();!(f=v.n()).done;){var m=f.value;if(new RegExp(m).test(p))return!1}}catch(t){v.e(t)}finally{v.f()}var y,b=l(null!=(s=null==(a=null==e?void 0:e.blacklist)?void 0:a.domain)?s:[]);try{for(b.s();!(y=b.n()).done;){var g=y.value;if(new RegExp("(?:^(?:https?://)?(?:[a-zA-Z0-9_-]+.)?)(".concat(Nf(g),")(?=[\\/?#]|$)")).test(p))return!1}}catch(t){b.e(t)}finally{b.f()}var w,x=l(null!=(u=null==(c=null==e?void 0:e.whitelist)?void 0:c.rex)?u:[]);try{for(x.s();!(w=x.n()).done;){var k=w.value;if(new RegExp(k).test(p))return!0}}catch(t){x.e(t)}finally{x.f()}var A,_=l(null!=(h=null==(d=null==e?void 0:e.whitelist)?void 0:d.domain)?h:[]);try{for(_.s();!(A=_.n()).done;){var E=A.value;if(new RegExp("(?:^(?:https?://)?(?:[a-zA-Z0-9_-]+.)?)(".concat(Nf(E),")(?=[\\/?#]|$)")).test(p))return!0}}catch(t){_.e(t)}finally{_.f()}return!1},Bf=function(){return s(function t(e){var n,i;o(this,t),Of(this,"rawKvConfig",{}),Of(this,"scene",Rf),Of(this,"urlRuleSceneConfig",Sf({},jf)),this.rawKvConfig=null!=(n=null==e?void 0:e.rawKvConfig)?n:{},this.scene=null!=(i=null==e?void 0:e.scene)?i:Rf,this.urlRuleSceneConfig=Mf(this.rawKvConfig,this.scene)},[{key:"isWhitelistUrl",value:function(t){return Lf(t,this.urlRuleSceneConfig)}},{key:"getProcessedText",value:function(t){return function(t,e){if("string"!=typeof t)return[];for(var n=[],i=t.matchAll(new RegExp(Pf,"g")),r=0,o=0,a=Array.from(i);o<a.length;o++){var s=a[o],l=s[0];if(Lf(l,e)){var c=s.index,u=c+l.length;r<c&&n.push({value:t.slice(r,c),type:"text"}),n.push({value:l,type:"link"}),r=u}}return r<t.length&&n.push({value:t.slice(r,t.length),type:"text"}),n}(t,this.urlRuleSceneConfig)}}],[{key:"getKvInitConfig",value:function(t){return Df(t)}}])}(),zf=null,Uf=function(){var t=i(m().m(function t(){var e;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(zf){t.n=5;break}return t.p=1,t.n=2,ii(Bf.getKvInitConfig());case 2:return t.n=3,t.v.getAll();case 3:e=t.v,zf=new Bf({rawKvConfig:e,scene:"comments"}),t.n=5;break;case 4:t.p=4,t.v,Wu("tech","comments.urlkv.failed",{});case 5:return t.a(2)}},t,null,[[1,4]])}));return function(){return t.apply(this,arguments)}}(),Ff={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Vf=function(t){return t.replace(/[&<>"'``]/g,function(t){return Ff[t]||t})},Hf=function(t,e){return t=t.replace(/^(https?:)?\/\//,"//"),e?0===t.indexOf("//")?t:"//".concat(t):t},Wf=function(t){return t.replace(/^(https?:)?\/\//,"https://")},$f="%[a-f0-9]{2}",Gf=new RegExp("("+$f+")|([^%]+?)","gi"),qf=new RegExp("("+$f+")+","gi");function Xf(t,e){try{return[decodeURIComponent(t.join(""))]}catch(t){}if(1===t.length)return t;e=e||1;var n=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],Xf(n),Xf(i))}function Zf(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(Gf)||[],n=1;n<e.length;n++)e=(t=Xf(e,n).join("")).match(Gf)||[];return t}}function Yf(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+_(t)+"`");try{return decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"","%FF%FE":""},n=qf.exec(t);n;){try{e[n[0]]=decodeURIComponent(n[0])}catch(t){var i=Zf(n[0]);i!==n[0]&&(e[n[0]]=i)}n=qf.exec(t)}e["%C2"]="";for(var r=0,o=Object.keys(e);r<o.length;r++){var a=o[r];t=t.replace(new RegExp(a,"g"),e[a])}return t}(t)}}function Qf(t,e){var n={};if(Array.isArray(e)){var i,r=l(e);try{for(r.s();!(i=r.n()).done;){var o=i.value,a=Object.getOwnPropertyDescriptor(t,o);null!=a&&a.enumerable&&Object.defineProperty(n,o,a)}}catch(t){r.e(t)}finally{r.f()}}else{var s,c=l(Reflect.ownKeys(t));try{for(c.s();!(s=c.n()).done;){var u=s.value,d=Object.getOwnPropertyDescriptor(t,u);if(d.enumerable)e(u,t[u],t)&&Object.defineProperty(n,u,d)}}catch(t){c.e(t)}finally{c.f()}}return n}function Kf(t,e){if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===t||""===e)return[];var n=t.indexOf(e);return-1===n?[]:[t.slice(0,n),t.slice(n+e.length)]}var Jf=Symbol("encodeFragmentIdentifier");function tv(t){if("string"!=typeof t||1!==t.length)throw new TypeError("arrayFormatSeparator must be single character string")}function ev(t,e){return e.encode?e.strict?function(t){return encodeURIComponent(t).replaceAll(/[!'()*]/g,function(t){return"%".concat(t.charCodeAt(0).toString(16).toUpperCase())})}(t):encodeURIComponent(t):t}function nv(t,e){return e.decode?Yf(t):t}function iv(t){return Array.isArray(t)?t.sort():"object"==_(t)?iv(Object.keys(t)).sort(function(t,e){return Number(t)-Number(e)}).map(function(e){return t[e]}):t}function rv(t){var e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function ov(t,e,n){return"string"===n&&"string"==typeof t?t:"function"==typeof n&&"string"==typeof t?n(t):!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()?"number"===n&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()||e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?Number(t):t:"true"===t.toLowerCase()}function av(t){var e=(t=rv(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function sv(t,e){tv((e=v({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null)},e)).arrayFormatSeparator);var n=function(t){var e;switch(t.arrayFormat){case"index":return function(t,n,i){e=/\[(\d*)]$/.exec(t),t=t.replace(/\[\d*]$/,""),e?(void 0===i[t]&&(i[t]={}),i[t][e[1]]=n):i[t]=n};case"bracket":return function(t,n,i){e=/(\[])$/.exec(t),t=t.replace(/\[]$/,""),e?void 0!==i[t]?i[t]=[].concat(k(i[t]),[n]):i[t]=[n]:i[t]=n};case"colon-list-separator":return function(t,n,i){e=/(:list)$/.exec(t),t=t.replace(/:list$/,""),e?void 0!==i[t]?i[t]=[].concat(k(i[t]),[n]):i[t]=[n]:i[t]=n};case"comma":case"separator":return function(e,n,i){var r="string"==typeof n&&n.includes(t.arrayFormatSeparator),o="string"==typeof n&&!r&&nv(n,t).includes(t.arrayFormatSeparator);n=o?nv(n,t):n;var a=r||o?n.split(t.arrayFormatSeparator).map(function(e){return nv(e,t)}):null===n?n:nv(n,t);i[e]=a};case"bracket-separator":return function(e,n,i){var r=/(\[])$/.test(e);if(e=e.replace(/\[]$/,""),r){var o=null===n?[]:n.split(t.arrayFormatSeparator).map(function(e){return nv(e,t)});void 0!==i[e]?i[e]=[].concat(k(i[e]),k(o)):i[e]=o}else i[e]=n&&nv(n,t)};default:return function(t,e,n){void 0!==n[t]?n[t]=[].concat(k([n[t]].flat()),[e]):n[t]=e}}}(e),i=Object.create(null);if("string"!=typeof t||!(t=t.trim().replace(/^[?#&]/,"")))return i;var r,o=l(t.split("&"));try{for(o.s();!(r=o.n()).done;){var a=r.value;if(""!==a){var s=e.decode?a.replaceAll("+"," "):a,c=g(Kf(s,"="),2),u=c[0],d=c[1];void 0===u&&(u=s),d=void 0===d?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?d:nv(d,e),n(nv(u,e),d,i)}}}catch(t){o.e(t)}finally{o.f()}for(var h=0,p=Object.entries(i);h<p.length;h++){var f=g(p[h],2),m=f[0],y=f[1];if("object"==_(y)&&null!==y&&"string"!==e.types[m])for(var b=0,w=Object.entries(y);b<w.length;b++){var x=g(w[b],2),A=x[0],E=x[1],C=e.types[m]?e.types[m].replace("[]",""):void 0;y[A]=ov(E,e,C)}else"object"==_(y)&&null!==y&&"string"===e.types[m]?i[m]=Object.values(y).join(e.arrayFormatSeparator):i[m]=ov(y,e,e.types[m])}return!1===e.sort?i:(!0===e.sort?Object.keys(i).sort():Object.keys(i).sort(e.sort)).reduce(function(t,e){var n=i[e];return t[e]=n&&"object"==_(n)&&!Array.isArray(n)?iv(n):n,t},Object.create(null))}function lv(t,e){if(!t)return"";tv((e=v({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e)).arrayFormatSeparator);for(var n=function(n){return e.skipNull&&function(t){return null==t}(t[n])||e.skipEmptyString&&""===t[n]},i=function(t){switch(t.arrayFormat){case"index":return function(e){return function(n,i){var r=n.length;return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:[].concat(k(n),null===i?[[ev(e,t),"[",r,"]"].join("")]:[[ev(e,t),"[",ev(r,t),"]=",ev(i,t)].join("")])}};case"bracket":return function(e){return function(n,i){return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:[].concat(k(n),null===i?[[ev(e,t),"[]"].join("")]:[[ev(e,t),"[]=",ev(i,t)].join("")])}};case"colon-list-separator":return function(e){return function(n,i){return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:[].concat(k(n),null===i?[[ev(e,t),":list="].join("")]:[[ev(e,t),":list=",ev(i,t)].join("")])}};case"comma":case"separator":case"bracket-separator":var e="bracket-separator"===t.arrayFormat?"[]=":"=";return function(n){return function(i,r){return void 0===r||t.skipNull&&null===r||t.skipEmptyString&&""===r?i:(r=null===r?"":r,0===i.length?[[ev(n,t),e,ev(r,t)].join("")]:[[i,ev(r,t)].join(t.arrayFormatSeparator)])}};default:return function(e){return function(n,i){return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:[].concat(k(n),null===i?[ev(e,t)]:[[ev(e,t),"=",ev(i,t)].join("")])}}}}(e),r={},o=0,a=Object.entries(t);o<a.length;o++){var s=g(a[o],2),l=s[0],c=s[1];n(l)||(r[l]=c)}var u=Object.keys(r);return!1!==e.sort&&u.sort(e.sort),u.map(function(n){var r=t[n];return void 0===r?"":null===r?ev(n,e):Array.isArray(r)?0===r.length&&"bracket-separator"===e.arrayFormat?ev(n,e)+"[]":r.reduce(i(n),[]).join("&"):ev(n,e)+"="+ev(r,e)}).filter(function(t){return t.length>0}).join("&")}function cv(t,e){var n,i;e=v({decode:!0},e);var r=g(Kf(t,"#"),2),o=r[0],a=r[1];return void 0===o&&(o=t),v({url:null!==(n=null==(i=null==o?void 0:o.split("?"))?void 0:i[0])&&void 0!==n?n:"",query:sv(av(t),e)},e&&e.parseFragmentIdentifier&&a?{fragmentIdentifier:nv(a,e)}:{})}function uv(t,e){e=v(c({encode:!0,strict:!0},Jf,!0),e);var n=rv(t.url).split("?")[0]||"",i=lv(v(v({},sv(av(t.url),{sort:!1})),t.query),e);i&&(i="?".concat(i));var r=function(t){var e="",n=t.indexOf("#");return-1!==n&&(e=t.slice(n)),e}(t.url);if("string"==typeof t.fragmentIdentifier){var o=new URL(n);o.hash=t.fragmentIdentifier,r=e[Jf]?o.hash:"#".concat(t.fragmentIdentifier)}return"".concat(n).concat(i).concat(r)}function dv(t,e,n){var i=cv(t,n=v(c({parseFragmentIdentifier:!0},Jf,!1),n)),r=i.url,o=i.query,a=i.fragmentIdentifier;return uv({url:r,query:Qf(o,e),fragmentIdentifier:a},n)}var hv=Object.freeze(Object.defineProperty({__proto__:null,exclude:function(t,e,n){var i=Array.isArray(e)?function(t){return!e.includes(t)}:function(t,n){return!e(t,n)};return dv(t,i,n)},extract:av,parse:sv,parseUrl:cv,pick:dv,stringify:lv,stringifyUrl:uv},Symbol.toStringTag,{value:"Module"})),pv=null,fv=function(t){var e;if(("undefined"==typeof window?"undefined":_(window))>"u")return null;try{if(t||null===pv){var n=null==(e=hv.parseUrl(location.href).query)?void 0:e.spm_id_from;"string"==typeof n&&(pv=n)}}catch(t){}return pv},vv=function(t,e){try{var n=hv.parseUrl(t);return n.query.spm_id_from=e,hv.stringifyUrl(n)}catch(e){return t}},mv=function(t){return"bilibili://space/".concat(t)},yv="BDC/chain_link_line/1",bv="BDC/video_circle_line/1",gv="BDC/column_line/1",wv="BDC/vote_line/2",xv=function(t,e,n,i,r){return{tag:"a",style:i,dataset:r||{type:"link"},a:{text:Vf(e||""),href:t,icon:n,target:"_blank"}}},kv=function(t){return{tag:"span",span:{text:Vf(t)}}},Av="(https?://)",_v="([/.$*?~=#!%@&A-Za-z0-9_-]*)";function Ev(t,e,n,i){var r,o=[];if(null==(r=t.content)||!r.message)return o.push(kv("")),o;var a=t.content,s=a.message,l=a.emote,c=a.members,u=a.jump_url,d=a.vote,h=zf,p=new RegExp("(AV|av|Av|aV)[0-9]+","ug"),f=new RegExp("(BV|bv|Bv|bV)1[1-9A-NP-Za-km-z]{9}","ug"),m=new RegExp("((CV|cv)[0-9]+|(mobile/[0-9]+))","ug"),y=new RegExp("(EP|ep|Ep|eP)[0-9]+","ug"),b=new RegExp("(SS|ss|Ss|sS)[0-9]+","ug"),w=/\[(?:[\0-'\+-Z\\\^-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+\]/g,x=new RegExp("".concat(Av,"?([a-z0-9A-Z-]{1,15}.)?(bilibili\\.(com|tv|cn)|esheep\\.(com|cn|net)|biligame\\.(com|cn|net)|(bilibiliyoo|im9)\\.com|biliapi\\.net|b23\\.tv|bili22\\.cn|bili33\\.cn|bili23\\.cn|bili2233\\.cn|(sugs\\.suning\\.com)|jueze2021\\.peopleapp\\.com|kaola\\.com|bigfun\\.cn|mcbbs\\.net|mp\\.weixin\\.qq\\.com|static\\.cdsb\\.com|bjnews\\.com\\.cn|720yun\\.com|\\.cctv\\.com)($|/|)").concat(_v),"ug"),k=new RegExp("".concat(Av,"?(((uat-)?www\\.bilibili\\.com)|(b23\\.tv|bili22\\.cn|bili33\\.cn|bili23\\.cn|bili2233\\.cn))(/video)?/((av[0-9]+)|((BV)1[1-9A-NP-Za-km-z]{9}))($|/|)").concat(_v),"ug"),A=new RegExp("".concat(Av,"?(((uat-)?www\\.bilibili\\.com/bangumi/(play/|media/)|(b23\\.tv|bili22\\.cn|bili33\\.cn|bili23\\.cn|bili2233.cn)/)(ss|ep)[0-9]+)($|/|)").concat(_v),"ug"),_=new RegExp("".concat(Av,"?(uat-)?www\\.bilibili\\.com/read/((cv[0-9]+)|(native?id=[0-9]+)|(app/[0-9]+)|(native/[0-9]+)|(mobile/[0-9]+))($|/|)").concat(_v),"ug"),E=/(\d+#)?(\d+(:|)){1,2}\d\d/g,C=function(t){t.lastIndex=0},T=wf(function(t){if(null!=l&&l[t]){var e=l[t],n=e.url,i=e.meta,r=e.webp_url,o=e.gif_url,a=r||o||n,s=20,c={width:"1.4em",height:"1.4em","vertical-align":"text-bottom"};return 2===i.size&&(s=50,c={width:"50px",height:"50px"}),function(t,e,n){return{tag:"img",style:n,img:{src:t,alt:e?Vf(e):"",loading:"lazy"}}}(Ei.getBmgSrcNext(a,{w:s,h:s,dpr:2}),t,c)}return kv(t)},function(t,e){t.push(kv(e))}),S=wf(function(t){var n=t;if(!1===(null==e?void 0:e.videoTime))return kv(t);var i="-1";if(t.indexOf("#")>-1){var r=g(t.split("#"),2);i=r[0],t=r[1]}var o=(t=t.replace(/[:]/g,":")).split(":").map(function(t){return parseInt(t)}).reverse().reduce(function(t,e,n){return t+e*Math.pow(60,n)},0);return{tag:"a",dataset:{type:"seek","video-time":String(o),"video-part":i},a:{text:n,href:""}}},function(t,e){T(t,gf(e,w))}),O=wf(function(t){return xv(oh(ou(t)),t,gv)},function(t,e){S(t,gf(e,E))}),P=wf(function(t){return xv(function(t){var e=rh({bvid:t});return i&&(e=vv(e,i)),e}(t),t,bv)},function(t,e){O(t,gf(e,m))}),I=wf(function(t){return/^av1$/i.test(t)?kv(t):xv(function(t){var e=rh({avid:t});return i&&(e=vv(e,i)),e}(ou(t)),t,bv)},function(t,e){P(t,gf(e,f))}),R={};c.length&&c.forEach(function(t){R["@"+t.uname]=t});var j=wf(function(t){var e=R[t],i=null==e?void 0:e.mid;if(n===bf.MOBILE_BROWSER)return xv(ih(i),t,void 0,void 0,{type:"link",link:mv(i)});var r={type:"mention","user-profile-id":i};return xv(ih(i),t,void 0,void 0,r)},function(t,e){B(t,e,1)}),D=Object.keys(u||{}),N={},M=function(t,e){var r=e.pc_url,o=e.app_url_schema,a=e.title,s=e.prefix_icon,l=e.match_once,c=e.icon_position,u=e.extra;if(l&&N[t])return kv(t);N[t]=!0;var d=1===c,h="";if(r?h=Hf(r):(C(x),x.test(t)?(h=Hf(t,!0),i&&(C(k),k.test(h)&&(h=vv(h,i)))):(C(f),C(p),C(m),f.test(t)?(h=rh({bvid:t}),i&&(h=vv(h,i))):p.test(t)?(h=rh({avid:ou(t)}),i&&(h=vv(h,i))):m.test(t)?(h=oh(ou(t)),i&&(h=vv(h,i))):h=function(t){if(t.startsWith("http")){var e=t.match(/www.bilibili.com\/h5\/note-app\/view\?cvid=(\d+)/);return null!=e&&e[1]?oh(e[1]):t}return""}(t))),!h)return kv(t);var y=a||t,b="",g=!1,w="";(null!=u&&u.goods_item_id||null!=u&&u.goods_prefetched_cache)&&(g=!0,null!=u&&u.goods_pc_click_urls&&Array.isArray(u.goods_pc_click_urls)&&(w=u.goods_pc_click_urls.join(",")),C(x),x.test(t)&&(b=t));var A=g?{type:"goods","goods-url":w,"raw-url":b}:null!=u&&u.is_word_search?{type:"search",keyword:Vf(y)}:{type:"link"};return n===bf.DESKTOP_APP?A=v(v({},A),{},{link:h}):n===bf.MOBILE_BROWSER&&o&&(A=v(v({},A),{},{link:o})),xv(h,y,s,d?{display:"inline-flex","flex-direction":"row-reverse","--icon-width":"0.65em","--icon-height":"1.2em"}:{"--icon-width":"1.2em","--icon-height":"1.2em"},A)},L=wf(function(t){return null!=u&&u[t]?M(t,u[t]):xv(ah(t),t)},function(t,e){B(t,e,2)}),B=function(t,e,n){n<=0&&c.length?j(t,gf(e,new RegExp("@(".concat(c.map(function(t){return t.uname}).join("|"),")"),"gu"))):n<=1&&D.length?L(t,gf(e,new RegExp("(".concat(D.map(su).join("|"),")"),"gu"))):I(t,gf(e,p))},z=wf(function(t){if(null!=u&&u[t])return M(t,u[t]);var e=null,i=t;if(null!=(e=i.match(k))&&e[0]){var r=e[0].match(f);if(null!=r&&r[0])return xv(i,r[0],bv);var o=e[0].match(p);if(null!=o&&o[0])return xv(i,o[0],bv)}if(null!=(e=i.match(A))&&e[0]){var a=e[0].match(b);if(null!=a&&a[0])return xv(i,a[0],bv);var s=e[0].match(y);if(null!=s&&s[0])return xv(i,s[0],bv)}if(null!=(e=i.match(_))&&e[0]){var l=e[0].match(m);if(null!=l&&l[0])return xv(i,l[0],gv)}if(n===bf.DESKTOP_APP){var c={type:"link",link:i};return xv(eh(t),t,yv,void 0,c)}return xv(eh(t),t,yv)},function(t,e){B(t,e,0)}),U=[];if(d){var F="{vote:".concat(d.id,"}");s.indexOf(F)>-1?function(t,e){if(!t)return[];for(var n=[],i=t.indexOf(e);-1!==i;){var r=t.slice(0,i);r&&n.push({type:0,text:r}),n.push({type:1,text:e}),i=(t=t.slice(i+e.length)).indexOf(e)}return t&&n.push({type:0,text:t}),n}(s,F).forEach(function(t){var e=t.type,i=t.text;if(e)if(n===bf.DESKTOP_APP){var r={type:"link",link:d.url};U.push(xv(d.url,d.title,wv,void 0,r))}else U.push(xv(d.url,d.title,wv));else U.push(kv(i))}):U.push(kv(s))}else U.push(kv(s));return U.forEach(function(t){if("span"!==t.tag)o.push(t);else{var e=t.span.text;z(o,h?h.getProcessedText(e).map(function(t){return{type:"link"===t.type?1:0,text:t.value}}):gf(e,x))}}),function(t){var e=[],n=null;return t.forEach(function(t){if(!n)return n=t,void e.push(t);"span"===t.tag&&"span"===n.tag?n.span.text+=t.span.text:(n=t,e.push(n))}),e}(o)}function Cv(t){return t.reply_control?t.reply_control.is_note?{type:"note",oid:t.note_cvid_str}:t.reply_control.is_note_v2&&t.reply_control.fold_pictures?{type:"opus",oid:t.dynamic_id_str}:null:null}var Tv=Object.defineProperty,Sv=Object.getOwnPropertyDescriptor,Ov=function(t,e,n,i){for(var r,o=i>1?void 0:i?Sv(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Tv(e,n,o),o},Pv=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).data=null,t.userNameColor="",t}return h(e,t),s(e,[{key:"expand",get:function(){return!!this.data&&!!Cv(this.data)}},{key:"pictures",get:function(){var t,e,n;return null!=(n=null==(e=null==(t=this.data)?void 0:t.content)?void 0:e.pictures)&&n.length?this.data.content.pictures:null}},{key:"load",value:function(t){this.data=t}},{key:"loadNoteData",value:function(t){var e="",n=[];t.noteContent.forEach(function(t){var i,r,o,a=t.insert;if("video"===(null==(i=a.imageUpload)?void 0:i.source)&&n.length<3&&n.push({img_src:a.imageUpload.url,img_width:a.imageUpload.width}),null!=(o=null==(r=a.tag)?void 0:r.seconds)&&o.toString()){var s=a.tag.seconds,l=a.tag.desc;e=e.concat("".concat(function(t){var e=Math.floor(t/3600),n=Math.floor((t-3600*e)/60),i=t-(3600*e+60*n),r=e.toString().padStart(2,"0"),o=n.toString().padStart(2,"0"),a=i.toString().padStart(2,"0");return e?"".concat(r,":").concat(o,":").concat(a):"".concat(o,":").concat(a)}(s)," ").concat(l))}"string"==typeof a&&(e=e.concat(a))}),e=this.limitContent(e);var i={member:{mid:"1",uname:t.upName,level_info:{current_level:t.upLevel||0},avatar:t.upAvatar,face_nft_new:0,is_contractor:!1,official_verify:{type:-1,desc:""},avatar_item:null,is_senior_member:t.isHardcoreMember?1:0},content:{message:e,members:[],max_line:6,jump_url:{},pictures:n},ctime:""===t.noteTime?Date.now()/1e3-1:new Date(t.noteTime).getTime()/1e3,reply_control:{is_note:!0,max_line:6,time_desc:"",location:""}};t.upNameColor&&(this.userNameColor=t.upNameColor),this.data=i}},{key:"limitContent",value:function(t){var e=(t=t.replace(/^\s*/,"").replace(/\s*$/,"")).match(/\n/g);return e&&e.length>6?t.split("\n").slice(0,6).join("\n").slice(0,77).concat("..."):t.length>77?t.slice(0,77).concat("..."):t}},{key:"connectedCallback",value:function(){w(e,"connectedCallback",this,3)([]),this.initData()}},{key:"initData",value:function(){var t=this;setTimeout(function(){var e;if(t.data){if(null!=(e=t.data.member)&&e.avatar){var n=t.data.member,i=n.avatar,r=n.mid,o=n.pendant,a=n.vip,s=n.official_verify,l=n.face_nft_new;t.biliAvatar.load(Hd({face:i,mid:r,pendant:o||"",vip:a,official:s,nft:null!=l?l:0}),{baseSize:48,isFloat:!0})}t.biliRichText.setContents(Ev(t.data))}})}},{key:"expandTemplate",value:function(){return Qe(Ks||(Ks=x(['<span id="expand"></span>'])))}},{key:"picturesTemplate",value:function(){return Qe(Js||(Js=x(['<div id="pictures">\n      <div id="pic">\n        <bili-comment-pictures-renderer .list=',"></bili-comment-pictures-renderer>\n      </div>\n    </div>"])),this.pictures)}},{key:"render",value:function(){return Qe(tl||(tl=x(['<div id="body">\n      <div id="user-avatar"><bili-avatar></bili-avatar></div>\n      <div id="main">\n        <div id="header">\n          <bili-comment-user-info\n            .data=','\n            style="','"\n          ></bili-comment-user-info>\n        </div>\n        <div id="content">\n          <bili-rich-text\n            style="','"\n          ></bili-rich-text>\n          '," ",'\n        </div>\n        <div id="footer">\n          <bili-comment-action-buttons-renderer\n            style="','"\n            .data=',"\n          ></bili-comment-action-buttons-renderer>\n        </div>\n      </div>\n    </div>"])),this.data,this.userNameColor?Zn({"--bili-comment-user-info-name-color":this.userNameColor}):"",Zn({"--bili-rich-text-font-size":"var(--bili-comments-font-size-content)","--bili-rich-text-line-height":"var(--bili-comments-line-height-content)","--bili-rich-text-link-color":"var(--Lb6)","--bili-rich-text-display":"inline"}),this.expand?this.expandTemplate():"",this.pictures?this.picturesTemplate():"",Zn({"--bili-comment-action-buttons-more-display":"var(--bili-comment-hover-more-display)"}),this.data)}}])}(gn);function Iv(t){return 1===t.type}function Rv(t){var e,n,i=t.reply_control;if(null!=(e=null==i?void 0:i.easter_egg_label)&&e.image){var r=i.easter_egg_label.image;return{type:"easter-egg",width:82,height:36,render:function(){return Da('<img src="'.concat(Ei.getBmgSrcNext(r,{w:82,h:36}),'" width="').concat(82,'" height="').concat(36,'" style="transform: translateY(6px)" >'))}}}var o=function(t){var e;if(null!=(e=t.card_label)&&e.length){var n=t.card_label.find(function(t){return Iv(t)});if(n)return n}return null}(t);if(null!=o&&o.background){var a=o.background_width,s=o.background_height;return{type:"awesome-comment",width:a,height:s,render:function(){return Da('<img src="'.concat(Ei.getBmgSrcNext(o.background,{w:a,h:s,dpr:2}),'" width="').concat(a,'" height="').concat(s,'">'))}}}return null!=(n=t.member)&&n.user_sailing_v2?{type:"user-sailing",width:288,height:48,render:function(){return Qe(nl||(nl=x(["<bili-comment-user-sailing-card .data=","></bili-comment-user-sailing-card>"])),t.member.user_sailing_v2)}}:null}Pv.styles=we(el||(el=x(["\n    #body {\n      pointer-events: none;\n      position: relative;\n      padding-left: 80px;\n      --bili-comment-hover-more-display: block;\n    }\n    #user-avatar {\n      position: absolute;\n      left: 20px;\n      top: 0;\n      width: 48px;\n      height: 48px;\n      transform-origin: left top;\n      transform: var(--bili-comments-avatar-size);\n    }\n    #ornament {\n      position: absolute;\n      right: 0;\n      top: 7px;\n      user-select: none;\n    }\n    bili-comment-vote-option {\n      margin-top: 2px;\n      margin-bottom: 6px;\n    }\n    #main {\n      width: 100%;\n    }\n    #header {\n      margin-bottom: 4px;\n    }\n    i {\n      font-size: 12px;\n      font-style: normal;\n    }\n\n    #content {\n      font-size: var(--bili-comments-font-size-content);\n      line-height: var(--bili-comments-line-height-content);\n      color: var(--text1);\n    }\n    #content #expand {\n      color: var(--brand_blue);\n      cursor: pointer;\n    }\n    #pictures {\n      display: block;\n      width: 100%;\n      margin-top: 8px;\n    }\n  "]))),Ov([An()],Pv.prototype,"data",2),Ov([An()],Pv.prototype,"userNameColor",2),Ov([Cn("bili-avatar")],Pv.prototype,"biliAvatar",2),Ov([Cn("bili-rich-text")],Pv.prototype,"biliRichText",2),Ov([An()],Pv.prototype,"expand",1),Ov([An()],Pv.prototype,"pictures",1),Pv=Ov([xn("bili-comment-preview-renderer")],Pv);var jv=null;function Dv(t){return jv||(jv=document.querySelector("bili-user-profile")||document.createElement("bili-user-profile")),jv.setup(t)}function Nv(){if(jv)jv.parentElement&&jv.parentElement.removeChild(jv);else{var t=document.querySelector("bili-user-profile");t&&t.parentElement&&t.parentElement.removeChild(t)}}var Mv=function(t,e,n){var i;i=n?null==n?void 0:n.scrollTop:document.documentElement.scrollTop;var r=t.getBoundingClientRect().top+i+(e||0);(n||window).scrollTo({top:r,left:0,behavior:"smooth"})},Lv=Object.defineProperty,Bv=Object.getOwnPropertyDescriptor,zv=function(t,e,n,i){for(var r,o=i>1?void 0:i?Bv(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Lv(e,n,o),o},Uv=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.richTextDisposables=null,t.spmPrefix="",t.upMid=0,t.theme="light",t.user=null,t.assist=!1,t.actionConfig={},t.oid="",t.type=0,t.trackObserver=null,t}return h(e,t),s(e,[{key:"avatarPayload",get:function(){var t=this.data.member,e=t.avatar_item,n=t.avatar,i=t.mid,r=t.pendant,o=t.vip,a=t.official_verify,s=t.face_nft_new;return e||(n?Hd({face:n,mid:i,pendant:r||"",vip:o,official:a,nft:null!=s?s:0}):null)}},{key:"ornament",get:function(){return Rv(this.data)}},{key:"top",get:function(){return function(t){return!(!t.reply_control||!t.reply_control.is_up_top&&!t.reply_control.is_admin_top)}(this.data)}},{key:"expandAction",get:function(){return Cv(this.data)}},{key:"expand",get:function(){return!!this.expandAction}},{key:"voteOption",get:function(){var t;return(null==(t=this.data.reply_control)?void 0:t.vote_option)||null}},{key:"vote",get:function(){return this.data.content.vote||null}},{key:"richTextContent",get:function(){return Ev(this.data,this.contentFeatures,bf.PC_BROWSER,"".concat(this.spmPrefix||vi(),".comment.all.click"))}},{key:"getRichTextContent",value:function(){return this.richTextContent}},{key:"pictures",get:function(){var t,e;return null==(t=this.data.content.pictures)||!t.length||null!=(e=this.data.reply_control)&&e.fold_pictures?null:this.data.content.pictures}},{key:"tags",get:function(){return function(t){var e;if(null!=(e=t.card_label)&&e.length){var n=t.card_label.filter(function(t){return!Iv(t)});if(n.length)return n}return null}(this.data)}},{key:"uid",get:function(){return this.data.member.mid}},{key:"spaceLink",get:function(){return ih(this.uid)}},{key:"firstUpdated",value:function(t){var n=this;w(e,"firstUpdated",this,3)([t]),this.initData();var i=this.shadowRoot.querySelector("#user-avatar");this.disposables.add(Dv(i)),this.trackObserver=new Zd({el:this,type:"show",value:{event:"comment.content",data:{type:this.type,oid:this.oid,rpid:this.data.rpid_str}},handler:function(t,e,i){if("show"===t){var r=[];n.richTextContent.forEach(function(e){var n,o;e.dataset&&"search"===(null==(n=e.dataset)?void 0:n.type)&&null!=(o=e.dataset)&&o.keyword&&(r.push(e.dataset.keyword),Hu(t,"community.public-community.reply-card.underline",v(v({},i),{},{message:e.dataset.keyword})))}),Wu(t,e,v(v({},i),{},{keywords:r.join(",")}),{spmPrefix:n.spmPrefix})}}}),this.disposables.add(function(){if(n.trackObserver){var t=n.trackObserver;n.trackObserver=null,setTimeout(function(){t.dispose()})}})}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose(),this.clearRichTextDisposables()}},{key:"clearRichTextDisposables",value:function(){this.richTextDisposables&&(this.richTextDisposables.dispose(),this.richTextDisposables=null)}},{key:"initData",value:(a=i(m().m(function t(){var e,n,i=this;return m().w(function(t){for(;;)switch(t.n){case 0:return this.clearRichTextDisposables(),t.n=1,Promise.resolve();case 1:if(this.avatarPayload&&this.biliAvatar.load(this.avatarPayload,{baseSize:48,isFloat:!0,lazyload:!0}),this.biliRichText.setContents(this.richTextContent),Array.from((null==(e=this.biliRichText.contentsElement)?void 0:e.children)||[]).forEach(function(t){t.dataset.userProfileId&&(i.richTextDisposables||(i.richTextDisposables=Rn()),i.richTextDisposables.add(Dv(t)))}),null==(n=this.data.$extra)||!n.spotlight){t.n=4;break}return t.n=2,au(100);case 2:return Mv(this,-300),t.n=3,au(100);case 3:return t.n=4,this.startSpotlight();case 4:return t.a(2)}},t,this)})),function(){return a.apply(this,arguments)})},{key:"startSpotlight",value:(n=i(m().m(function t(){var e,n=this;return m().w(function(t){for(;;)switch(t.n){case 0:return e="spotlight",this.disposables.addEventListener(this.bodyElement,"transitionend",function(){n.bodyElement.classList.remove(e),n.bodyElement.style.removeProperty("background-color"),n.bodyElement.style.removeProperty("transition")}),this.bodyElement.classList.add(e),this.bodyElement.offsetHeight,t.n=1,new Promise(function(t){requestAnimationFrame(function(){n.bodyElement.style.setProperty("transition","background-color 2s 3s"),n.bodyElement.style.setProperty("background-color","transparent"),t()})});case 1:return t.a(2)}},t,this)})),function(){return n.apply(this,arguments)})},{key:"updated",value:function(t){t.get("data")&&this.initData()}},{key:"handleAction",value:function(t){var e=t.detail,n=e.key,i=e.data;switch(n){case"top":this.dispatchEvent(new CustomEvent("top",{detail:i.active})),this.handleClickTrack(i.active?18:19);break;case"share":this.dispatchEvent(new CustomEvent("share")),this.handleClickTrack(7);break;case"block":this.dispatchEvent(new CustomEvent("block")),this.handleClickTrack(13);break;case"report":this.dispatchEvent(new CustomEvent("report")),this.handleClickTrack(14);break;case"delete":this.dispatchEvent(new CustomEvent("delete")),this.handleClickTrack(23);break;case"filter":Bu.emit("upFilter")}}},{key:"handleReply",value:function(){this.dispatchEvent(new CustomEvent("reply"))}},{key:"handleAvatarClick",value:function(t){t.stopPropagation();var e={rpid:this.data.rpid_str};Vu("replyCardProfileClick",e),Wu("click","comment.user_avatar.click",e,{spmPrefix:this.spmPrefix}),this.handleClickTrack(3)}},{key:"handleTextClick",value:function(t){var e,n,i=t.detail;if(i){if("seek"===i.type){var r=Number(i.videoTime),o=Number(i.videoPart);!isNaN(r)&&!isNaN(o)&&(this.dispatchEvent(new CustomEvent("seek",{detail:{time:r,part:o},composed:!0})),this.handleClickTrack(29))}if("search"===i.type){var a={position:32,keyword:i.keyword};Hu("click","community.public-community.reply-card.all",a),Wu("click","comment.content.click",a,{spmPrefix:this.spmPrefix}),this.handleClickTrack(32)}if("goods"===i.type){var s=i.goodsUrl;s&&null!=(n=null==(e=window.BiliCm)?void 0:e.Base)&&n.sendThirdClickUrls&&window.BiliCm.Base.sendThirdClickUrls(s),this.handleClickTrack(15)}"link"===i.type&&this.handleClickTrack(15)}}},{key:"handleExpand",value:function(t){if("opus"!==this.expandAction.type){var e=t.target,n=v(v({},this.expandAction),{},{ref:e});this.dispatchEvent(new CustomEvent("expand",{detail:n})),this.handleClickTrack(24)}else!function(t,e){var n="//www.bilibili.com/blackboard/comment-detail.html?id=".concat(t,"&theme=").concat(e);uh({title:"",render:function(){return ch(n,lh({"min-height":"550px"}))}})}(this.expandAction.oid,this.theme)}},{key:"mainTags",value:function(){var t;return Qe(il||(il=x(['\n      <div id="tags">\n        ','\n        <div class="tag"></div>\n      </div>\n    '])),null==(t=this.tags)?void 0:t.map(function(t){return Qe(rl||(rl=x(['<div\n              class="tag"\n              style=',"\n            >\n              ","\n            </div>"])),Zn({"--bili-comment-tag-color-light":t.text_color_day,"--bili-comment-tag-color-dark":t.text_color_night,"--bili-comment-tag-bg-light":t.label_color_day,"--bili-comment-tag-bg-dark":t.label_color_night}),t.text_content)}))}},{key:"ornamentTemplate",value:function(){if(!this.ornament)return"";var t=this.ornament,e=t.render,n=t.width,i=t.height;return Qe(ol||(ol=x(['<div\n      id="ornament"\n      style="','"\n    >\n      ',"\n    </div>"])),Zn({width:"".concat(n,"px"),height:"".concat(i,"px")}),e())}},{key:"isFilterClick",value:function(t){var e=t.target;return[this.biliRichText,this.actionButtons].includes(e)}},{key:"handleClickTrack",value:function(t){this.dispatchEvent(new CustomEvent("track",{detail:{position:t}}))}},{key:"topTemplate",value:function(){return Qe(al||(al=x(['<i id="top"></i>'])))}},{key:"expandTemplate",value:function(){return Qe(sl||(sl=x(['<span id="expand" @click=',"></span>"])),this.handleExpand)}},{key:"voteTemplate",value:function(){var t=this;return Qe(ll||(ll=x(['<div\n      id="vote"\n      @click=',"\n    >\n      <bili-comment-vote-renderer .data=","></bili-comment-vote-renderer>\n    </div>"])),function(e){e.stopPropagation(),t.handleClickTrack(10)},this.vote)}},{key:"picturesTemplate",value:function(){var t=this;return Qe(cl||(cl=x(['<div\n      id="pictures"\n      @click=',"\n    >\n      <bili-comment-pictures-renderer .list=","></bili-comment-pictures-renderer>\n    </div>"])),function(e){e.stopPropagation(),t.handleClickTrack(37)},this.pictures)}},{key:"render",value:function(){var t,e,n=this;return Qe(ul||(ul=x(['\n      <div\n        id="body"\n        class="','"\n        @click=','\n      >\n        <a\n          href="','"\n          @click=','\n          id="user-avatar"\n          data-user-profile-id="','"\n          data-user-profile-spmid-follow="comment.profile.click"\n          target="_blank"\n        >\n          ','\n        </a>\n        <div id="main">\n          <div id="header">\n            <bili-comment-user-info\n              .spmPrefix=',"\n              .data=","\n              .upMid=","\n              .medalVisible=","\n              @track=","\n            ></bili-comment-user-info>\n            ","\n          </div>\n          ",'\n          <div id="content">\n            ',"\n            <bili-rich-text\n              @text-click=",'\n              style="','"\n            ></bili-rich-text>\n            '," ","\n            ",'\n          </div>\n          <div id="footer">\n            <bili-comment-action-buttons-renderer\n              .spmPrefix=',"\n              .user=","\n              .upMid=","\n              .oid=","\n              .type=","\n              .assist=","\n              .actionConfig=",'\n              style="','"\n              .data=',"\n              @reply=","\n              @action=","\n              @track=","\n            ></bili-comment-action-buttons-renderer>\n          </div>\n          ","\n        </div>\n      </div>\n    "])),Ta(c({spotlight:null!==(t=null==(e=this.data.$extra)?void 0:e.spotlight)&&void 0!==t&&t},this.theme,!0)),function(t){t.stopPropagation(),!n.isFilterClick(t)&&n.handleClickTrack(1)},this.spaceLink,this.handleAvatarClick,this.uid,this.avatarPayload?Qe(dl||(dl=x(["<bili-avatar></bili-avatar>"]))):Qe(hl||(hl=x(['<img\n                src="','"\n              />'])),Ei.getBmgSrcNext(this.data.member.avatar,{w:48,h:48,c:!0})),this.spmPrefix,this.data,this.upMid,!0,function(t){return n.handleClickTrack(t.detail)},this.ornamentTemplate(),this.voteOption?Qe(pl||(pl=x(["<bili-comment-vote-option .data=","></bili-comment-vote-option>"])),this.voteOption):"",this.top?this.topTemplate():"",this.handleTextClick,Zn({"--bili-rich-text-font-size":"var(--bili-comments-font-size-content)","--bili-rich-text-line-height":"var(--bili-comments-line-height-content)","--bili-rich-text-link-color":"var(--Lb6)","--bili-rich-text-display":"inline"}),this.expand?this.expandTemplate():"",this.vote?this.voteTemplate():"",this.pictures?this.picturesTemplate():"",this.spmPrefix,this.user,this.upMid,this.oid,this.type,this.assist,this.actionConfig,Zn({"--bili-comment-action-buttons-more-display":"var(--bili-comment-hover-more-display)"}),this.data,this.handleReply,this.handleAction,function(t){return n.handleClickTrack(t.detail)},this.tags&&this.mainTags())}}]);var n,a}(gn);Uv.styles=we(fl||(fl=x(["\n    :host {\n      --bili-comment-spotlight-color: var(--brand_blue_thin);\n    }\n    #body.dark .tag {\n      --bili-comment-tag-color: var(--bili-comment-tag-color-dark);\n      --bili-comment-tag-bg: var(--bili-comment-tag-bg-dark);\n    }\n    #body {\n      position: relative;\n      padding-left: 80px;\n      padding-top: 22px;\n      --bili-comment-hover-more-display: none;\n    }\n    #body.spotlight {\n      background-color: var(--bili-comment-spotlight-color);\n    }\n    #body:hover {\n      --bili-comment-hover-more-display: block;\n    }\n    #user-avatar {\n      position: absolute;\n      left: 20px;\n      top: 22px;\n      width: 48px;\n      height: 48px;\n      transform-origin: left top;\n      transform: var(--bili-comments-avatar-size);\n    }\n    #user-avatar img {\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n    }\n    #ornament {\n      position: absolute;\n      right: 0;\n      top: 7px;\n      user-select: none;\n    }\n    bili-comment-vote-option {\n      margin-top: 2px;\n      margin-bottom: 6px;\n    }\n    #main {\n      width: 100%;\n    }\n    #content {\n      width: 100%;\n      display: block;\n      overflow: hidden;\n    }\n    #header {\n      margin-bottom: 4px;\n    }\n    i {\n      font-size: 12px;\n      font-style: normal;\n    }\n    i#top {\n      display: inline-flex;\n      justify-content: center;\n      align-items: center;\n      position: relative;\n      width: 30px;\n      height: 18px;\n      border: 1px solid var(--brand_pink);\n      border-radius: 3px;\n      color: var(--brand_pink);\n      vertical-align: text-bottom;\n      margin-bottom: 0.0666em;\n    }\n    #content {\n      font-size: var(--bili-comments-font-size-content);\n      line-height: var(--bili-comments-line-height-content);\n      color: var(--text1);\n    }\n    #content #expand {\n      color: var(--brand_blue);\n      cursor: pointer;\n    }\n    #vote {\n      margin: 10px 0;\n    }\n    #pictures {\n      display: block;\n      width: 100%;\n      margin-top: 8px;\n    }\n    #tags {\n      margin-top: 6px;\n      display: flex;\n      align-items: center;\n    }\n    .tag {\n      --bili-comment-tag-color: var(--bili-comment-tag-color-light);\n      --bili-comment-tag-bg: var(--bili-comment-tag-bg-light);\n      color: var(--bili-comment-tag-color, --brand_pink);\n      background-color: var(--bili-comment-tag-bg, ----brand_pink_thin);\n      padding: 6px;\n      border-radius: 2px;\n      box-sizing: border-box;\n      font-size: 12px;\n      line-height: 1;\n    }\n    .tag + .tag {\n      margin-left: 10px;\n    }\n  "]))),zv([kn({type:String})],Uv.prototype,"spmPrefix",2),zv([kn()],Uv.prototype,"data",2),zv([kn()],Uv.prototype,"upMid",2),zv([kn()],Uv.prototype,"theme",2),zv([kn()],Uv.prototype,"user",2),zv([kn()],Uv.prototype,"assist",2),zv([kn()],Uv.prototype,"actionConfig",2),zv([kn()],Uv.prototype,"contentFeatures",2),zv([kn()],Uv.prototype,"oid",2),zv([kn()],Uv.prototype,"type",2),zv([An()],Uv.prototype,"avatarPayload",1),zv([An()],Uv.prototype,"ornament",1),zv([An()],Uv.prototype,"top",1),zv([An()],Uv.prototype,"expandAction",1),zv([An()],Uv.prototype,"expand",1),zv([An()],Uv.prototype,"voteOption",1),zv([An()],Uv.prototype,"vote",1),zv([An()],Uv.prototype,"pictures",1),zv([An()],Uv.prototype,"tags",1),zv([An()],Uv.prototype,"uid",1),zv([An()],Uv.prototype,"spaceLink",1),zv([Cn("bili-avatar")],Uv.prototype,"biliAvatar",2),zv([Cn("bili-rich-text")],Uv.prototype,"biliRichText",2),zv([Cn("bili-comment-action-buttons-renderer")],Uv.prototype,"actionButtons",2),zv([Cn("#body")],Uv.prototype,"bodyElement",2),Uv=zv([xn("bili-comment-renderer")],Uv);var Fv=function(t){return cu.request({url:"/x/v2/reply/reply",params:v({},t)})};function Vv(t,e,n){if(!n.namespaces.includes(t))return e;var i=k(e);if("findIndex"===n.method){var r=i.findIndex(n.predicate);return r>-1?i.splice(r,1):[]}return i.filter(n.predicate)}function Hv(t,e,n){if(!n.namespaces.includes(t))return e;var i=k(e);return i[n.method](n.value),i}var Wv=Object.defineProperty,$v=Object.getOwnPropertyDescriptor,Gv=function(t,e,n,i){for(var r,o=i>1?void 0:i?$v(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Wv(e,n,o),o},qv=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.spmPrefix="",t.upMid=0,t.oid="",t.type=0,t.mode=3,t.root="",t.currentPage=1,t.pageSize=10,t.showSpinner=!1,t.showViewMore=!0,t.showPagination=!1,t.count=0,t.totalPage=0,t.cacheList=[],t.list=[],t.newItems=[],t.invisibleID={},t.user=null,t.assist=!1,t.actionConfig={},t}return h(e,t),s(e,[{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]);var n=function(e){e.value.root_str===t.root&&(t.newItems=Hv(Fu,t.newItems,e))},i=function(e){if(t.isChildItem(e.value)){var n=Vv(Fu,[].concat(k(t.newItems),k(t.list)),e);t.updateInvisibleID(n.map(function(t){return t.rpid_str}))}};Bu.on("add",n),Bu.on("remove",i),this.disposables.add(function(){return Bu.off("remove",i)}),this.disposables.add(function(){return Bu.off("add",n)}),this.root=this.data.rpid_str,this.list=this.data.replies||[],this.count=this.data.rcount,this.totalPage=Math.ceil(this.count/this.pageSize)}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose()}},{key:"isChildItem",value:function(t){return"".concat(t.type,",").concat(t.oid_str)=="".concat(this.type,",").concat(this.oid)}},{key:"viewMoreText",get:function(){var t,e,n=this.data,i=n.rcount,r=n.replies;if(!this.data.rcount||i===(null==r?void 0:r.length))return"";var o="".concat(this.data.rcount,"");return null!=(t=this.data.reply_control)&&t.sub_reply_entry_text&&(o=null==(e=this.data.reply_control)?void 0:e.sub_reply_entry_text),o}},{key:"paginationItems",get:function(){var t=[],e=this.currentPage-1;if(this.totalPage>7){var n=e,i=e;e<=2?(n=0,i=Math.min(n+5,this.totalPage-1)):e>=this.totalPage-3?(i=this.totalPage-1,n=Math.max(i-5,0)):(i=Math.min(e+3,this.totalPage-1),n=Math.max(0,e-2)),new Array(i-n).fill(1).forEach(function(e,i){t.push({text:String(n+1+i),idx:n+i,clickable:!0})}),n>0&&(n>1&&t.unshift({text:"...",idx:-1,clickable:!1}),t.unshift({text:"1",idx:0,clickable:!0})),i<=this.totalPage-1&&(i<=this.totalPage-2&&t.push({text:"...",idx:-1,clickable:!1}),t.push({text:String(this.totalPage),idx:this.totalPage-1,clickable:!0}))}else new Array(this.totalPage).fill(1).forEach(function(e,n){t.push({text:String(1+n),idx:n,clickable:!0})});return e>0&&t.unshift({text:"",idx:e-1,clickable:!0}),this.currentPage<this.totalPage&&t.push({text:"",idx:e+1,clickable:!0}),t}},{key:"getList",value:(a=i(m().m(function t(){var e,n,i,r;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,this.showSpinner=!0,t.n=1,Fv({oid:this.oid,type:this.type,root:this.root,ps:this.pageSize,pn:this.currentPage});case 1:if(0===(n=t.v).code&&null!=(e=n.data)&&e.replies){t.n=2;break}return this.showSpinner=!1,t.a(2);case 2:i=n.data.replies,this.invisibleID={},this.newItems=[],this.list=k(i),this.showSpinner=!1,t.n=4;break;case 3:t.p=3,r=t.v,console.log("getList error",r),this.showSpinner=!1;case 4:return t.a(2)}},t,this,[[0,3]])})),function(){return a.apply(this,arguments)})},{key:"handleRevert",value:function(){this.list=k(this.cacheList),this.showPagination=!1,this.showViewMore=!0}},{key:"handleClickTrack",value:function(t){this.dispatchEvent(new CustomEvent("track",{detail:{position:t}}))}},{key:"handleViewMore",value:function(t){t.stopPropagation(),Vu("replyCardCheckClick",{parentId:this.root}),Wu("click","comment.replies_check.click",{root:this.root},{spmPrefix:this.spmPrefix}),this.handleClickTrack(51),this.user?(this.cacheList=k(this.list),this.count>this.pageSize?this.showPagination=!0:this.showViewMore=!1,this.getList()):fd({event:"selfDef.replyCardCheckClick"})}},{key:"handleChangePage",value:function(t){this.currentPage!==t.idx+1&&(this.currentPage=t.idx+1,this.getList())}},{key:"handleItemDelete",value:(n=i(m().m(function t(e,n){var i,r,o;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return i=k("feed"===n?this.list:this.newItems)[e],r="",t.p=1,t.n=2,Qd({title:"",message:",?"});case 2:if(t.v){t.n=3;break}return t.a(2);case 3:return t.n=4,vu({oid:this.oid,type:this.type,rpid:i.rpid_str});case 4:0===t.v.code&&(this.updateInvisibleID([i.rpid_str]),r=""),t.n=6;break;case 5:t.p=5,o=t.v,console.log("",o);case 6:return t.p=6,iu(r),t.f(6);case 7:return t.a(2)}},t,this,[[1,5,6,7]])})),function(t,e){return n.apply(this,arguments)})},{key:"handleItemReport",value:function(t,e){var n={member:{mid:t.member.mid,uname:t.member.uname},oid:this.oid,type:this.type,rpid:t.rpid_str,hiddenJuryTips:e||!1};this.dispatchEvent(new CustomEvent("report",{detail:n}))}},{key:"updateInvisibleID",value:function(t){var e=v({},this.invisibleID);t.forEach(function(t){e[t]=!0}),this.invisibleID=e,this.requestUpdate()}},{key:"viewMoreTemplate",value:function(){return this.viewMoreText?Qe(vl||(vl=x(['\n          <div id="view-more">\n            <span>','</span><bili-text-button @click="','"></bili-text-button>\n          </div>\n        '])),this.viewMoreText,this.handleViewMore):""}},{key:"paginationTemplate",value:function(){var t=this;return Qe(ml||(ml=x(['<div id="pagination">\n      <div id="pagination-head">','</div>\n      <div id="pagination-body">\n        ','\n      </div>\n      <div id="pagination-foot">\n        <bili-text-button @click="','"></bili-text-button>\n      </div>\n    </div>'])),this.totalPage,this.paginationItems.map(function(e){return Qe(yl||(yl=x(["<bili-text-button\n              ",'\n              style="','"\n              data-idx="','"\n              @click="','"\n              >',"</bili-text-button\n            >"])),e.clickable?"":"disabled",e.idx===t.currentPage-1?Zn({"--_label-text-color":"var(--brand_blue)"}):"",e.idx,function(){return t.handleChangePage(e)},e.text)}),this.handleRevert)}},{key:"isVisibleItem",value:function(t){return!this.invisibleID[t]}},{key:"renderItem",value:function(t,e,n){var i=this;return Qe(bl||(bl=x(["<bili-comment-reply-renderer\n      .spmPrefix=","\n      .oid=","\n      .type=","\n      .root=","\n      .mode=","\n      .idx=","\n      .page=","\n      .data=","\n      .user=","\n      .assist=","\n      .upMid=","\n      .visible=","\n      .contentFeatures=","\n      .actionConfig=","\n      @reply=","\n      @share=","\n      @delete=","\n      @block=",'\n      @report="','"\n    ></bili-comment-reply-renderer>'])),this.spmPrefix,this.oid,this.type,this.root,this.mode,e,this.currentPage,t,this.user,this.assist,this.upMid,this.isVisibleItem(t.rpid_str),this.contentFeatures,this.actionConfig,function(){return i.dispatchEvent(new CustomEvent("reply",{detail:t}))},function(){return i.dispatchEvent(new CustomEvent("share",{detail:t}))},function(){return i.handleItemDelete(e,n)},function(){return i.dispatchEvent(new CustomEvent("block",{detail:{mid:t.member.mid}}))},function(e){var n;return i.handleItemReport(t,null==(n=e.detail)?void 0:n.hiddenJuryTips)})}},{key:"render",value:function(){var t=this;return Qe(gl||(gl=x(['\n      <div id="expander">\n        <div id="expander-contents">\n          ',"\n          ","\n          ",'\n          <div id="expander-footer">\n            ',"\n          </div>\n        </div>\n      </div>\n    "])),Ha(this.list,function(t){return t.rpid_str},function(e,n){return t.renderItem(e,n,"feed")}),Ha(this.newItems,function(t){return t.rpid_str},function(e,n){return t.renderItem(e,n,"new")}),this.showSpinner?Qe(wl||(wl=x(['<div id="spinner"><bili-comments-spinner></bili-comments-spinner></div>']))):"",this.showPagination?this.paginationTemplate():this.showViewMore?this.viewMoreTemplate():"")}}]);var n,a}(gn);qv.styles=we(xl||(xl=x(["\n    #expander {\n      padding-left: 80px;\n      margin-top: 2px;\n    }\n    #expander-contents {\n      position: relative;\n    }\n    #spinner {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(var(--bg1_rgb), 0.85);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    #view-more {\n      font-size: 13px;\n      color: var(--text3);\n    }\n    #pagination {\n      display: flex;\n      align-items: center;\n      font-size: 13px;\n      color: var(--text1);\n    }\n    #expander-footer bili-text-button {\n      vertical-align: unset;\n    }\n    #pagination-head {\n      margin-right: 10px;\n    }\n    #pagination-body {\n      display: flex;\n      align-items: center;\n    }\n    #pagination-body bili-text-button,\n    #pagination-foot bili-text-button {\n      margin-left: 8px;\n    }\n    #pagination-body bili-text-button:first-child {\n      margin-left: 10px;\n    }\n  "]))),Gv([kn()],qv.prototype,"contentFeatures",2),Gv([kn()],qv.prototype,"spmPrefix",2),Gv([kn()],qv.prototype,"data",2),Gv([kn()],qv.prototype,"upMid",2),Gv([kn()],qv.prototype,"oid",2),Gv([kn()],qv.prototype,"type",2),Gv([kn()],qv.prototype,"mode",2),Gv([kn()],qv.prototype,"root",2),Gv([An()],qv.prototype,"currentPage",2),Gv([An()],qv.prototype,"showSpinner",2),Gv([An()],qv.prototype,"showViewMore",2),Gv([An()],qv.prototype,"showPagination",2),Gv([An()],qv.prototype,"totalPage",2),Gv([kn({type:Array})],qv.prototype,"list",2),Gv([An()],qv.prototype,"newItems",2),Gv([kn()],qv.prototype,"user",2),Gv([kn()],qv.prototype,"assist",2),Gv([kn()],qv.prototype,"actionConfig",2),Gv([An()],qv.prototype,"viewMoreText",1),Gv([An()],qv.prototype,"paginationItems",1),qv=Gv([xn("bili-comment-replies-renderer")],qv);var Xv=Object.defineProperty,Zv=Object.getOwnPropertyDescriptor,Yv=function(t,e,n,i){for(var r,o=i>1?void 0:i?Zv(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Xv(e,n,o),o},Qv=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.richTextDisposables=null,t.visible=!0,t.spmPrefix="",t.upMid=0,t.oid="",t.type=0,t.mode=3,t.idx=0,t.page=1,t.root="",t.user=null,t.assist=!1,t.actionConfig={},t.avatarSize=24,t.commonTrackData=null,t.trackObserver=null,t}return h(e,t),s(e,[{key:"uid",get:function(){return this.data.member.mid}},{key:"spaceLink",get:function(){return ih(this.uid)}},{key:"userAvatarSrc",get:function(){return Ei.getBmgSrcNext(this.data.member.avatar,{w:this.avatarSize,h:this.avatarSize,s:!0,dpr:2})}},{key:"richTextContent",get:function(){return Ev(this.data,this.contentFeatures,bf.PC_BROWSER,"".concat(this.spmPrefix||vi(),".comment.all.click"))}},{key:"firstUpdated",value:function(t){var n=this;w(e,"firstUpdated",this,3)([t]),this.initData(),this.disposables.add(Dv(this.shadowRoot.querySelector("#user-avatar"))),this.trackObserver=new Zd({el:this,type:"show",value:{event:"comment.reply",data:this.getCommonTrackData()},handler:function(t,e,i){"show"===t&&Wu(t,e,i,{spmPrefix:n.spmPrefix})}}),this.disposables.add(function(){if(n.trackObserver){var t=n.trackObserver;n.trackObserver=null,setTimeout(function(){t.dispose()})}})}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose()}},{key:"clearRichTextDisposables",value:function(){this.richTextDisposables&&(this.richTextDisposables.dispose(),this.richTextDisposables=null)}},{key:"initData",value:(a=i(m().m(function t(){var e,n,i=this;return m().w(function(t){for(;;)switch(t.n){case 0:return this.clearRichTextDisposables(),t.n=1,Promise.resolve();case 1:if(this.biliRichText.setContents(this.richTextContent),Array.from((null==(e=this.biliRichText.contentsElement)?void 0:e.children)||[]).forEach(function(t){t.dataset.userProfileId&&(i.richTextDisposables||(i.richTextDisposables=Rn()),i.richTextDisposables.add(Dv(t)))}),null==(n=this.data.$extra)||!n.spotlight){t.n=4;break}return t.n=2,au(100);case 2:return Mv(this,-300),t.n=3,au(100);case 3:return t.n=4,this.startSpotlight();case 4:return t.a(2)}},t,this)})),function(){return a.apply(this,arguments)})},{key:"startSpotlight",value:(n=i(m().m(function t(){var e,n=this;return m().w(function(t){for(;;)switch(t.n){case 0:return e="spotlight",this.disposables.addEventListener(this.bodyElement,"transitionend",function(){n.bodyElement.classList.remove(e),n.bodyElement.style.removeProperty("background-color"),n.bodyElement.style.removeProperty("transition")}),this.bodyElement.classList.add(e),this.bodyElement.offsetHeight,t.n=1,new Promise(function(t){requestAnimationFrame(function(){n.bodyElement.style.setProperty("transition","background-color 2s 3s"),n.bodyElement.style.setProperty("background-color","transparent"),t()})});case 1:return t.a(2)}},t,this)})),function(){return n.apply(this,arguments)})},{key:"updated",value:function(t){t.get("data")&&this.initData(),t.get("visible")&&(!1===this.visible?this.style.setProperty("display","none"):this.style.removeProperty("display"))}},{key:"getCommonTrackData",value:function(){var t,e,n,i,r,o,a,s,l,c;if(this.commonTrackData)return this.commonTrackData;var u="-";null!=(n=this.data.reply_control)&&n.is_note_v2&&(u=this.data.reply_control.is_note?"note":"opus_"+this.data.dynamic_id_str);var d="";if("string"==typeof this.data.track_info)try{var h=JSON.parse(this.data.track_info);null!=h&&h.track_id&&(d=h.track_id)}catch(t){}var p=[],f=0;this.richTextContent.forEach(function(t){var e,n,i;if("a"===t.tag&&t.a)if(t.a.href){var r=(null==(e=t.dataset)?void 0:e.type)||"";if(!["search","mention"].includes(r)){var o=(null==(n=t.dataset)?void 0:n["raw-url"])||Wf(t.a.href);p.push(o)}}else"seek"===(null==(i=t.dataset)?void 0:i.type)&&(f+=1)});var v=null!==(t=this.data.content)&&void 0!==t?t:{},m=v.members,y=v.vote,b=[];this.data.card_label&&this.data.card_label.forEach(function(t){b.push(t.text_content)});var g={oid:this.oid,type:this.type,rpid:this.data.rpid_str,root_rpid:this.data.root_str,parent_rpid:this.data.parent_str,tag_name:"",ordering:3===this.mode?"heat":"time",from_spmid:fv(),spmid:this.spmPrefix||vi(),reply_list:"",rank:this.idx,page:this.page,card_type:u,url:p.join(","),ext_json:JSON.stringify({is_contain_at:(null==m?void 0:m.length)||0,is_contain_vote:null!=y&&y.id?1:0,is_contain_topic:0,is_contain_url:p.length,is_contain_time:f}),reply_track_id:d,exposure_metadata:"",shown_tags:b.join(","),has_image:null!=(i=this.data.content.pictures)&&i.length?1:0,fold_pictures:(null==(r=this.data.reply_control)?void 0:r.fold_pictures)||"",picture_count:null!==(e=null==(o=this.data.content.pictures)?void 0:o.length)&&void 0!==e?e:0,pic_scale:1,has_fans_medal:null!=(s=null==(a=this.data.member)?void 0:a.fans_detail)&&s.medal_name?1:0,has_god_label:0,has_oldfans_label:null!=(l=this.data.member)&&l.is_contractor?1:0,has_decoration:null!=(c=this.data.member)&&c.user_sailing_v2?1:0,has_guard:0};return this.commonTrackData=g,g}},{key:"getClickTrackData",value:function(t){var e=this.getCommonTrackData();return Object.assign(e,t,{ext_json:JSON.stringify({likes:this.data.like,rank:this.idx,rp_mid:this.data.member.mid,rpid:this.data.rpid_str})}),e}},{key:"handleClickTrack",value:function(t){Wu("click","comment.all.click",this.getClickTrackData({position:t}),{spmPrefix:this.spmPrefix})}},{key:"handleReply",value:function(){this.dispatchEvent(new CustomEvent("reply"))}},{key:"handleAction",value:function(t){var e=t.detail,n=e.key,i=e.data;if("filter"!==n)switch(this.dispatchEvent(new CustomEvent(n,{detail:i})),n){case"block":this.handleClickTrack(13);break;case"report":this.handleClickTrack(14);break;case"share":this.handleClickTrack(7);break;case"delete":this.handleClickTrack(23)}else Bu.emit("upFilter")}},{key:"handleTextClick",value:function(t){var e,n,i=t.detail;if(i){if("seek"===i.type){var r=Number(i.videoTime),o=Number(i.videoPart);!isNaN(r)&&!isNaN(o)&&(this.dispatchEvent(new CustomEvent("seek",{detail:{time:r,part:o},composed:!0})),this.handleClickTrack(29))}if("search"===i.type){var a={position:32,keyword:i.keyword};Wu("click","comment.content.click",a,{spmPrefix:this.spmPrefix}),this.handleClickTrack(32)}if("goods"===i.type){var s=i.goodsUrl;s&&null!=(n=null==(e=window.BiliCm)?void 0:e.Base)&&n.sendThirdClickUrls&&window.BiliCm.Base.sendThirdClickUrls(s),this.handleClickTrack(15)}"link"===i.type&&this.handleClickTrack(15)}}},{key:"isFilterClick",value:function(t){var e=t.target;return[this.biliRichText,this.actionButtons].includes(e)}},{key:"render",value:function(){var t=this;return Qe(kl||(kl=x(['\n      <div\n        id="body"\n        @click=','\n      >\n        <div id="main">\n          <bili-comment-user-info\n            .spmPrefix=',"\n            .data=","\n            .upMid=","\n            @track=",'\n          >\n            <a\n              href="','"\n              id="user-avatar"\n              data-user-profile-id="','"\n              data-user-profile-spmid-follow="comment.profile.click"\n              target="_blank"\n              @click=','\n            >\n              <img width="','" height="','" src='," />\n            </a>\n          </bili-comment-user-info>\n          <bili-rich-text\n            @text-click=",'\n            style="','"\n          ></bili-rich-text>\n        </div>\n        <div id="footer">\n          <bili-comment-action-buttons-renderer\n            .spmPrefix=',"\n            .data=","\n            .oid=","\n            .type=","\n            .root=","\n            .upMid=","\n            .user=","\n            .assist=","\n            .actionConfig=",'\n            style="','"\n            @reply=',"\n            @action=","\n            @track=","\n          ></bili-comment-action-buttons-renderer>\n        </div>\n      </div>\n    "])),function(e){e.stopPropagation(),!t.isFilterClick(e)&&t.handleClickTrack(1)},this.spmPrefix,this.data,this.upMid,function(e){return t.handleClickTrack(e.detail)},this.spaceLink,this.uid,function(e){e.stopPropagation(),t.handleClickTrack(3)},this.avatarSize,this.avatarSize,this.userAvatarSrc,this.handleTextClick,Zn({"--bili-rich-text-line-height":"24px","--bili-rich-text-link-color":"var(--Lb6)","--bili-rich-text-display":"inline"}),this.spmPrefix,this.data,this.oid,this.type,this.root,this.upMid,this.user,this.assist,this.actionConfig,Zn({"--bili-comment-action-buttons-more-display":"var(--bili-comment-hover-more-display)"}),this.handleReply,this.handleAction,function(e){return t.handleClickTrack(e.detail)})}}]);var n,a}(gn);Qv.styles=we(Al||(Al=x(["\n    :host {\n      --bili-comment-spotlight-color: var(--brand_blue_thin);\n    }\n    #body {\n      position: relative;\n      padding: 8px 0 8px 34px;\n      border-radius: 4px;\n      --bili-comment-hover-more-display: none;\n    }\n    #body.spotlight {\n      background-color: var(--bili-comment-spotlight-color);\n    }\n    #body:hover {\n      --bili-comment-hover-more-display: block;\n    }\n    #footer {\n      padding-right: 20px;\n    }\n    #user-avatar {\n      position: absolute;\n      left: 0;\n      width: 24px;\n      height: 24px;\n    }\n    #user-avatar img {\n      border-radius: 50%;\n    }\n    #main {\n      width: 100%;\n      display: block;\n      overflow: hidden;\n    }\n  "]))),Yv([kn({type:Boolean})],Qv.prototype,"visible",2),Yv([kn({type:String})],Qv.prototype,"spmPrefix",2),Yv([kn({type:Object})],Qv.prototype,"data",2),Yv([kn()],Qv.prototype,"upMid",2),Yv([kn()],Qv.prototype,"oid",2),Yv([kn()],Qv.prototype,"type",2),Yv([kn()],Qv.prototype,"mode",2),Yv([kn()],Qv.prototype,"idx",2),Yv([kn()],Qv.prototype,"page",2),Yv([kn()],Qv.prototype,"root",2),Yv([kn()],Qv.prototype,"user",2),Yv([kn()],Qv.prototype,"assist",2),Yv([kn()],Qv.prototype,"contentFeatures",2),Yv([kn()],Qv.prototype,"actionConfig",2),Yv([An()],Qv.prototype,"uid",1),Yv([An()],Qv.prototype,"spaceLink",1),Yv([An()],Qv.prototype,"userAvatarSrc",1),Yv([Cn("bili-rich-text")],Qv.prototype,"biliRichText",2),Yv([Cn("bili-comment-action-buttons-renderer")],Qv.prototype,"actionButtons",2),Yv([Cn("#body")],Qv.prototype,"bodyElement",2),Qv=Yv([xn("bili-comment-reply-renderer")],Qv);var Kv=function(t){return cu.request({url:"/x/v2/reply/wbi/main",params:v(v({},t),{},{web_location:1315875}),chainProxy:function(t){return t.with("UNIOS_WBI_ENCODE",{active:!0,encWbiKeys:{wbiImgKey:"839c8b697b0d44dc80e9a604592bb432",wbiSubKey:"02cd020b04d64aacad6b3a08d06f8eb0"}})}})},Jv=function(){return ri()},tm=function(t){return cu.request({url:"/x/v2/reply/subject/interaction-status",params:v({},t)})},em=function(t){return cu.request({url:"/x/v2/reply/subject/description",params:v({},t)})};function nm(){!function(t){var e=qu();e.notice=t,Xu(e)}({expires:Date.now()+864e5})}function im(){return(qu().notice||{expires:-1}).expires}function rm(t){if(("undefined"==typeof window?"undefined":_(window))<"u"&&!(im()<Date.now())||null==t||!t.ads)return null;for(var e in t.ads){var n=t.ads[e];if(Array.isArray(n)){var i=n[0];return i?{isEmpty:!(i.name&&i.creative_id&&i.is_ad),locId:Number(e),title:i.name,data:i}:null}}return null}function om(t){return t.disabled?{source:"disabled",message:t.message||""}:t.user?t.closed?{source:"closed",message:t.message}:null:{source:"unlogin"}}function am(t){if(null==t||!t.options||null==t||!t.my_vote_option)return null;var e=t.options[t.my_vote_option-1];if(!e)return null;var n=e.desc;-1===n.indexOf("")&&(n="".concat(n,""));var i=3;return 2===t.options.length&&(i=e.idx),v(v({},e),{},{label_kind:i,desc:n})}function sm(t,e){var n="",i="";return"unlogin"===t&&(n=""),e>=1e4?i=" ".concat(Math.floor(e/1e3)/10,"+ "):e>=1e3?i=" ".concat(1e3*Math.floor(e/1e3),"+ "):e>=3&&(i=" ".concat(e," ")),"".concat(n).concat(i)}function lm(t){if(!t.user){if(t.count<=2)return null;var e="unlogin";return{type:e,count:2,text:sm(e,t.count)}}return null}function cm(t){return 12061===t||12002===t}function um(t){var e;return!0===(null==(e=t.control)?void 0:e.web_selection)}function dm(t,e,n){var i,r=n||{},o=r.noTrailing,a=void 0!==o&&o,s=r.noLeading,l=void 0!==s&&s,c=r.debounceMode,u=void 0===c?void 0:c,d=!1,h=0;function p(){i&&clearTimeout(i)}function f(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var s=this,c=Date.now()-h;function f(){h=Date.now(),e.apply(s,r)}function v(){i=void 0}d||(!l&&u&&!i&&f(),p(),void 0===u&&c>t?l?(h=Date.now(),a||(i=setTimeout(u?v:f,t))):f():!0!==a&&(i=setTimeout(u?v:f,void 0===u?t-c:t)))}return f.cancel=function(t){var e=(t||{}).upcomingOnly,n=void 0!==e&&e;p(),d=!n},f}var hm='\n  @font-face {\n    font-family: "fans-num";\n    src: url("//activity.hdslb.com/blackboard/static/20240516/6fdde5f06d0b876f68573682fa59da66/v6u7v27Ucs.ttf");\n  }\n  @font-face {\n    font-family: "'.concat("medalnum",'";\n    src: url("').concat("//s1.hdslb.com/bfs/seed/jinkela/short/webui/comments",'/font/medal-num.ttf");\n  }\n  @font-face {\n    font-family: "').concat("pc-comments-cljzkg6fxb9","\";\n    src: url('https://s1.hdslb.com/bfs/svg-next/font/2024-08-12/pc-comments-cljzkg6fxb9.ttf') format('truetype');\n    font-weight: normal;\n    font-style: normal;\n  }\n  :root {\n    --bili-comments-font-size-title: 20px;\n    --bili-comments-font-size-count: 13px;\n    --bili-comments-font-size-sort: 13px;\n    --bili-comments-font-size-name: 13px;\n    --bili-comments-font-size-content: 15px;\n    --bili-comments-line-height-content: 24px;\n    --bili-comments-avatar-size: scale(0.83333333);\n  }\n  @media screen and (min-width: 1681px) {\n    :root {\n      --bili-comments-font-size-title: 24px;\n      --bili-comments-font-size-count: 14px;\n      --bili-comments-font-size-sort: 16px;\n      --bili-comments-font-size-name: 14px;\n      --bili-comments-font-size-content: 16px;\n      --bili-comments-line-height-content: 26px;\n      --bili-comments-avatar-size: scale(1);\n    }\n  }\n"),pm=function(t,e){return new Promise(function(n){var i=-1,r=window.setTimeout(function(){var r=document.createElement(e.tag);r.style.display="none",r.style.opacity="0",r.style.position="absolute",r.style.top="-9999px",r.style.left="-9999px",document.body.appendChild(r),r.onload=function(){i=1,document.body.removeChild(r),n(i)},r.onerror=function(){i=2,document.body.removeChild(r),n(i)},i=0,r.src=-1===t.indexOf("//")?"//".concat(t):t},e.delay||0);if(e.ctrl){e.ctrl(function(){-1===i?(window.clearTimeout(r),n(i)):console.warn("preloadResource: already started")})}})},fm=Object.defineProperty,vm=Object.getOwnPropertyDescriptor,mm=function(t,e,n,i){for(var r,o=i>1?void 0:i?vm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&fm(e,n,o),o},ym=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.scrollContainer=null,t.user=null,t.assist=!1,t.params="0,0",t.spmPrefix="",t.oid="",t.type=0,t.mode=3,t.lazyLoad=!1,t.paginationStr=JSON.stringify({offset:""}),t.seekRpid="",t.cmFromTrackId="",t.maxViewLimit=0,t.showViewMore=!1,t.theme="light",t.eventBubbles=!1,t.showSpinner=!0,t.showContinuations=!1,t.showContinueTrigger=!!window.IntersectionObserver,t.contentFeatures={videoTime:!0},t.showEnd=!1,t.upMid=0,t.disableUpActions=!1,t.globalOptions=[],t.notice=null,t.vote=null,t.count=0,t.hideSortTime=!1,t.actionConfig={},t.rootInputPlaceholder="",t.inputDisabled=!1,t.rootInputUploadPicState=3,t.rootInputGoodsState=3,t.lazyLoadDP=null,t.initUserDP=null,t.initDescriptionDP=null,t.invisibleID={},t.loadedID={},t.isClosed=!1,t.isSelected=!1,t.limitMaskState=null,t.cmTopProtection=null,t.list=[],t.newItems=[],t.replyTarget=null,t.replyInputValue="",t.replyKeepActive=!1,t.commentBoxDisabledState=null,t.fixedCommentBox=!0,t.replyCommentBox=null,t.trackObserver=null,t}return h(e,t),s(e,[{key:"replyInputPlaceholder",get:function(){var t,e;return" @".concat(null==(e=null==(t=this.replyTarget)?void 0:t.member)?void 0:e.uname," : ")}},{key:"voteOption",get:function(){return am(this.vote)}},{key:"commonTrackData",get:function(){return{cm_from_track_id:this.cmFromTrackId}}},{key:"isVisibleItem",value:function(t){return!this.invisibleID[t]}},{key:"isChildItem",value:function(t){return"".concat(t.type,",").concat(t.oid_str||t.oid)=="".concat(this.type,",").concat(this.oid)}},{key:"initReplyCommentBox",value:function(){if(!this.replyCommentBox){var t=this.shadowRoot.querySelector("#reply-commentbox bili-comment-box");t&&(this.replyCommentBox=t)}}},{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),this.initData();var n=function(e){if(t.isChildItem(e.value)){var n=Vv(Uu,[].concat(k(t.newItems),k(t.list)),e);t.updateInvisibleID(n.map(function(t){return t.rpid_str}))}},r=function(e){t.isChildItem(e.value)&&(t.newItems=Hv(Uu,t.newItems,e))},o=function(){t.replyCommentBox&&(t.replyKeepActive=!1,t.replyTarget=null,t.replyCommentBoxContainer.appendChild(t.replyCommentBox),t.replyCommentBox.style.setProperty("--bili-comment-box-display","none"))},a=function(){var e=i(m().m(function e(n){var i,r,a,s;return m().w(function(e){for(;;)switch(e.n){case 0:if(i=n.target,r=n.defaultInput,a=n.mount,i&&t.isChildItem(i)&&(t.initReplyCommentBox(),t.replyCommentBox)){e.n=1;break}return e.a(2);case 1:if(!t.commentBoxDisabledState){e.n=3;break}if("unlogin"!==t.commentBoxDisabledState.source){e.n=2;break}return fd({event:"selfDef.replyCardReplyClick",spmPrefix:t.spmPrefix}),e.a(2);case 2:return iu(t.commentBoxDisabledState.message||""),e.a(2);case 3:if(!t.replyTarget||i!==t.replyTarget){e.n=4;break}return o(),e.a(2);case 4:return t.replyCommentBox.style.removeProperty("--bili-comment-box-display"),t.replyKeepActive=!0,t.replyInputValue=r||"",t.replyTarget=i,e.n=5,au(0);case 5:return a(t.replyCommentBox),e.n=6,au(0);case 6:t.replyCommentBox.focus(),(s=t.replyCommentBox.getBoundingClientRect()).y>window.innerHeight-200&&window.scrollTo({top:window.scrollY+s.y-window.innerHeight+s.height+200,behavior:"smooth"});case 7:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),s=function(e){var n=e.src,i=e.jumpUrl,r=!1;!function(t){var e=t.src;-1===e.indexOf("//")&&(e="//".concat(e));var n=t.root.getBoundingClientRect(),i=document.createElement("bili-alpha-video");i.setAttribute("src",e),i.setAttribute("width","600"),i.setAttribute("height","500"),i.setAttribute("autoplay",""),i.style.setProperty("position","fixed"),i.style.setProperty("top","50%"),i.style.setProperty("left","50%"),i.style.setProperty("transform","translate(-50%, -50%)"),i.style.setProperty("position","fixed"),i.style.setProperty("z-index","9999"),i.style.setProperty("top","50%"),i.style.setProperty("left","".concat(n.left+n.width/2,"px")),i.style.setProperty("transform","translate(-50%, -50%)");var r=function(){var e;null==(e=null==t?void 0:t.onClick)||e.call(t)};i.addEventListener("click",r);var o=function(){var e;null==(e=null==t?void 0:t.onEnded)||e.call(t),setTimeout(function(){i.removeEventListener("click",r),i.removeEventListener("ended",o),i.parentElement&&i.parentElement.removeChild(i)},20)};i.addEventListener("ended",o),document.documentElement.appendChild(i)}({src:n,root:t,onClick:function(){i&&(r=!0,window.open(i))},onEnded:function(){i&&(r||window.open(i))}})},l=function(){t.actionConfig.upFilter&&vh(t.actionConfig.upFilter.link)};Bu.on("remove",n),Bu.on("add",r),Bu.on("reply",a),Bu.on("hideReply",o),Bu.on("displayAlphaVideo",s),Bu.on("upFilter",l),this.disposables.add(function(){return Bu.off("remove",n)}),this.disposables.add(function(){return Bu.off("add",r)}),this.disposables.add(function(){return Bu.off("reply",a)}),this.disposables.add(function(){return function(){t.replyTarget&&o(),Bu.off("hideReply",o)}}),this.disposables.add(function(){return Bu.off("upFilter",l)}),this.disposables.add(function(){return Bu.off("displayAlphaVideo",s)}),this.disposables.addEventListener(window,"message",function(t){if(t.data&&"object"==_(t.data)){var e=t.data,n=e.images,i=e.index;if(Array.isArray(n)&&"number"==typeof i){var r=n[i];if(!(r&&r.src&&r.width&&r.height))return;Lp(k(n),i)}}}),this.disposables.add(Nv),this.addLoadEvent(),this.initTheme(),this.initDependencies(),this.appendGlobalStyle(),this.trackObserver=new Zd({el:this,type:"show",value:{event:"comments.all",data:v({oid:this.oid,type:this.type,from_spmid:fv(!0)||""},this.commonTrackData)},durational:{repeat:!0,beforeunload:!0},handler:function(e,n,i,r){if("show"===e){Vu("replyCardShow",i);var o={spmPrefix:t.spmPrefix};Wu(e,n,i,r?Object.assign({},r,o):o)}}}),this.disposables.add(function(){if(t.trackObserver){var e=t.trackObserver;t.trackObserver=null,setTimeout(function(){e.dispose()})}})}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose(),this.replyCommentBox=null,this.maxViewLimit=0,this.eventBubbles=!1,this.unload()}},{key:"updated",value:function(t){t.get("params")&&(this.unload(),this.initData())}},{key:"initDependencies",value:function(){$u()}},{key:"initTheme",value:function(){var t=this,e=function(t,e){e||(e={});var n=!1===e.decode,i=e.template;!i&&!Tu()&&(i=document.cookie);var r=!0===t,o={};if(i)for(var a=(n?i:decodeURIComponent(i)).split(";"),s=0;s<a.length;s++){for(var l=a[s];" "===l.charAt(0);)l=l.substring(1);var c=l.split("="),u=c[0],d=c[1];if(o[u]=d,t===u)return o[t]}return r?o:""}("theme_style"),n=function(e){t.theme=e};"dark"===e&&n("dark"),zu.on("global.themeChange",function(t){n(t.payload)}),this.disposables.add(function(){zu.off("global.themeChange")})}},{key:"appendGlobalStyle",value:function(){var t="bili-comments-global-style";if(!document.querySelector("#"+t)){var e=document.createElement("style");e.id=t,e.innerHTML=hm,document.body.appendChild(e)}}},{key:"initData",value:function(){if(this.shadowRoot)if(this.params&&"string"==typeof this.params&&"0,0"!==this.params){var t=g(this.params.split(","),2),e=t[0],n=t[1];if(n&&"0"!==n&&e&&"0"!==e&&!isNaN(Number(e))){var i=this.getAttribute("mode")||"3",r=!1;this.getAttribute("lazy-load")&&(r=!0);var o=this.getAttribute("seek-id")||"";isNaN(Number(o))&&(o="");var a=this.getAttribute("cm-from-track-id")||"",s=0,l=this.getAttribute("max-view-limit");"string"==typeof l&&(s=Number(l),isNaN(s)&&(s=0));var c=this.getAttribute("disable-video-time"),u={videoTime:!0};"string"==typeof c&&"false"!==c&&(u.videoTime=!1);var d=!1,h=this.getAttribute("disable-up-actions");"string"==typeof h&&"false"!==h&&(d=!0);var p=!0,f=this.getAttribute("fixed-comment-box");"string"==typeof f&&"false"===f&&(p=!1);var v,m=this.getAttribute("spm-prefix")||"",y=this.getAttribute("event-bubbles");if(this.parentElement&&!this.scrollContainer&&this.parentElement!==document.body){var b=getComputedStyle(this.parentElement);["auto","scroll"].includes(b.overflowY)&&(v=this.parentElement)}this.load({oid:n,type:Number(e),seekRpid:o,spmPrefix:m,cmFromTrackId:a,mode:Number(i),lazyLoad:r,maxViewLimit:s,contentFeatures:u,disableUpActions:d,fixedCommentBox:p,eventBubbles:null!==y,scrollContainer:v})}else console.warn("Please set correct 'data-params' attribute for bili-comments element")}else console.warn("Please set 'data-params' attribute for bili-comments element, eg: 'type,oid'")}},{key:"updateList",value:function(t){this.list=t}},{key:"clearList",value:function(){this.newItems=[],this.list=[],this.invisibleID={},this.loadedID={},this.showEnd=!1,this.showContinuations=!1,this.paginationStr=JSON.stringify({offset:""})}},{key:"unload",value:function(){this.user=null,this.notice=null,this.upMid=0,this.assist=!1,this.hideSortTime=!1,this.vote=null,this.inputDisabled=!1,this.isClosed=!1,this.isSelected=!1,this.disableUpActions=!1,this.globalOptions=[],this.limitMaskState=null,this.contentFeatures={videoTime:!0},this.cmTopProtection=null,this.mode=3,this.lazyLoad=!1,this.lazyLoadDP&&(this.lazyLoadDP.reject(),this.lazyLoadDP=null),this.showViewMore=!1,this.actionConfig={},this.replyTarget&&(this.replyTarget=null,this.replyCommentBox&&(this.replyCommentBox.remove(),this.replyCommentBox=null)),this.clearList()}},{key:"reload",value:(T=i(m().m(function t(e){return m().w(function(t){for(;;)switch(t.n){case 0:return this.unload(),t.n=1,this.load(e);case 1:return t.a(2,t.v)}},t,this)})),function(t){return T.apply(this,arguments)})},{key:"load",value:(C=i(m().m(function t(e){var n,i,r,o,a,s,l,c,u,d,h,p,f,v;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,e&&(n=e.oid,i=e.type,r=e.mode,o=e.lazyLoad,a=e.seekRpid,s=e.spmPrefix,l=e.maxViewLimit,c=e.scrollContainer,u=e.cmFromTrackId,d=e.contentFeatures,h=e.disableUpActions,p=e.fixedCommentBox,this.oid=String(n),this.type=i,r&&[2,3].includes(r)&&(this.mode=r),this.lazyLoad=o||!1,this.seekRpid=a?String(a):"",this.spmPrefix=s||"",this.cmFromTrackId=u||"",l&&l>0&&(this.maxViewLimit=l),d&&(this.contentFeatures=d),this.disableUpActions=!!h,this.fixedCommentBox=null==p||p,c&&("string"==typeof c?(f=document.querySelector(c))?this.scrollContainer=f:console.warn("scrollContainer not found"):this.scrollContainer=c),this.eventBubbles=e.eventBubbles||!1),this.showSpinner=!0,t.n=1,this.initLazyLoad();case 1:return this.initUser(),t.n=2,Promise.all([this.initUpGlobalActions(),this.initDescription(),this.getList(),Uf()]);case 2:return t.n=3,this.requestUpdate();case 3:this.showSpinner=!1,this.handleTriggerEvent("inited"),!this.showEnd&&this.list.length<10&&this.getList(),t.n=5;break;case 4:return t.p=4,v=t.v,t.a(2,(console.warn("bili comments load error",v),Promise.reject(v)));case 5:return t.a(2)}},t,this,[[0,4]])})),function(t){return C.apply(this,arguments)})},{key:"initLazyLoad",value:(E=i(m().m(function t(){var e,n=this;return m().w(function(t){for(;;)switch(t.n){case 0:if(this.lazyLoad){t.n=1;break}return t.a(2);case 1:if(window.IntersectionObserver){t.n=2;break}return console.warn("IntersectionObserver not supported, lazy load will not work"),t.a(2);case 2:return this.lazyLoadDP=Hp(),e=null,t.a(2,(e=new IntersectionObserver(function(t){if(t[0].isIntersecting){if(!n.lazyLoadDP||(n.lazyLoadDP.resolve(),n.lazyLoadDP=null,!e))return;e.disconnect(),e=null}}),this.disposables.add(function(){e&&(e.disconnect(),e=null)}),e.observe(this),this.lazyLoadDP.promise))}},t,this)})),function(){return E.apply(this,arguments)})},{key:"initUser",value:(A=i(m().m(function t(){var e,n,i,r;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,this.initUserDP=Hp(),t.n=1,Jv();case 1:if(e=t.v,n=e.code,i=e.data,this.initUserDP.resolve(),this.initUserDP=null,0!==n||!i){t.n=2;break}return t.a(2,(this.user=i,i));case 2:t.n=4;break;case 3:t.p=3,r=t.v,this.initUserDP&&(this.initUserDP.resolve(),this.initUserDP=null),console.warn("",r);case 4:return t.a(2,null)}},t,this,[[0,3]])})),function(){return A.apply(this,arguments)})},{key:"initUpGlobalActions",value:(b=i(m().m(function t(){var e,n,i,r;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.disableUpActions){t.n=5;break}return t.p=1,t.n=2,tm({oid:this.oid,type:this.type});case 2:if(e=t.v,n=e.code,i=e.data,0===n&&i){t.n=3;break}return t.a(2);case 3:this.globalOptions=pd(i),t.n=5;break;case 4:t.p=4,r=t.v,console.log("bili comments up interaction status error",r);case 5:return t.a(2)}},t,this,[[1,4]])})),function(){return b.apply(this,arguments)})},{key:"initDescription",value:(y=i(m().m(function t(){var e,n,i,r,o,a,s,l,c,u,d;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,this.initDescriptionDP=Hp(),t.n=1,em({oid:this.oid,type:this.type});case 1:if(i=t.v,r=i.code,o=i.data,this.initDescriptionDP.resolve(),this.initDescriptionDP=null,0===r&&null!=o&&o.base){t.n=2;break}return t.a(2);case 2:a=o.base,s=a.count,l=a.input,c=a.up_mid,u=a.web_up_filter_link,this.upMid=parseInt(c),this.handleCountChange(parseInt(s||"0")),l&&(this.rootInputPlaceholder=l.root_text||"",l.editor_icon_config&&(this.rootInputUploadPicState=l.editor_icon_config.upload_picture_icon_state,this.rootInputGoodsState=null!==(e=l.editor_icon_config.goods_icon_state)&&void 0!==e?e:3,this.inputDisabled=null!==(n=l.disabled)&&void 0!==n&&n)),u&&(this.actionConfig.upFilter={text:"",link:u}),t.n=4;break;case 3:t.p=3,d=t.v,this.initDescriptionDP&&(this.initDescriptionDP.resolve(),this.initDescriptionDP=null),console.log("bili comments description error",d);case 4:return t.a(2)}},t,this,[[0,3]])})),function(){return y.apply(this,arguments)})},{key:"addLoadEvent",value:(f=i(m().m(function t(){var e,n=this;return m().w(function(t){for(;;)switch(t.n){case 0:this.showContinueTrigger&&this.continueTrigger?(e=new IntersectionObserver(function(){var t=i(m().m(function t(e){return m().w(function(t){for(;;)switch(t.n){case 0:if(!e[0].isIntersecting||n.showEnd){t.n=2;break}if(!n.showSpinner&&!n.showContinuations){t.n=1;break}return t.a(2);case 1:n.getList();case 2:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()),e.observe(this.continueTrigger),this.disposables.add(function(){e.unobserve(n.continueTrigger),e.disconnect()})):this.disposables.addEventListener(this.scrollContainer||window,"scroll",dm(100,function(){if(!n.showSpinner&&!n.showContinuations)if(n.scrollContainer){var t=n.scrollContainer,e=t.scrollTop,i=t.scrollHeight,r=t.clientHeight;Math.ceil(e)+2*r>=i&&n.getList()}else{var o=document.documentElement,a=o.scrollTop,s=o.scrollHeight,l=window.innerHeight;Math.ceil(a)+2*l>=s&&n.getList()}}));case 1:return t.a(2)}},t,this)})),function(){return f.apply(this,arguments)})},{key:"updateInvisibleID",value:function(t){var e=v({},this.invisibleID);t.forEach(function(t){e[t]=!0}),this.invisibleID=e,this.requestUpdate()}},{key:"handleItemDelete",value:(p=i(m().m(function t(e,n){var i,r,o,a,s=this;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(r=k("feed"===n?this.list:this.newItems)[e],(null==(i=this.cmTopProtection)?void 0:i.rpid)!==(null==r?void 0:r.rpid_str)){t.n=1;break}return Yd({title:"",message:this.cmTopProtection.message,cancel:{text:"",click:function(t){t(),fh({type:s.type,oid:s.oid,rpid:r.rpid_str})}},confirm:{text:"",click:function(t){t()}}}),t.a(2);case 1:return o="",t.p=2,t.n=3,Qd({title:"",message:",?"});case 3:if(t.v){t.n=4;break}return o="",t.a(2);case 4:return t.n=5,vu({oid:this.oid,type:this.type,rpid:r.rpid_str});case 5:0===t.v.code&&(this.updateInvisibleID([r.rpid_str]),o=""),t.n=7;break;case 6:t.p=6,a=t.v,console.log("",a);case 7:return t.p=7,o&&iu(o),t.f(7);case 8:return t.a(2)}},t,this,[[2,6,7,8]])})),function(t,e){return p.apply(this,arguments)})},{key:"handleCountChange",value:function(t){this.count=t,this.handleTriggerEvent("count",this.count)}},{key:"handleItemTop",value:(d=i(m().m(function t(e,n,i){var r,o,a,s,l,c=this;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(o=k("feed"===n?this.list:this.newItems)[e],a="".concat(i?"":"",""),null==(r=this.cmTopProtection)||!r.rpid){t.n=1;break}return Yd({title:a+"",message:this.cmTopProtection.message,cancel:{text:"",click:function(t){t(),fh({type:c.type,oid:c.oid,rpid:o.rpid_str})}},confirm:{text:"",click:function(t){t()}}}),t.a(2);case 1:return t.p=1,t.n=2,mu({oid:this.oid,type:this.type,rpid:o.rpid_str,action:i?1:0});case 2:s=t.v,l=s.code,a+=0===l?"":"",t.n=4;break;case 3:t.p=3,t.v,a+="";case 4:return t.p=4,iu(a),t.f(4);case 5:return t.a(2)}},t,this,[[1,3,4,5]])})),function(t,e,n){return d.apply(this,arguments)})},{key:"handleItemReport",value:(u=i(m().m(function t(e){return m().w(function(t){for(;;)switch(t.n){case 0:hh(v(v({},e),{},{ordering:3===this.mode?"heat":"time"}));case 1:return t.a(2)}},t,this)})),function(t){return u.apply(this,arguments)})},{key:"handleItemBlock",value:(c=i(m().m(function t(e){var n,i,r;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Qd({title:"",message:""});case 1:if(t.v){t.n=2;break}return t.a(2);case 2:return t.n=3,ku({fid:e.mid,act:5,re_src:15},{statistics:JSON.stringify({appId:100,platform:5})});case 3:if(n=t.v,i=n.code,r=n.message,0===i){t.n=4;break}return iu(r||""),t.a(2);case 4:Bu.emit("remove",{namespaces:[Uu,Fu],method:"filter",predicate:function(t){var n;return(null==(n=t.member)?void 0:n.mid)===e.mid},value:{type:this.type,oid:this.oid,oid_str:this.oid}}),iu(""),t.n=6;break;case 5:t.p=5,t.v,iu("");case 6:return t.a(2)}},t,this,[[0,5]])})),function(t){return c.apply(this,arguments)})},{key:"updatePaginationStr",value:function(t){this.paginationStr=JSON.stringify({offset:t})}},{key:"updateReplyItemExtra",value:function(t,e,n){t.$extra||(t.$extra={}),t.$extra[e]=n}},{key:"getList",value:(l=i(m().m(function t(){var e,n,i,r,o,a,s,l,c,u,d,h,p,f,v,y,b,g,w=this;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,!this.showEnd){t.n=1;break}return t.a(2);case 1:return this.list.length&&(this.showContinuations=!0),t.n=2,Kv({oid:this.oid,type:this.type,mode:this.mode,pagination_str:this.paginationStr,plat:1,seek_rpid:0===this.list.length?this.seekRpid:void 0,cm_from_track_id:this.cmFromTrackId||void 0});case 2:if(i=t.v,!this.showSpinner){t.n=3;break}if(r=[],this.initUserDP&&r.push(this.initUserDP.promise),this.initDescriptionDP&&r.push(this.initDescriptionDP.promise),!r.length){t.n=3;break}return t.n=3,Promise.all(r);case 3:if(0===i.code&&i.data){t.n=4;break}return this.isClosed=cm(i.code),this.commentBoxDisabledState=om({user:this.user,closed:this.isClosed,message:i.message||"~",disabled:!0}),this.showContinuations=!1,this.showSpinner&&(this.showEnd=!0),t.a(2);case 4:if(o=i.data,a=o.cursor,s=o.cm_info,l=o.control,c=o.top_replies,u=o.upper,d=o.assist,h=i.data.replies||[],p=[],(f=0===this.list.length)&&null!=c&&c.length&&c.reverse().forEach(function(t){h.unshift(t)}),this.showSpinner&&((v=!!this.upMid)||(this.upMid=u.mid),this.assist=1===d,this.notice=rm(s),this.vote=i.data.vote_card||null,this.count||this.handleCountChange((null==a?void 0:a.all_count)||0),l&&(2===l.show_type&&(this.hideSortTime=!0),v||(this.rootInputPlaceholder=l.root_input_text||"",this.rootInputUploadPicState=l.upload_picture_icon_state,this.inputDisabled=l.input_disable),this.commentBoxDisabledState=om({user:this.user,closed:this.isClosed,message:this.rootInputPlaceholder,disabled:this.inputDisabled}),l.cm_top_reply_protection&&(this.cmTopProtection={rpid:String(l.cm_top_reply_protection.protected_top_rpid),message:l.cm_top_reply_protection.popup_message}),l.preload_resources)&&(y=l.preload_resources,window.setTimeout(function(){y.forEach(function(t,e){3===t.biz_kind&&t.url&&pm(t.url,{tag:"video",delay:1e3*e})})},6e3)),this.isSelected=um(i.data),this.limitMaskState=lm({user:this.user,count:this.count}),this.limitMaskState&&(this.showEnd=!0,h=h.slice(0,this.limitMaskState.count))),null!=(e=null==a?void 0:a.pagination_reply)&&e.next_offset&&this.updatePaginationStr(null==(n=null==a?void 0:a.pagination_reply)?void 0:n.next_offset),b=!this.seekRpid,h.forEach(function(t){var e;w.loadedID[t.rpid_str]||!0!==t.invisible&&(w.loadedID[t.rpid_str]=!0,!1===b&&(t.rpid_str===w.seekRpid?(w.updateReplyItemExtra(t,"spotlight",!0),b=!0):null!=(e=t.replies)&&e.length&&t.replies.forEach(function(t){b||t.rpid_str===w.seekRpid&&(w.updateReplyItemExtra(t,"spotlight",!0),b=!0)})),p.push(t))}),this.showContinuations=!1,!(f&&this.maxViewLimit>0)){t.n=5;break}return p.length&&(p.length>this.maxViewLimit&&(this.showViewMore=!0),this.updateList(this.list.concat(p.slice(0,this.maxViewLimit)))),this.showEnd=!0,t.a(2);case 5:null!=a&&a.is_end&&(this.showEnd=!0),p.length&&this.updateList(this.list.concat(p)),t.n=7;break;case 6:t.p=6,g=t.v,console.log("getList error",g),this.showContinuations=!1;case 7:return t.a(2)}},t,this,[[0,6]])})),function(){return l.apply(this,arguments)})},{key:"handleGlobalAction",value:(a=i(m().m(function t(e){var n,i,r,o,a,s,l,c,u,d,h,p,f,v,y,b,g,w,x,k,A=this;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(null!=(n=e.detail)&&n.key&&null!=(i=e.detail)&&i.data){t.n=1;break}return t.a(2);case 1:if(r=e.detail.key,o=e.detail.data.active,a=e.detail.text,"select"!==r){t.n=9;break}return t.p=2,t.n=3,Qd({title:a,message:o?"PC":"PC"});case 3:if(t.v){t.n=4;break}return t.a(2);case 4:return t.n=5,bu({oid:this.oid,type:this.type,action:o?yu.SELECT:yu.UNSELECT});case 5:if(s=t.v,l=s.code,c=s.message,u=s.data,0===l){t.n=6;break}return iu((null==u?void 0:u.action_toast)||c||""),t.a(2);case 6:iu((null==u?void 0:u.action_toast)||c||a+""),Vu("interaction-submit",{type:"selection",status:o?0:1}),Wu("click","comments.action.click",{action:"select",status:o?0:1},{spmPrefix:this.spmPrefix}),setTimeout(function(){A.reload()},2e3),t.n=8;break;case 7:t.p=7,t.v,iu("");case 8:return t.a(2);case 9:if("close"!==r){t.n=17;break}return t.p=10,t.n=11,Qd({title:a,message:o?"":""});case 11:if(t.v){t.n=12;break}return t.a(2);case 12:return t.n=13,bu({oid:this.oid,type:this.type,action:o?yu.OPEN:yu.CLOSE});case 13:if(d=t.v,h=d.code,p=d.message,f=d.data,0===h){t.n=14;break}return iu((null==f?void 0:f.action_toast)||p||""),t.a(2);case 14:iu((null==f?void 0:f.action_toast)||p||a+""),Vu("interaction-submit",v={type:"reply",status:o?0:1}),Wu("click","comments.action.click",v,{spmPrefix:this.spmPrefix}),setTimeout(function(){A.reload()},2e3),t.n=16;break;case 15:t.p=15,t.v,iu("");case 16:return t.a(2);case 17:if("close-danmaku"!==r){t.n=25;break}return t.p=18,t.n=19,Qd({title:a,message:o?"":""});case 19:if(t.v){t.n=20;break}return t.a(2);case 20:return t.n=21,gu({aid:this.oid,state:o?0:1});case 21:if(y=t.v,b=y.code,g=y.message,w=y.data,0===b){t.n=22;break}return iu((null==w?void 0:w.action_toast)||g||""),t.a(2);case 22:"0"===(x=(null==w?void 0:w.action_toast)||g)&&(x=""),iu(x||a+""),Vu("interaction-submit",k={type:"dm",status:o?0:1}),Wu("click","comments.action.click",k,{spmPrefix:this.spmPrefix}),t.n=24;break;case 23:t.p=23,t.v,iu("");case 24:case 25:return t.a(2)}},t,this,[[18,23],[10,15],[2,7]])})),function(t){return a.apply(this,arguments)})},{key:"handleModeChange",value:(n=i(m().m(function t(e){return m().w(function(t){for(;;)switch(t.n){case 0:if(this.user){t.n=1;break}return fd({event:"selfDef.replyOrderClick",spmPrefix:this.spmPrefix}),t.a(2);case 1:return this.mode=e.detail,this.clearList(),this.showContinuations=!0,t.n=2,this.getList();case 2:return t.a(2)}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"handleNoticeClose",value:function(){nm(),this.notice=null}},{key:"handleTriggerEvent",value:function(t,e){this.eventBubbles?this.dispatchEvent(new CustomEvent("bili-comments-".concat(t),{detail:e,bubbles:!0})):this.dispatchEvent(new CustomEvent(t,{detail:e}))}},{key:"handleLimitClick",value:function(){var t;"unlogin"===(null==(t=this.limitMaskState)?void 0:t.type)&&fd({event:"selfDef.replyCardShowMore",spmPrefix:this.spmPrefix})}},{key:"handleViewMoreClick",value:function(){this.dispatchEvent(new CustomEvent("view-more"))}},{key:"headerTemplate",value:function(){return Qe(_l||(_l=x(['\n      <div id="header">\n        <bili-comments-header-renderer\n          .spmPrefix=',"\n          .hideSortTime=","\n          .oid=","\n          .type=","\n          .mode=","\n          .user=","\n          .upMid=","\n          .isClosed=","\n          .isSelected=","\n          .options=","\n          .notice=","\n          .vote=","\n          .count=","\n          .inputPlaceholder=","\n          .commentBoxDisabledState=","\n          .commentBoxTeleportDisabled=","\n          .uploadPicState=","\n          .goodsState=","\n          .scrollContainer=","\n          @mode-change=","\n          @notice-close=","\n          @action=","\n        ></bili-comments-header-renderer>\n      </div>\n    "])),this.spmPrefix,this.hideSortTime,this.oid,this.type,this.mode,this.user,this.upMid,this.isClosed,this.isSelected,this.globalOptions,this.notice,this.vote,this.count,this.rootInputPlaceholder,this.commentBoxDisabledState,this.maxViewLimit>0||!1===this.fixedCommentBox,this.rootInputUploadPicState,this.rootInputGoodsState,this.scrollContainer,this.handleModeChange,this.handleNoticeClose,this.handleGlobalAction)}},{key:"spinnerTemplate",value:function(){return Qe(El||(El=x(['<div id="spinner-container">\n      <div id="title"></div>\n      <bili-comments-spinner></bili-comments-spinner>\n    </div> '])))}},{key:"renderItem",value:function(t,e,n){var i=this;return Qe(Cl||(Cl=x(["<bili-comment-thread-renderer\n      .theme=","\n      .spmPrefix=","\n      .user=","\n      .assist=","\n      .upMid=","\n      .data=","\n      .visible=","\n      .oid=","\n      .type=","\n      .mode=","\n      .idx=","\n      .contentFeatures=","\n      .actionConfig=","\n      .extraTrackData=","\n      @delete=","\n      @top=","\n      @report=","\n      @block=","\n      @expand=","\n      @seek=","\n    ></bili-comment-thread-renderer>"])),this.theme,this.spmPrefix,this.user,this.assist,this.upMid,t,this.isVisibleItem(t.rpid_str),this.oid,this.type,this.mode,e,this.contentFeatures,this.actionConfig,this.commonTrackData,function(){return i.handleItemDelete(e,n)},function(t){return i.handleItemTop(e,n,t.detail)},function(t){return i.handleItemReport(t.detail)},function(t){return i.handleItemBlock(t.detail)},function(t){return i.handleTriggerEvent("expand",t.detail)},function(t){t.stopPropagation(),i.handleTriggerEvent("seek",t.detail)})}},{key:"limitMaskTemplate",value:function(){var t;return Qe(Tl||(Tl=x(['<div id="limit-mask">\n      <div id="limit-mask-wall"></div>\n      <div id="limit-mask-tip" @click=',">","</div>\n    </div>"])),this.handleLimitClick,null==(t=this.limitMaskState)?void 0:t.text)}},{key:"contentTemplate",value:function(){var t=this;return Qe(Sl||(Sl=x(['\n      <div id="contents">\n        <div id="new">\n          ','\n        </div>\n        <div id="feed">\n          ',"\n        </div>\n        ",'\n        <div id="reply-commentbox">\n          <bili-comment-box\n            style="padding: 25px 0 10px 80px;--bili-comment-box-display: none;"\n            .spmPrefix=',"\n            .oid=","\n            .type=","\n            .mode=","\n            .reply=","\n            .defaultInputValue=","\n            .voteOption=","\n            .keepActive=","\n            .user=","\n            .placeholder=","\n          ></bili-comment-box>\n        </div>\n      </div>\n    "])),Ha(this.newItems,function(t){return t.rpid_str},function(e,n){return t.renderItem(e,n,"new")}),Ha(this.list,function(t){return t.rpid_str},function(e,n){return t.renderItem(e,n,"feed")}),this.limitMaskState?this.limitMaskTemplate():"",this.spmPrefix,this.oid,this.type,this.mode,this.replyTarget,this.replyInputValue,this.voteOption,this.replyKeepActive,this.user,this.replyInputPlaceholder)}},{key:"continuationsTemplate",value:function(){return Qe(Ol||(Ol=x(['\n      <div id="continuations">\n        ',"\n        ","\n      </div>\n    "])),this.showContinuations?Qe(Pl||(Pl=x(['<div class="bottombar"></div>']))):"",this.showContinueTrigger?Qe(Il||(Il=x(['<div class="trigger"></div>']))):"")}},{key:"endTemplate",value:function(){return Qe(Rl||(Rl=x(['\n      <div id="end" class="','">\n        ',"\n      </div>\n    "])),this.maxViewLimit?"limit":"",this.showViewMore?Qe(jl||(jl=x(['<div class="bottombar clickable" @click=',"></div>"])),this.handleViewMoreClick):Qe(Dl||(Dl=x(['<div class="bottombar"></div>']))))}},{key:"render",value:function(){return Qe(Nl||(Nl=x(["\n      ","\n      ","\n    "])),this.showSpinner?this.spinnerTemplate():Qe(Ml||(Ml=x(["","",""])),this.headerTemplate(),this.contentTemplate()),this.showEnd?this.endTemplate():this.continuationsTemplate())}}]);var n,a,l,c,u,d,p,f,y,b,A,E,C,T}(gn);ym.styles=we(Ll||(Ll=x(['\n    :host {\n      -webkit-font-smoothing: antialiased;\n    }\n\n    #spinner-container #title {\n      margin: 0;\n      color: var(--text1);\n      font-weight: 500;\n      font-size: 20px;\n      margin-bottom: 20px;\n    }\n\n    #contents {\n      padding-top: 14px;\n      position: relative;\n    }\n\n    #reply-commentbox {\n      display: none;\n      height: 0;\n      overflow: hidden;\n      opacity: 0;\n    }\n\n    #limit-mask {\n      width: 100%;\n      position: absolute;\n      bottom: -36px;\n      left: 0;\n    }\n\n    #limit-mask-wall {\n      width: 100%;\n      height: 300px;\n    }\n    #limit-mask-wall::before {\n      display: block;\n      content: "";\n      height: 80%;\n      background: linear-gradient(180deg, rgba(255, 255, 255, 0) 0%, var(--bg1) 100%);\n    }\n    #limit-mask-wall::after {\n      display: block;\n      content: "";\n      height: 20%;\n      background: var(--bg1);\n    }\n    #limit-mask-tip {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin-left: 80px;\n      width: calc(100% - 80px);\n      height: 50px;\n      border-radius: 6px;\n      font-size: 14px;\n      color: var(--brand_blue);\n      background-color: var(--brand_blue_thin);\n      transition: 0.2s;\n      cursor: pointer;\n    }\n    .bottombar {\n      width: 100%;\n      margin-top: 20px;\n      font-size: 13px;\n      color: var(--text3);\n      text-align: center;\n      user-select: none;\n    }\n    .bottombar.clickable:hover {\n      cursor: pointer;\n      color: var(--brand_blue);\n    }\n    #continuations .trigger {\n      width: 100%;\n      height: 40px;\n    }\n    #end .bottombar {\n      padding-bottom: 100px;\n    }\n    #end.limit .bottombar {\n      padding-bottom: 20px;\n    }\n  ']))),mm([An()],ym.prototype,"scrollContainer",2),mm([An()],ym.prototype,"user",2),mm([An()],ym.prototype,"assist",2),mm([kn({attribute:"data-params"})],ym.prototype,"params",2),mm([An()],ym.prototype,"spmPrefix",2),mm([An()],ym.prototype,"mode",2),mm([An()],ym.prototype,"lazyLoad",2),mm([An()],ym.prototype,"maxViewLimit",2),mm([An()],ym.prototype,"theme",2),mm([An()],ym.prototype,"showSpinner",2),mm([An()],ym.prototype,"showContinuations",2),mm([An()],ym.prototype,"showContinueTrigger",2),mm([An()],ym.prototype,"contentFeatures",2),mm([An()],ym.prototype,"showEnd",2),mm([An()],ym.prototype,"upMid",2),mm([An()],ym.prototype,"globalOptions",2),mm([An()],ym.prototype,"notice",2),mm([An()],ym.prototype,"vote",2),mm([An()],ym.prototype,"count",2),mm([An()],ym.prototype,"hideSortTime",2),mm([An()],ym.prototype,"actionConfig",2),mm([An()],ym.prototype,"rootInputPlaceholder",2),mm([An()],ym.prototype,"inputDisabled",2),mm([An()],ym.prototype,"rootInputUploadPicState",2),mm([An()],ym.prototype,"limitMaskState",2),mm([An()],ym.prototype,"list",2),mm([An()],ym.prototype,"newItems",2),mm([An()],ym.prototype,"replyTarget",2),mm([An()],ym.prototype,"replyInputValue",2),mm([An()],ym.prototype,"replyKeepActive",2),mm([An()],ym.prototype,"replyInputPlaceholder",1),mm([An()],ym.prototype,"commentBoxDisabledState",2),mm([An()],ym.prototype,"fixedCommentBox",2),mm([An()],ym.prototype,"voteOption",1),mm([An()],ym.prototype,"commonTrackData",1),mm([Cn("#continuations .trigger")],ym.prototype,"continueTrigger",2),mm([Cn("#reply-commentbox")],ym.prototype,"replyCommentBoxContainer",2),ym=mm([xn("bili-comments")],ym);var bm=Object.defineProperty,gm=Object.getOwnPropertyDescriptor,wm=function(t,e,n,i){for(var r,o=i>1?void 0:i?gm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&bm(e,n,o),o},xm="bili-comments-bottom-fixed-wrapper",km=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.spmPrefix="",t.oid="",t.type=0,t.user=null,t.isClosed=!1,t.isSelected=!1,t.options=[],t.notice=null,t.vote=null,t.titleVisible=!0,t.hideSortTime=!1,t.count=0,t.mode=3,t.inputPlaceholder="",t.commentBoxDisabledState=null,t.commentBoxTeleportDisabled=!1,t.uploadPicState=1,t.goodsState=3,t.scrollContainer=null,t.commentboxInited=!1,t.revertTeleportCommentbox=null,t.showMoreMenu=!1,t.moreMenuInited=!1,t}return h(e,t),s(e,[{key:"voteOption",get:function(){return am(this.vote)}},{key:"sortClass",get:function(){return 3===this.mode?"hot":2===this.mode?"time":""}},{key:"connectedCallback",value:function(){w(e,"connectedCallback",this,3)([]),this.initCommentbox()}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose()}},{key:"update",value:function(t){w(e,"update",this,3)([t]),t.get("user")&&this.initCommentbox()}},{key:"initCommentbox",value:function(){var t=this;this.commentBoxDisabledState||this.commentboxInited||(this.commentboxInited=!0,!this.commentBoxTeleportDisabled&&setTimeout(function(){if(window.IntersectionObserver){var e=new IntersectionObserver(function(){var e=i(m().m(function e(n){var i,r,o,a,s,l;return m().w(function(e){for(;;)switch(e.n){case 0:if(!t.scrollContainer){e.n=2;break}if(i=t.scrollContainer.scrollTop,r=t.commentboxEl.offsetTop-t.scrollContainer.offsetTop,o=t.scrollContainer.clientHeight,!(r-i>o)){e.n=1;break}return e.a(2);case 1:e.n=3;break;case 2:if(a=t.commentboxEl.getBoundingClientRect(),s=a.top,l=window.innerHeight,!(s>=l)){e.n=3;break}return e.a(2);case 3:t.teleportCommentbox(n[0].isIntersecting);case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());e.observe(t.commentboxEl),t.disposables.add(function(){e.unobserve(t.commentboxEl),e.disconnect()}),t.disposables.addEventListener(window,"resize",function(){t.updateBottomFixedWrapperStyle()})}}))}},{key:"updateBottomFixedWrapperStyle",value:function(){var t;if(this.commentboxEl&&this.revertTeleportCommentbox){var e=((null==(t=this.scrollContainer)?void 0:t.parentElement)||this.shadowRoot).querySelector(".".concat(xm));if(e){var n=this.commentboxEl.getBoundingClientRect(),i=n.width,r=n.left;e.style.width="".concat(i,"px"),e.style.left="".concat(r,"px")}}}},{key:"teleportCommentbox",value:function(t){var e,n=this;if(t)return null==(e=this.revertTeleportCommentbox)||e.call(this),void(this.revertTeleportCommentbox=null);var i=this.commentboxEl.children[0],r=this.commentboxEl.getBoundingClientRect(),o=r.width,a=r.height,s=r.left;this.commentboxEl.style.setProperty("--bili-comments-commentbox-height","".concat(a,"px"));var l=document.createElement("div");l.className=xm,l.style.position=this.scrollContainer?"absolute":"fixed",l.style.bottom="0",l.style.left="".concat(s,"px"),l.style.width="".concat(o,"px"),l.style.zIndex="1";var c=document.createElement("div");c.appendChild(i),c.style.width="100%",c.style.padding="15px 0",c.style.position="relative",c.style.backgroundColor="var(--bg1)",c.style.borderTop="0.5px solid var(--graph_bg_thick)",l.appendChild(c);var u=this.shadowRoot,d=!1;this.scrollContainer&&this.scrollContainer.parentElement&&this.scrollContainer.parentElement!==document.body&&(u=this.scrollContainer.parentElement,"static"===getComputedStyle(u).position&&(d=!0,u.style.position="relative")),u.appendChild(l),this.revertTeleportCommentbox=function(){n.commentboxEl.appendChild(i),u.removeChild(l),d&&u instanceof HTMLElement&&(u.style.position=""),n.commentboxEl.style.setProperty("--bili-comments-commentbox-height","".concat(i.clientHeight,"px")),setTimeout(function(){n.commentboxEl.style.removeProperty("--bili-comments-commentbox-height")},300)}}},{key:"handleChangeMode",value:function(t){this.mode!==t&&this.dispatchEvent(new CustomEvent("mode-change",{detail:t}))}},{key:"handleSelectOption",value:function(t){this.showMoreMenu=!1,this.dispatchEvent(new CustomEvent("action",{detail:t.detail}))}},{key:"handleNoticeClose",value:function(){this.dispatchEvent(new CustomEvent("notice-close"))}},{key:"handleLogin",value:function(){fd({event:"selfDef.relpyInputClick",spmPrefix:this.spmPrefix})}},{key:"noticeTemplate",value:function(){return Qe(Bl||(Bl=x(['\n      <div id="notice">\n        ',"\n      </div>\n    "])),Qe(zl||(zl=x(["<bili-comments-notice\n          .data=","\n          .spmPrefix=","\n          @close=","\n        ></bili-comments-notice>"])),this.notice,this.spmPrefix,this.handleNoticeClose))}},{key:"voteTemplate",value:function(){return Qe(Ul||(Ul=x(['\n      <div id="vote">\n        ',"\n      </div>\n    "])),Qe(Fl||(Fl=x(["<bili-comments-vote-card\n          .spmPrefix=","\n          .data=","\n          .oid=","\n          .type=","\n          .user=","\n        ></bili-comments-vote-card>"])),this.spmPrefix,this.vote,this.oid,this.type,this.user))}},{key:"sortTemplate",value:function(){var t=this;return this.isClosed?"":this.isSelected?Qe(Vl||(Vl=x(['<div id="sort-title"></div>']))):this.hideSortTime?Qe(Hl||(Hl=x(['<div id="sort-title" class="single"></div>']))):Qe(Wl||(Wl=x(['<div\n      id="sort-actions"\n      class=',"\n    >\n      <bili-text-button @click=",'></bili-text-button>\n      <div class="sort-div"></div>\n      <bili-text-button @click=',"></bili-text-button>\n    </div>"])),this.sortClass?Ta(c({},this.sortClass,!0)):"",function(){return t.handleChangeMode(3)},function(){return t.handleChangeMode(2)})}},{key:"navbarTemplate",value:function(){var t=this;return Qe($l||($l=x(['\n      <div id="navbar">\n        ',"\n        ","\n        ","\n      </div>\n    "])),this.titleVisible&&Qe(Gl||(Gl=x(['\n          <div id="title">\n            <h2></h2>\n            <div id="count">',"</div>\n          </div>\n        "])),this.count),this.sortTemplate(),this.options.length?Qe(ql||(ql=x([' <div id="more">\n              <button\n                @click=','\n              >\n                <bili-icon size="16" icon="BDC/more_vertical_fill/1"></bili-icon>\n              </button>\n              <bili-comment-menu\n                style="','"\n                .options=',"\n                @select=","\n                @mouseleave=","\n              ></bili-comment-menu>\n            </div>"])),function(){t.showMoreMenu=!0},this.showMoreMenu?Zn({"--bili-comment-menu-display":"block"}):"",this.options,this.handleSelectOption,function(){t.showMoreMenu=!1}):"")}},{key:"disabledCommentboxTemplate",value:function(){var t,e,n;return Qe(Xl||(Xl=x(['\n      <div id="disabled-commentbox">\n        <div id="user-avatar">\n          <img\n            src="','"\n            width="48"\n            height="48"\n          />\n        </div>\n        ',"\n      </div>\n    "])),Ei.getBmgSrcNext((null==(t=this.user)?void 0:t.face)||"//i0.hdslb.com/bfs/face/member/noface.jpg",{w:48,h:48,dpr:2}),"unlogin"===(null==(e=this.commentBoxDisabledState)?void 0:e.source)?Qe(Zl||(Zl=x(['<div id="edit">\n              <div></div>\n              <button @click=',"></button>\n              <div> ()</div>\n            </div>"])),this.handleLogin):Qe(Yl||(Yl=x(['<div id="edit">\n              <div>',"</div>\n            </div>"])),(null==(n=this.commentBoxDisabledState)?void 0:n.message)||""))}},{key:"commentboxTemplate",value:function(){return Qe(Ql||(Ql=x(['\n      <div id="commentbox">\n        ',"\n      </div>\n    "])),this.commentBoxDisabledState?this.disabledCommentboxTemplate():Qe(Kl||(Kl=x(["<bili-comment-box\n              .spmPrefix=","\n              .oid=","\n              .type=","\n              .mode=","\n              .user=","\n              .placeholder=","\n              .uploadPicState=","\n              .goodsState=","\n              .voteOption=","\n              .scrollContainer=","\n            ></bili-comment-box>"])),this.spmPrefix,this.oid,this.type,this.mode,this.user,this.inputPlaceholder,this.uploadPicState,this.goodsState,this.voteOption,this.scrollContainer))}},{key:"render",value:function(){return Qe(Jl||(Jl=x(["\n      "," "," "," ","\n    "])),this.notice?this.noticeTemplate():"",this.vote&&this.voteTemplate(),this.navbarTemplate(),this.commentboxTemplate())}}])}(gn);km.styles=we(tc||(tc=x(["\n    #notice {\n      margin-bottom: 10px;\n    }\n    #vote {\n      margin-bottom: 24px;\n    }\n    #navbar {\n      display: flex;\n      align-items: center;\n      height: 28px;\n      margin-bottom: 22px;\n    }\n    #title {\n      display: var(--bili-comments-title-display, flex);\n      align-items: center;\n    }\n    #title h2 {\n      margin: 0;\n      color: var(--text1);\n      font-weight: 500;\n      font-size: var(--bili-comments-font-size-title, 20px);\n    }\n    #title #count {\n      margin: 0 30px 0 6px;\n      font-size: var(--bili-comments-font-size-count, 13px);\n      font-weight: 400;\n      color: var(--text3);\n    }\n\n    #sort-title {\n      font-weight: 500;\n      color: var(--text1);\n    }\n    #sort-title.single {\n      font-weight: 400;\n      font-size: var(--bili-comments-font-size-sort, 13px);\n    }\n\n    #sort-actions .sort-div {\n      display: inline-block;\n      height: 11px;\n      margin: 0 3px;\n      border-left: solid 1px var(--text3);\n      vertical-align: -2px;\n    }\n\n    #sort-actions bili-text-button {\n      --_container-height: 28px;\n      --_leading-space: 6px;\n      --_trailing-space: 6px;\n      --_label-text-size: var(--bili-comments-font-size-sort, 13px);\n      --_label-text-color: var(--text3);\n    }\n\n    #sort-actions.hot bili-text-button:first-child {\n      --_label-text-color: var(--text1);\n    }\n    #sort-actions.time bili-text-button:last-child {\n      --_label-text-color: var(--text1);\n    }\n    #commentbox {\n      flex-shrink: 0;\n      transition: height 0.2s;\n      height: var(--bili-comments-commentbox-height, auto);\n    }\n    #more {\n      margin-left: auto;\n      width: 24px;\n      height: 24px;\n      position: relative;\n    }\n    #more button {\n      width: 24px;\n      height: 24px;\n      text-align: center;\n      padding: 0;\n      outline: none;\n      border: none;\n      background: transparent;\n      font-size: 13px;\n      color: var(--text3);\n      display: inline-flex;\n      align-items: center;\n      cursor: pointer;\n      justify-content: end;\n    }\n    #disabled-commentbox {\n      display: flex;\n      height: 50px;\n    }\n    #disabled-commentbox #user-avatar {\n      flex-shrink: 0;\n      width: 80px;\n      height: 50px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #disabled-commentbox #user-avatar img {\n      border-radius: 50%;\n    }\n    #disabled-commentbox #edit {\n      flex: 1;\n      height: 100%;\n      border-radius: 6px;\n      font-size: 12px;\n      color: var(--text3);\n      background-color: var(--bg3);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    #disabled-commentbox #edit button {\n      box-sizing: border-box;\n      padding: 4px 9px;\n      margin: 0 3px;\n      border-radius: 4px;\n      color: var(--text_white);\n      background-color: var(--brand_blue);\n      outline: none;\n      border: none;\n      cursor: pointer;\n      font-size: 12px;\n    }\n    #disabled-commentbox #edit button:hover {\n      background-color: var(--Lb4);\n    }\n  "]))),wm([kn({type:String})],km.prototype,"spmPrefix",2),wm([kn()],km.prototype,"oid",2),wm([kn()],km.prototype,"type",2),wm([kn()],km.prototype,"user",2),wm([kn()],km.prototype,"isClosed",2),wm([kn()],km.prototype,"isSelected",2),wm([kn()],km.prototype,"options",2),wm([kn()],km.prototype,"notice",2),wm([kn()],km.prototype,"vote",2),wm([kn({type:Boolean})],km.prototype,"titleVisible",2),wm([kn({type:Boolean})],km.prototype,"hideSortTime",2),wm([kn({type:Number})],km.prototype,"count",2),wm([kn({type:String})],km.prototype,"mode",2),wm([kn({type:String})],km.prototype,"inputPlaceholder",2),wm([kn({type:Object})],km.prototype,"commentBoxDisabledState",2),wm([kn({type:Boolean})],km.prototype,"commentBoxTeleportDisabled",2),wm([kn({type:Number})],km.prototype,"uploadPicState",2),wm([kn({type:Number})],km.prototype,"goodsState",2),wm([An()],km.prototype,"voteOption",1),wm([kn()],km.prototype,"scrollContainer",2),wm([An()],km.prototype,"showMoreMenu",2),wm([An()],km.prototype,"sortClass",1),wm([Cn("#commentbox")],km.prototype,"commentboxEl",2),km=wm([xn("bili-comments-header-renderer")],km);var Am=Object.defineProperty,_m=Object.getOwnPropertyDescriptor,Em=function(t,e,n,i){for(var r,o=i>1?void 0:i?_m(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Am(e,n,o),o},Cm=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).i18r=null,t.isIntersecting=!1,t.isReported=!1,t.spmPrefix="",t}return h(e,t),s(e,[{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),window.IntersectionObserver&&(this.i18r=new IntersectionObserver(function(e){var n=e[0];n&&n.target===t&&(t.isIntersecting=n.isIntersecting,!t.isReported&&n.isIntersecting&&t.cmReport())}),this.i18r.observe(this))}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.clearI18r(),this.isReported=!1}},{key:"clearI18r",value:function(){this.isIntersecting=!1,this.i18r&&(this.i18r.disconnect(),this.i18r=null)}},{key:"cmReport",value:function(){var t,e=this;if(null!=(t=window.BiliCm)&&t.Base){this.isReported=!0;var n=this.data,i=n.isEmpty,r=n.data,o=n.locId;window.BiliCm.Base.sendShowData(r,o),i?this.clearI18r():setTimeout(function(){var t;null!=(t=window.BiliCm)&&t.Base&&(e.isIntersecting&&window.BiliCm.Base.sendStrictShowData(r,o),e.clearI18r())},1e3)}}},{key:"handleJump",value:function(){Vu("playpage_anoun"),Wu("show","comments.notice.show",{},{spmPrefix:this.spmPrefix});var t=function(t,e){return window.BiliCm?window.BiliCm.Base.getSyncUrl(t,e):t.url}(this.data.data,this.data.locId);t&&window.open(t,"_blank")}},{key:"handleClose",value:function(t){t.stopPropagation(),this.dispatchEvent(new CustomEvent("close"))}},{key:"render",value:function(){return Qe(ec||(ec=x(['\n      <div\n        id="bar"\n        style=',"\n        @click=",'\n      >\n        <div id="bg"></div>\n        <bili-icon icon="BDC/speaker_notice_fill/1" size="14"></bili-icon>\n        <div id="title">','</div>\n        <div id="close" @click=','>\n          <bili-icon icon="BDC/xmark_close_line/1" size="16"></bili-icon>\n        </div>\n      </div>\n    '])),Zn({display:this.data.isEmpty?"none":"flex"}),this.handleJump,this.data.title,this.handleClose)}}])}(gn);Cm.styles=we(nc||(nc=x(["\n    :host {\n      display: block;\n    }\n    #bar {\n      display: flex;\n      align-items: center;\n      position: relative;\n      height: 40px;\n      padding: 0 10px;\n      font-size: 12px;\n      color: var(--Ye5_u);\n      cursor: pointer;\n    }\n    #bg {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border-radius: 2px;\n      background-color: var(--Ye5_u);\n      opacity: 0.2;\n      pointer-events: none;\n    }\n    #title {\n      position: relative;\n      z-index: 1;\n      margin-right: auto;\n      flex: 1;\n      padding: 0 5px;\n      vertical-align: top;\n      word-wrap: break-word;\n      word-break: break-all;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    #close {\n      position: relative;\n      z-index: 1;\n      display: flex;\n    }\n  "]))),Em([kn()],Cm.prototype,"spmPrefix",2),Em([kn()],Cm.prototype,"data",2),Cm=Em([xn("bili-comments-notice")],Cm);var Tm=Object.defineProperty,Sm=Object.getOwnPropertyDescriptor,Om=function(t,e,n,i){for(var r,o=i>1?void 0:i?Sm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Tm(e,n,o),o},Pm=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).mask=!1,t.maskClosable=!0,t.titleText="",t.width="600px",t.minWidth="300px",t.transparent=!1,t}return h(e,t),s(e,[{key:"handleClose",value:function(){this.maskClosable&&this.hide()}},{key:"hide",value:function(){this.parentElement&&this.parentElement.removeChild(this)}},{key:"connectedCallback",value:function(){w(e,"connectedCallback",this,3)([]),this.initData()}},{key:"initData",value:function(){var t=this.getAttribute("title"),e=this.getAttribute("width"),n=this.getAttribute("min-width"),i="true"===this.getAttribute("transparent");t&&(this.titleText=t),e&&(this.width=e),n&&(this.minWidth=n),i&&(this.transparent=!0)}},{key:"render",value:function(){return Qe(ic||(ic=x(["\n      ",'\n      <div\n        id="wrap"\n        class="','"\n        style="','"\n      >\n        ','\n        <div id="content">\n          <slot></slot>\n        </div>\n      </div>\n    '])),this.mask?Qe(rc||(rc=x(['<div id="mask" @click=',"></div>"])),this.handleClose):Qe(oc||(oc=x([""]))),this.titleText?"":"overflow",Zn({width:this.width,minWidth:this.minWidth,background:this.transparent?"transparent":"var(--bg1)"}),this.titleText?Qe(ac||(ac=x(['<div id="header">\n              <div id="title">','</div>\n              <div id="close" @click=','><bili-icon icon="BDC/xmark_close_line/1" size="22"></bili-icon></div>\n            </div>'])),this.titleText,this.hide):Qe(sc||(sc=x(['<div id="close" class="outer" @click=','><bili-icon icon="BDC/xmark_close_line/1" size="22"></bili-icon></div>'])),this.hide))}}])}(gn);Pm.styles=we(lc||(lc=x(["\n    :host {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #mask {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background-color: rgba(0, 0, 0, 0.5);\n    }\n    #wrap {\n      position: relative;\n      width: 100%;\n      max-height: calc(100vh - 40px);\n      border-radius: 6px;\n      box-shadow: 0 0 25px #00000026;\n      background-color: var(--bg1);\n      overflow: hidden;\n      display: flex;\n      flex-direction: column;\n    }\n    #wrap.overflow {\n      overflow: initial;\n    }\n    #header {\n      box-sizing: border-box;\n      width: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 16px;\n      height: 50px;\n      flex-shrink: 0;\n      padding: 0 10px;\n      position: relative;\n      color: var(--text1);\n    }\n    #close {\n      cursor: pointer;\n      position: absolute;\n      right: 10px;\n      color: var(--text2);\n    }\n    #close.outer {\n      top: -30px;\n      right: 0;\n    }\n    #content {\n      height: calc(100% - 50px);\n      overflow-y: auto;\n    }\n    ::slotted(iframe) {\n      width: 100%;\n      height: 100%;\n      border: none;\n    }\n  "]))),Om([kn({type:Boolean})],Pm.prototype,"mask",2),Om([kn({type:Boolean})],Pm.prototype,"maskClosable",2),Om([kn()],Pm.prototype,"titleText",2),Om([An()],Pm.prototype,"width",2),Om([An()],Pm.prototype,"minWidth",2),Om([An()],Pm.prototype,"transparent",2),Pm=Om([xn("bili-comments-popup")],Pm);var Im=Object.defineProperty,Rm=Object.getOwnPropertyDescriptor,jm=function(t,e,n,i){for(var r,o=i>1?void 0:i?Rm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Im(e,n,o),o},Dm=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.src="",t.width="300px",t.height="",t.onmessage=function(t){},t.loaded=!1,t}return h(e,t),s(e,[{key:"handleLoad",value:function(){var t=this;au(200).then(function(){t.loaded=!0})}},{key:"handleClose",value:function(){this.remove()}},{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),document.body.style.overflow="hidden",this.disposables.addEventListener(window,"message",function(e){var n;-1===e.origin.indexOf("bilibili.com")||(null==(n=t.iframe)?void 0:n.contentWindow)!==e.source||t.onmessage(e)}),this.disposables.add(function(){document.body.style.overflow=""})}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose()}},{key:"loadingTemplate",value:function(){return Qe(cc||(cc=x(['<div\n      id="loading"\n      style=','\n    >\n      <div id="close" @click=','>\n        <bili-icon icon="BDC/xmark_close_line/1" size="24"> </bili-icon>\n      </div>\n      <bili-comments-spinner></bili-comments-spinner>\n    </div>'])),Zn({width:this.width,height:this.height}),this.handleClose)}},{key:"render",value:function(){return Qe(uc||(uc=x(['\n      <div id="wrap">\n        <div\n          id="window"\n          style=','\n        >\n          <iframe src="','" @load=',"></iframe>\n        </div>\n        ","\n      </div>\n    "])),Zn({opacity:this.loaded?1:0}),this.src,this.handleLoad,this.loaded?"":this.loadingTemplate())}}])}(gn);Dm.styles=we(dc||(dc=x(["\n    #wrap {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      z-index: 10000;\n    }\n    #window {\n      width: 100%;\n      height: 100%;\n    }\n    iframe {\n      width: 100%;\n      height: 100%;\n      border: none;\n    }\n    #loading {\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background-color: var(--bg1_float);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #close {\n      position: absolute;\n      top: 12px;\n      right: 12px;\n      cursor: pointer;\n      display: flex;\n      color: var(--text2);\n    }\n  "]))),jm([kn({type:String,attribute:"iframe-src"})],Dm.prototype,"src",2),jm([kn({type:String,attribute:"iframe-width"})],Dm.prototype,"width",2),jm([kn({type:String,attribute:"iframe-height"})],Dm.prototype,"height",2),jm([kn({type:Function})],Dm.prototype,"onmessage",2),jm([An()],Dm.prototype,"loaded",2),jm([Cn("#window iframe")],Dm.prototype,"iframe",2),customElements.get("bili-comments-webview")||customElements.define("bili-comments-webview",Dm);var Nm=Object.defineProperty,Mm=Object.getOwnPropertyDescriptor,Lm=function(t){function e(){return o(this,e),r(this,e,arguments)}return h(e,t),s(e,[{key:"render",value:function(){return Qe(hc||(hc=x(['\n      <div id="spinner">\n        <img width="24" height="24" src="//i0.hdslb.com/bfs/static/jinkela/long/gif/loading-blue.gif" />\n        <span></span>\n      </div>\n    '])))}}])}(gn);Lm.styles=we(pc||(pc=x(["\n    #spinner {\n      padding: 20px 0;\n      width: 100%;\n      text-align: center;\n      font-size: 14px;\n      color: var(--text3);\n    }\n    #spinner img {\n      margin-right: 8px;\n      vertical-align: bottom;\n    }\n  "]))),Lm=function(t,e,n,i){for(var r,o=i>1?void 0:i?Mm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Nm(e,n,o),o}([xn("bili-comments-spinner")],Lm);var Bm=Object.defineProperty,zm=Object.getOwnPropertyDescriptor,Um=function(t,e,n,i){for(var r,o=i>1?void 0:i?zm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Bm(e,n,o),o},Fm=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).spmPrefix="",t.oid="",t.type=0,t.user=null,t}return h(e,t),s(e,[{key:"isDuel",get:function(){return 2===this.data.options.length}},{key:"optionIdx",get:function(){return this.data.my_vote_option||0}},{key:"handleClick",value:function(){dh(this.data.vote_id)}},{key:"handleOptionClick",value:(n=i(m().m(function t(e){var n,i;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.user){t.n=1;break}return fd({event:"selfDef.voteCardClick",spmPrefix:this.spmPrefix}),t.a(2);case 1:if(!(this.optionIdx>0)){t.n=2;break}return t.a(2);case 2:return n=e.idx,t.p=3,t.n=4,wu({option:n,vote_id:this.data.vote_id,oid:this.oid,type:this.type});case 4:this.data.my_vote_option=n,this.data.count?this.data.count+=1:this.data.count=1,this.data.options[n-1].count?this.data.options[n-1].count+=1:this.data.options[n-1].count=1,this.requestUpdate(),t.n=6;break;case 5:t.p=5,i=t.v,console.error(i);case 6:return t.a(2)}},t,this,[[3,5]])})),function(t){return n.apply(this,arguments)})},{key:"duelOptionTemplate",value:function(t){var e=this,n=this.optionIdx,i=0!==n,r="".concat(n?Math.round((t.count||0)/this.data.count*100):50,"%");return Qe(fc||(fc=x(['<div\n      class="','"\n      style="','"\n      @click=','\n    >\n      <div class="option-info">\n        <div class="option-desc">',"</div>\n        ",'\n      </div>\n      <div class="option-skew">\n        <div class="option-skew-fill"></div>\n      </div>\n      ',"\n    </div>"])),Ta(c({option:!0},1===t.idx?"left":"right",!0)),i?Zn({"--option-opacity":".8","--option-width":r,"--option-color":"var(--text_white)","--option-font-size":"12px","--option-cursor":"default"}):"",function(){return e.handleOptionClick(t)},t.desc,i?Qe(vc||(vc=x(['<div class="option-ratio">',"</div>"])),r):"",t.idx===n?Qe(mc||(mc=x(['<bili-icon icon="BDC/checkmark_circle_fill/1" size="20"></bili-icon>']))):"")}},{key:"duelTemplate",value:function(){var t=this;return Qe(yc||(yc=x(['<div id="duel">',"</div>"])),this.data.options.map(function(e){return t.duelOptionTemplate(e)}))}},{key:"render",value:function(){return Qe(bc||(bc=x(['\n      <div id="card">\n        <div id="info">\n          <div id="title">\n            <bili-icon icon="BDC/vote_line/2" size="16"></bili-icon>\n            <span>',"</span>\n          </div>\n          ","\n        </div>\n        ","\n      </div>\n    "])),this.data.title,this.isDuel?Qe(gc||(gc=x(['<div id="desc">\n                <div id="count">',"</div>\n              </div>"])),this.data.count||0):Qe(wc||(wc=x(['<div id="desc">\n                <div id="count">','</div>\n                <div id="split">|</div>\n                ',"\n              </div>"])),this.data.count||0,this.optionIdx>0?Qe(xc||(xc=x(['<div id="status"> &nbsp;</div>\n                      <bili-text-button .trailingIcon=',' id="action" @click=','>\n                         <bili-icon slot="icon" icon="BDC/arrow_forward_right_line/3" size="12"></bili-icon\n                      ></bili-text-button> '])),!0,this.handleClick):Qe(kc||(kc=x(['<bili-text-button id="action" @click=',"></bili-text-button>"])),this.handleClick)),this.isDuel?this.duelTemplate():"")}}]);var n}(gn);Fm.styles=we(Ac||(Ac=x(["\n    :host {\n      --option-opacity: 0.15;\n      --option-width: 50%;\n      --option-radius: 6px;\n      --option-font-size: 13px;\n      --option-color: var(--Pi10_u);\n      --option-cursor: pointer;\n    }\n    #card {\n      width: 100%;\n      height: 80px;\n      display: flex;\n      border-radius: 6px;\n      background-color: var(--graph_bg_thin);\n      padding: 12px 16px 12px 10px;\n      box-sizing: border-box;\n      align-items: center;\n    }\n\n    #info {\n      flex: 1;\n      color: var(--option-color);\n    }\n\n    #duel {\n      flex-shrink: 0;\n      width: 60%;\n      margin-left: 30px;\n      height: 40px;\n      display: flex;\n    }\n\n    #info #title {\n      color: var(--text1);\n      font-size: 13px;\n      display: flex;\n      align-items: center;\n    }\n    #info #title span {\n      margin-left: 2px;\n    }\n    #info #desc {\n      margin-top: 4px;\n      color: var(--text3);\n      display: flex;\n      font-size: 12px;\n      align-items: center;\n    }\n    #info #desc #split {\n      color: var(--line_regular);\n      margin: 0px 6px;\n    }\n\n    #duel .option {\n      position: relative;\n      display: flex;\n      min-width: 120px;\n      align-items: center;\n      justify-content: space-between;\n      height: 40px;\n      width: var(--option-width);\n      color: var(--option-color);\n      font-size: var(--option-font-size);\n      cursor: var(--option-cursor);\n    }\n    #duel .option.left {\n      margin-right: 30px;\n      padding-left: 10px;\n      border-radius: var(--option-radius) 0 0 var(--option-radius);\n      background-color: rgba(255, 102, 153, var(--option-opacity));\n    }\n    #duel .option.right {\n      flex-direction: row-reverse;\n      text-align: right;\n      padding-right: 10px;\n      border-radius: 0 var(--option-radius) var(--option-radius) 0;\n      background-color: rgba(0, 174, 236, var(--option-opacity));\n    }\n    #duel .option-skew {\n      position: absolute;\n      top: 0;\n      height: 100%;\n      width: 20px;\n      overflow: hidden;\n      opacity: var(--option-opacity);\n      pointer-events: none;\n    }\n    #duel .option-skew-fill {\n      pointer-events: all;\n      position: absolute;\n      top: 0;\n      width: 100%;\n      height: 100%;\n    }\n    #duel .option.left .option-skew {\n      right: -20px;\n    }\n    #duel .option.right .option-skew {\n      left: -20px;\n    }\n    #duel .option.left .option-skew-fill {\n      left: -8px;\n      background-color: #f69;\n      transform: skew(21deg);\n      border-top-right-radius: calc(var(--option-radius) - 2px);\n      border-bottom-right-radius: var(--option-radius);\n    }\n    #duel .option.right .option-skew-fill {\n      left: 8px;\n      background-color: #00aeec;\n      transform: skew(21deg);\n      border-top-left-radius: var(--option-radius);\n      border-bottom-left-radius: calc(var(--option-radius) - 2px);\n    }\n  "]))),Um([kn({type:String})],Fm.prototype,"spmPrefix",2),Um([kn({type:Object})],Fm.prototype,"data",2),Um([kn()],Fm.prototype,"oid",2),Um([kn()],Fm.prototype,"type",2),Um([kn()],Fm.prototype,"user",2),Um([An()],Fm.prototype,"isDuel",1),Um([An()],Fm.prototype,"optionIdx",1),Fm=Um([xn("bili-comments-vote-card")],Fm);var Vm=Object.defineProperty,Hm=Object.getOwnPropertyDescriptor,Wm=function(t,e,n,i){for(var r,o=i>1?void 0:i?Hm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&Vm(e,n,o),o},$m=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.defaultValue="",t.value="",t.nodes=[],t.placeholder="",t.rows=1,t.isFocus=!1,t.selection={startIndex:0,startOffset:0,endIndex:0,endOffset:0,collapsed:!0},t}return h(e,t),s(e,[{key:"getSelection",value:function(){return v({},this.selection)}},{key:"update",value:function(t){if(w(e,"update",this,3)([t]),this.brt&&t.get("placeholder")){if(!this.placeholder)return;var n={raw:this.defaultValue,nodes:this.defaultValue?[{type:wp.NodeType.TEXT,raw:this.defaultValue}]:[]};this.brt.update({placeholder:this.placeholder,value:n})}}},{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),this.value=this.defaultValue,window.setTimeout(function(){t.initEditor()})}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose()}},{key:"initEditor",value:function(){var t=this;this.brt=new wp({value:this.nodes.length?{nodes:this.nodes}:this.defaultValue?{raw:this.defaultValue}:void 0,placeholder:this.placeholder,autosize:!0}).mount(this.input),this.brt.addEventListener("change",function(e){var n=e.detail,i=n.raw,r=n.nodes;t.value=i,t.nodes=r,t.dispatchEvent(new CustomEvent("change",{detail:{raw:i,nodes:k(r)}}))}),this.brt.addEventListener("selection-change",function(e){t.selection={startIndex:e.detail.startIndex,startOffset:e.detail.startOffset,endIndex:e.detail.endIndex,endOffset:e.detail.endOffset,collapsed:e.detail.collapsed},t.dispatchEvent(new CustomEvent("selection-change",{detail:e.detail}))}),this.brt.addEventListener("focus-change",function(e){t.isFocus=e.detail,t.dispatchEvent(new CustomEvent("focus-change",{detail:e.detail}))}),this.disposables.add(function(){t.brt&&t.brt.unmount()})}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.brt&&this.brt.dispatchAction({type:"setContent",args:[{raw:"",nodes:t}]})}},{key:"focus",value:function(){this.brt&&this.brt.dispatchAction({type:"focus"})}},{key:"blur",value:function(){this.brt&&this.brt.dispatchAction({type:"blur"})}},{key:"insertNodes",value:function(t,e){this.brt&&this.brt.dispatchAction({type:"insertNodes",args:[k(t),e]})}},{key:"insertText",value:function(t,e){this.insertNodes([{type:"text",raw:t}],e)}},{key:"render",value:function(){return Qe(_c||(_c=x(['\n      <div\n        id="input"\n        class="','"\n      ></div>\n    '])),Ta({active:!!this.value}))}}])}(gn);$m.styles=we(Ec||(Ec=x(['\n    :host {\n      --bili-comment-textarea-bg: transparent;\n      --bili-comment-textarea-color: var(--text1);\n      --bili-comment-textarea-placeholder-color: var(--text3);\n      --bili-comment-textarea-padding: 8px;\n      --bili-comment-textarea-font-size: 14px;\n      --brt-line-height: 32px;\n    }\n    :host {\n      display: flex;\n    }\n    #input {\n      min-height: 32px;\n      max-height: 100px;\n      line-height: 32px;\n      width: 100%;\n      font-size: var(--bili-comment-textarea-font-size);\n      font-family: inherit;\n      box-sizing: border-box;\n      color: var(--bili-comment-textarea-color);\n      background-color: var(--bili-comment-textarea-bg);\n    }\n    #input.active {\n      --brt-line-height: normal;\n    }\n    .brt-root {\n      position: relative;\n    }\n\n    .brt-placeholder {\n      position: absolute;\n      left: var(--brt-editor-padding-hrz, 8px);\n      top: var(--brt-editor-padding-vtc, 0);\n      color: var(--brt-placeholder-color, var(--text3, #9499a0));\n      font-size: var(--brt-font-size, 14px);\n      line-height: var(--brt-line-height, 20px);\n      pointer-events: none;\n    }\n    .brt-editor {\n      outline: none;\n      border: none;\n      box-sizing: border-box;\n      padding: var(--brt-editor-padding-vtc, 0) var(--brt-editor-padding-hrz, 8px);\n      font-size: var(--brt-font-size, 14px);\n      line-height: var(--brt-line-height, 20px);\n      min-height: var(--brt-line-height, 20px);\n      overflow-y: auto;\n      max-height: 100px;\n    }\n\n    .brt-editor .brt-hl {\n      color: var(--text_link, #008ac5);\n    }\n\n    .brt-hl.goods::before {\n      font-family: "pc-comments-cljzkg6fxb9";\n      content: "\\e000";\n      text-rendering: geometricPrecision;\n    }\n\n    .brt-editor img {\n      vertical-align: text-bottom;\n    }\n\n    .brt-editor a {\n      color: var(--text_link, #008ac5);\n      text-decoration: none;\n    }\n  '],['\n    :host {\n      --bili-comment-textarea-bg: transparent;\n      --bili-comment-textarea-color: var(--text1);\n      --bili-comment-textarea-placeholder-color: var(--text3);\n      --bili-comment-textarea-padding: 8px;\n      --bili-comment-textarea-font-size: 14px;\n      --brt-line-height: 32px;\n    }\n    :host {\n      display: flex;\n    }\n    #input {\n      min-height: 32px;\n      max-height: 100px;\n      line-height: 32px;\n      width: 100%;\n      font-size: var(--bili-comment-textarea-font-size);\n      font-family: inherit;\n      box-sizing: border-box;\n      color: var(--bili-comment-textarea-color);\n      background-color: var(--bili-comment-textarea-bg);\n    }\n    #input.active {\n      --brt-line-height: normal;\n    }\n    .brt-root {\n      position: relative;\n    }\n\n    .brt-placeholder {\n      position: absolute;\n      left: var(--brt-editor-padding-hrz, 8px);\n      top: var(--brt-editor-padding-vtc, 0);\n      color: var(--brt-placeholder-color, var(--text3, #9499a0));\n      font-size: var(--brt-font-size, 14px);\n      line-height: var(--brt-line-height, 20px);\n      pointer-events: none;\n    }\n    .brt-editor {\n      outline: none;\n      border: none;\n      box-sizing: border-box;\n      padding: var(--brt-editor-padding-vtc, 0) var(--brt-editor-padding-hrz, 8px);\n      font-size: var(--brt-font-size, 14px);\n      line-height: var(--brt-line-height, 20px);\n      min-height: var(--brt-line-height, 20px);\n      overflow-y: auto;\n      max-height: 100px;\n    }\n\n    .brt-editor .brt-hl {\n      color: var(--text_link, #008ac5);\n    }\n\n    .brt-hl.goods::before {\n      font-family: "pc-comments-cljzkg6fxb9";\n      content: "\\\\e000";\n      text-rendering: geometricPrecision;\n    }\n\n    .brt-editor img {\n      vertical-align: text-bottom;\n    }\n\n    .brt-editor a {\n      color: var(--text_link, #008ac5);\n      text-decoration: none;\n    }\n  ']))),Wm([Cn("#input")],$m.prototype,"input",2),Wm([kn({type:String})],$m.prototype,"defaultValue",2),Wm([An()],$m.prototype,"value",2),Wm([kn({type:Array})],$m.prototype,"nodes",2),Wm([kn({type:String})],$m.prototype,"placeholder",2),Wm([An()],$m.prototype,"rows",2),$m=Wm([xn("bili-comment-rich-textarea")],$m);var Gm=function(){return s(function t(e){var n=this;if(o(this,t),this.disposables=Rn(),"TEXTAREA"!==e.tagName)throw new Error("TextareaAutoSize can only be used on textarea elements");this.element=e,this.verticalBorderSize=this.getStyleProp("borderTopWidth")+this.getStyleProp("borderBottomWidth")||0,this.disposables.addEventListener(this.element,"input",function(){n.update()}),this.update()},[{key:"destroy",value:function(){this.disposables.dispose(),this.element=null}},{key:"update",value:function(){var t=this.getStyleProp("fontSize");this.element.style.height="".concat(t,"px");var e=this.element.scrollHeight+this.verticalBorderSize;this.element.style.height="".concat(e,"px")}},{key:"getStyleProp",value:function(t){var e=getComputedStyle(this.element,null);return parseInt(e[t])}}])}(),qm=Object.defineProperty,Xm=Object.getOwnPropertyDescriptor,Zm=function(t,e,n,i){for(var r,o=i>1?void 0:i?Xm(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&qm(e,n,o),o},Ym=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.value="",t.placeholder="",t.rows=1,t.isFocus=!1,t.selection={start:0,end:0},t}return h(e,t),s(e,[{key:"getSelection",value:function(){return v({},this.selection)}},{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),setTimeout(function(){var e=new Gm(t.input);t.disposables.add(function(){e.destroy()})})}},{key:"handleFocus",value:function(t){t.stopPropagation(),this.isFocus="focus"===t.type,this.dispatchEvent(new CustomEvent(t.type))}},{key:"handleSelectionChange",value:function(t){var e=t.selectionStart,n=t.selectionEnd;e===this.selection.start&&n===this.selection.end||(this.selection.start=t.selectionStart,this.selection.end=t.selectionEnd,this.dispatchEvent(new CustomEvent("selection-change",{detail:v({},this.selection)})))}},{key:"handleClick",value:function(t){t.stopPropagation(),this.handleSelectionChange(t.target)}},{key:"handleInput",value:function(t){var e=t.target;t.stopPropagation(),this.value=e.value,this.dispatchInputEvent()}},{key:"handleKeydown",value:function(t){t.stopPropagation()}},{key:"handleKeyup",value:function(t){t.stopPropagation();var e=t.target;this.handleSelectionChange(e)}},{key:"dispatchInputEvent",value:function(){this.dispatchEvent(new CustomEvent("change",{detail:this.value}))}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"insertText",value:function(t,e){var n=this,i=this.input;e||(e={start:i.selectionStart,end:i.selectionEnd});var r=e,o=r.start,a=r.end,s=this.value;this.value=s.slice(0,o)+t+s.slice(a),this.dispatchInputEvent(),setTimeout(function(){i.selectionStart=i.selectionEnd=o+t.length,n.handleSelectionChange(i),n.focus()})}},{key:"reset",value:function(t){this.value=null!=t?t:""}},{key:"render",value:function(){return Qe(Cc||(Cc=x(['\n      <textarea\n        id="input"\n        .value=',"\n        .placeholder=",'\n        class="','"\n        @focus=',"\n        @blur=","\n        @click=","\n        @keydown=","\n        @keyup=","\n        @input=","\n      ></textarea>\n    "])),this.value,this.placeholder,Ta({active:!!this.value}),this.handleFocus,this.handleFocus,this.handleClick,this.handleKeydown,this.handleKeyup,this.handleInput)}}])}(gn);function Qm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}Ym.styles=we(Tc||(Tc=x(["\n    :host {\n      --bili-comment-textarea-bg: transparent;\n      --bili-comment-textarea-color: var(--text1);\n      --bili-comment-textarea-placeholder-color: var(--text3);\n      --bili-comment-textarea-padding: 8px;\n      --bili-comment-textarea-font-size: 14px;\n    }\n    :host {\n      display: flex;\n    }\n    #input {\n      min-height: 32px;\n      max-height: 100px;\n      line-height: 32px;\n      width: 100%;\n      font-size: var(--bili-comment-textarea-font-size);\n      font-family: inherit;\n      box-sizing: border-box;\n      color: var(--bili-comment-textarea-color);\n      background-color: var(--bili-comment-textarea-bg);\n      padding: 0 var(--bili-comment-textarea-padding);\n      border: none;\n      resize: none;\n      outline: none;\n    }\n    #input.active {\n      line-height: normal;\n    }\n    #input::placeholder {\n      color: var(--bili-comment-textarea-placeholder-color);\n    }\n  "]))),Zm([Cn("#input")],Ym.prototype,"input",2),Zm([kn({type:String})],Ym.prototype,"value",2),Zm([kn({type:String})],Ym.prototype,"placeholder",2),Zm([An()],Ym.prototype,"rows",2),Ym=Zm([xn("bili-comment-textarea")],Ym);var Km=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,n=[],i=0;i<t.rangeCount;i++)n.push(t.getRangeAt(i));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null}return t.removeAllRanges(),function(){"Caret"===t.type&&t.removeAllRanges(),t.rangeCount||n.forEach(function(e){t.addRange(e)}),e&&e.focus()}},Jm={"text/plain":"Text","text/html":"Url",default:"Text"};var ty=function(t,e){var n,i,r,o,a,s,l=!1;e||(e={}),n=e.debug||!1;try{if(r=Km(),o=document.createRange(),a=document.getSelection(),(s=document.createElement("span")).textContent=t,s.ariaHidden="true",s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",function(i){if(i.stopPropagation(),e.format)if(i.preventDefault(),_(i.clipboardData)>"u"){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var r=Jm[e.format]||Jm.default;window.clipboardData.setData(r,t)}else i.clipboardData.clearData(),i.clipboardData.setData(e.format,t);e.onCopy&&(i.preventDefault(),e.onCopy(i.clipboardData))}),document.body.appendChild(s),o.selectNodeContents(s),a.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(r){n&&console.error("unable to copy using execCommand: ",r),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(e.format||"text",t),e.onCopy&&e.onCopy(window.clipboardData),l=!0}catch(r){n&&console.error("unable to copy using clipboardData: ",r),n&&console.error("falling back to prompt"),i=function(t){var e=(/mac os x/i.test(navigator.userAgent)?"":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,e)}("message"in e?e.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,t)}}finally{a&&("function"==typeof a.removeRange?a.removeRange(o):a.removeAllRanges()),s&&document.body.removeChild(s),r()}return l},ey=Qm(ty),ny=Object.defineProperty,iy=Object.getOwnPropertyDescriptor,ry=function(t,e,n,i){for(var r,o=i>1?void 0:i?iy(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&ny(e,n,o),o},oy=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).spmPrefix="",t.oid="",t.type=0,t.mode=3,t.idx=0,t.visible=!0,t.upMid=0,t.theme="light",t.user=null,t.assist=!1,t.actionConfig={},t.extraTrackData={},t.commonTrackData=null,t.trackObserver=null,t}return h(e,t),s(e,[{key:"handleShare",value:function(t){console.log("handleShare",t);var e=t.rpid_str,n=t.oid,i=t.type;!e||!n||!i||function(t){return cu.request({url:"/x/v2/reply/share_reply_material",params:t})}({rpid:e,oid:n,type:i}).then(function(t){var e;if(console.log("res",t),0===t.code&&null!=(e=t.data)&&e.reply_share_url)return ey(t.data.reply_share_url),void iu("");iu("")}).catch(function(){iu("")})}},{key:"handleReply",value:function(t){var e,n=this;Bu.emit("reply",{target:t,defaultInput:(null==(e=t.reply_control)?void 0:e.preset_reply_text)||"",mount:function(t){t.parentElement!==n.replyContainer&&n.replyContainer.appendChild(t)}})}},{key:"handleReport",value:function(t){this.dispatchEvent(new CustomEvent("report",{detail:t}))}},{key:"handleBlock",value:function(t){this.dispatchEvent(new CustomEvent("block",{detail:t}))}},{key:"getClickTrackData",value:function(t){var e=this.getCommonTrackData();return Object.assign(e,t,{ext_json:JSON.stringify({likes:this.data.like,rank:this.idx,rp_mid:this.data.member.mid,rpid:this.data.rpid_str})}),e}},{key:"getCommonTrackData",value:function(){var t,e,n,i,r,o,a,s,l,c,u;if(this.commonTrackData)return this.commonTrackData;var d="-";null!=(n=this.data.reply_control)&&n.is_note_v2&&(d=this.data.reply_control.is_note?"note":"opus_"+this.data.dynamic_id_str);var h="";if("string"==typeof this.data.track_info)try{var p=JSON.parse(this.data.track_info);null!=p&&p.track_id&&(h=p.track_id)}catch(t){}var f=[],m=0;this.commentRenderer?this.commentRenderer.getRichTextContent().forEach(function(t){var e,n,i;if("a"===t.tag&&t.a)if(t.a.href){var r=(null==(e=t.dataset)?void 0:e.type)||"";if(!["search","mention"].includes(r)){var o=(null==(n=t.dataset)?void 0:n["raw-url"])||Wf(t.a.href);f.push(o)}}else"seek"===(null==(i=t.dataset)?void 0:i.type)&&(m+=1)}):console.warn("commentRenderer is not ready");var y=null!==(t=this.data.content)&&void 0!==t?t:{},b=y.members,g=y.vote,w=(null==(i=this.data.replies)?void 0:i.map(function(t){return t.rpid_str}))||[],x=[];this.data.card_label&&this.data.card_label.forEach(function(t){x.push(t.text_content)});var k=v({oid:this.oid,type:this.type,rpid:this.data.rpid_str,root_rpid:this.data.rpid_str,tag_name:"",ordering:3===this.mode?"heat":"time",from_spmid:fv(),spmid:this.spmPrefix||vi(),reply_list:w.join(","),rank:this.idx,card_type:d,url:f.join(","),ext_json:JSON.stringify({is_contain_at:(null==b?void 0:b.length)||0,is_contain_vote:null!=g&&g.id?1:0,is_contain_topic:0,is_contain_url:f.length,is_contain_time:m}),reply_track_id:h,exposure_metadata:"",shown_tags:x.join(","),has_image:null!=(r=this.data.content.pictures)&&r.length?1:0,fold_pictures:(null==(o=this.data.reply_control)?void 0:o.fold_pictures)||"",picture_count:null!==(e=null==(a=this.data.content.pictures)?void 0:a.length)&&void 0!==e?e:0,pic_scale:1,has_fans_medal:null!=(l=null==(s=this.data.member)?void 0:s.fans_detail)&&l.medal_name?1:0,has_god_label:0,has_oldfans_label:null!=(c=this.data.member)&&c.is_contractor?1:0,has_decoration:null!=(u=this.data.member)&&u.user_sailing_v2?1:0,has_guard:0},this.extraTrackData);return this.commonTrackData=k,k}},{key:"handleClickTrack",value:function(t){Wu("click","comment.all.click",this.getClickTrackData(t.detail),{spmPrefix:this.spmPrefix})}},{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),setTimeout(function(){t.trackObserver=new Zd({el:t,type:"show",value:{event:"comment.all",data:t.getCommonTrackData()},handler:function(e,n,i){"show"===e&&(Vu("replyCardShow",i),Wu(e,n,i,{spmPrefix:t.spmPrefix}))},durational:{beforeunload:!0}})})}},{key:"disconnectedCallback",value:function(){if(w(e,"disconnectedCallback",this,3)([]),this.trackObserver){var t=this.trackObserver;this.trackObserver=null,setTimeout(function(){t.dispose()})}}},{key:"updated",value:function(t){t.get("visible")&&(!1===this.visible?this.style.setProperty("display","none"):this.style.removeProperty("display"))}},{key:"repliesTemplate",value:function(){var t=this,e=this.data,n=e.replies,i=e.rcount;return null!=n&&n.length&&!i?"":Qe(Sc||(Sc=x(['<div id="replies">\n      <bili-comment-replies-renderer\n        .spmPrefix=',"\n        .data=","\n        .oid=","\n        .mode=","\n        .type=","\n        .user=","\n        .assist=","\n        .upMid=","\n        .contentFeatures=","\n        .actionConfig=","\n        @reply=","\n        @share=","\n        @block=","\n        @report=","\n        @track=","\n      ></bili-comment-replies-renderer>\n    </div>"])),this.spmPrefix,this.data,this.oid,this.mode,this.type,this.user,this.assist,this.upMid,this.contentFeatures,this.actionConfig,function(e){return t.handleReply(e.detail)},function(e){return t.handleShare(e.detail)},function(e){return t.handleBlock(e.detail)},function(e){return t.handleReport(e.detail)},this.handleClickTrack)}},{key:"render",value:function(){var t=this;return Qe(Oc||(Oc=x(['\n      <bili-comment-renderer\n        id="comment"\n        .theme=',"\n        .spmPrefix=","\n        .data=","\n        .user=","\n        .assist=","\n        .upMid=","\n        .oid=","\n        .type=","\n        .contentFeatures=","\n        .actionConfig=","\n        @delete=","\n        @block=","\n        @share=","\n        @report=","\n        @top=","\n        @reply=","\n        @expand=","\n        @track=","\n      ></bili-comment-renderer>\n      ",'\n      <div id="reply-container"></div>\n      <div id="div"></div>\n    '])),this.theme,this.spmPrefix,this.data,this.user,this.assist,this.upMid,this.oid,this.type,this.contentFeatures,this.actionConfig,function(){return t.dispatchEvent(new CustomEvent("delete"))},function(){t.handleBlock({mid:t.data.member.mid})},function(){return t.handleShare(t.data)},function(e){var n;return t.handleReport({member:{mid:t.data.member.mid,uname:t.data.member.uname},oid:t.oid,type:t.type,rpid:t.data.rpid_str,hiddenJuryTips:(null==(n=e.detail)?void 0:n.hiddenJuryTips)||!1})},function(e){return t.dispatchEvent(new CustomEvent("top",{detail:e.detail}))},function(){return t.handleReply(t.data)},function(e){return t.dispatchEvent(new CustomEvent("expand",{detail:e.detail}))},this.handleClickTrack,this.repliesTemplate())}}])}(gn);oy.styles=we(Pc||(Pc=x(["\n    #div {\n      padding-bottom: 14px;\n      margin-left: 80px;\n      border-bottom: 1px solid var(--graph_bg_thick);\n    }\n  "]))),ry([kn({type:String})],oy.prototype,"spmPrefix",2),ry([kn({type:Object})],oy.prototype,"data",2),ry([kn()],oy.prototype,"oid",2),ry([kn()],oy.prototype,"type",2),ry([kn()],oy.prototype,"mode",2),ry([kn()],oy.prototype,"idx",2),ry([kn({type:Boolean})],oy.prototype,"visible",2),ry([kn()],oy.prototype,"upMid",2),ry([kn()],oy.prototype,"theme",2),ry([kn()],oy.prototype,"user",2),ry([kn()],oy.prototype,"assist",2),ry([kn()],oy.prototype,"actionConfig",2),ry([kn()],oy.prototype,"contentFeatures",2),ry([kn()],oy.prototype,"extraTrackData",2),ry([Cn("#comment")],oy.prototype,"commentRenderer",2),ry([Cn("#reply-container")],oy.prototype,"replyContainer",2),oy=ry([xn("bili-comment-thread-renderer")],oy);var ay=function(t){"number"==typeof t&&(t=t.toString(16)),6===t.length&&(t="ff".concat(t));var e=parseInt(t.slice(2,4),16),n=parseInt(t.slice(4,6),16),i=parseInt(t.slice(6,8),16),r=parseInt(t.slice(0,2),16);return"rgba(".concat(e,",").concat(n,",").concat(i,",").concat(r/255,")")},sy=function(t){return t[t.NONE=0]="NONE",t[t.CONTRACTOR=1]="CONTRACTOR",t[t.FANS=2]="FANS",t}(sy||{});var ly=Object.defineProperty,cy=Object.getOwnPropertyDescriptor,uy=function(t,e,n,i){for(var r,o=i>1?void 0:i?cy(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&ly(e,n,o),o},dy=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).disposables=Rn(),t.spmPrefix="",t.upMid=0,t.medalVisible=!1,t}return h(e,t),s(e,[{key:"uid",get:function(){return this.data.member.mid}},{key:"isUp",get:function(){return this.uid===String(this.upMid)}},{key:"userName",get:function(){return this.data.member.uname}},{key:"userNameRenderStyle",get:function(){var t,e;if(null==(t=this.data.member)||!t.name_render)return null;var n=Iu(null==(e=this.data.member)?void 0:e.name_render,{variable:"--name-render-bg"});return n?n.variable:null}},{key:"userNameStyle",get:function(){var t,e;if(!this.data.member)return null;if(this.userNameRenderStyle)return this.userNameRenderStyle;var n=null==(e=null==(t=this.data.member)?void 0:t.vip)?void 0:e.nickname_color;return n?{color:n}:null}},{key:"spaceLink",get:function(){return ih(this.uid)}},{key:"levelImgSrc",get:function(){var t=this.data.member,e=t.is_senior_member,n=t.level_info.current_level;return"//i0.hdslb.com/bfs/seed/jinkela/short/webui/user-profile/img/level_".concat(e?"h":n,".svg")}},{key:"userMedal",get:function(){return!this.medalVisible||this.isUp?null:function(t){var e=t.member,n=e.is_contractor,i=e.contract_desc,r=e.fans_detail,o={type:0};return n?(o.type=1,o.contractor={name:{text:i,style:{color:"var(--brand_pink, #FF6699)"}}},o.contractor.style=""===i?{backgroundColor:"transparent",borderColor:"var(--brand_pink, #FF6699)"}:{backgroundColor:"var(--brand_pink_thin, #FFECF1)",borderColor:"transparent"},o):null!=r&&r.medal_name?(o.type=2,o.fansDetail=r,o.fans={style:{},name:{text:r.medal_name,style:{color:r.medal_color_name?ay(r.medal_color_name):""}},level:{text:String(r.level),style:{color:r.medal_color_level?ay(r.medal_color_level):"",backgroundColor:r.medal_level_bg_color?ay(r.medal_level_bg_color):""}}},r.medal_color&&r.medal_color_end&&(o.fans.style.backgroundImage="linear-gradient(90deg, ".concat(ay(r.medal_color),", ").concat(ay(r.medal_color_end),")")),r.medal_color_border&&(o.fans.style.borderColor=ay(r.medal_color_border)),r.first_icon&&(o.fans.icon={first:r.first_icon},r.second_icon&&(o.fans.icon.second=r.second_icon)),o):null}(this.data)}},{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),setTimeout(function(){t.disposables.add(Dv(t.shadowRoot.querySelector("#user-name")))})}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.disposables.dispose()}},{key:"handleNameClick",value:function(t){t.stopPropagation();var e={rpid:this.data.rpid_str};Vu("replyCardNameClick",e),Wu("click","comment.user_name.click",e,{spmPrefix:this.spmPrefix}),this.handleTrackClick(3)}},{key:"handleTrackClick",value:function(t){this.dispatchEvent(new CustomEvent("track",{detail:t}))}},{key:"handleLevelClick",value:function(){var t={rpid:this.data.rpid_str};Vu("replyCardLvClick",t),Wu("click","comment.user_lv.click",t,{spmPrefix:this.spmPrefix}),window.open("https://www.bilibili.com/blackboard/help.html#/?qid=59e2cffdaa69465486497bb35a5ac295")}},{key:"render",value:function(){return Qe(Ic||(Ic=x(['<div id="info">\n      <slot></slot>\n      <div\n        id="user-name"\n        data-user-profile-id="','"\n        data-user-profile-spmid-follow="comment.profile.click"\n        @click=','\n      >\n        <a\n          href="','"\n          class="','"\n          style="','"\n          target="_blank"\n          >','</a\n        >\n      </div>\n      <div id="user-level" @click=','>\n        <img width="30" height="30" src="','" />\n      </div>\n      ',"\n      ","\n    </div>"])),this.uid,this.handleNameClick,this.spaceLink,this.userNameRenderStyle?"name-render-style":"",this.userNameStyle?Zn(this.userNameStyle):"",this.userName,this.handleLevelClick,this.levelImgSrc,this.userMedal?Qe(Rc||(Rc=x(['\n            <div id="user-medal">\n              <bili-comment-user-medal .data=',"></bili-comment-user-medal>\n            </div>\n          "])),this.userMedal):"",this.isUp?Qe(jc||(jc=x(['<div id="user-up">\n            <img width="24" height="24" src="//i0.hdslb.com/bfs/seed/jinkela/short/webui/comments/img/icons/up_pb.svg" />\n          </div>']))):"")}}])}(gn);dy.styles=we(Dc||(Dc=x(["\n    :host {\n      --bili-comment-user-info-name-color: var(--text2);\n    }\n    #info {\n      display: inline-flex;\n      align-items: center;\n    }\n    #user-name {\n      color: var(--bili-comment-user-info-name-color);\n      font-size: var(--bili-comments-font-size-name, 13px);\n      font-weight: 500;\n    }\n    #user-name a.name-render-style {\n      background-clip: text;\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n    }\n    .name-render-style {\n      background-image: var(--name-render-bg-light);\n    }\n    :host([dark]) .name-render-style {\n      background-image: var(--name-render-bg-dark);\n    }\n    #user-level {\n      margin-left: 5px;\n      width: 30px;\n      height: 30px;\n    }\n    #user-up {\n      width: 24px;\n      height: 24px;\n    }\n    a {\n      text-decoration: none;\n      color: inherit;\n    }\n  "]))),uy([kn({type:String})],dy.prototype,"spmPrefix",2),uy([kn()],dy.prototype,"data",2),uy([kn()],dy.prototype,"upMid",2),uy([kn({type:Boolean})],dy.prototype,"medalVisible",2),uy([An()],dy.prototype,"uid",1),uy([An()],dy.prototype,"isUp",1),uy([An()],dy.prototype,"userName",1),uy([An()],dy.prototype,"userNameRenderStyle",1),uy([An()],dy.prototype,"userNameStyle",1),uy([An()],dy.prototype,"spaceLink",1),uy([An()],dy.prototype,"levelImgSrc",1),uy([An()],dy.prototype,"userMedal",1),dy=uy([xn("bili-comment-user-info")],dy);var hy=Object.defineProperty,py=Object.getOwnPropertyDescriptor,fy=function(t,e,n,i){for(var r,o=i>1?void 0:i?py(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&hy(e,n,o),o},vy=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).biliFansMedal=null,t.fansRef=new qc,t}return h(e,t),s(e,[{key:"firstUpdated",value:function(){this.init()}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.biliFansMedal&&(this.biliFansMedal.unmount(),this.biliFansMedal=null)}},{key:"init",value:(n=i(m().m(function t(){var e,n,i,r;return m().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.data.type===sy.CONTRACTOR&&(e=this.shadowRoot.querySelector("#name #name-text"),n=this.shadowRoot.querySelector("#name"),(i=e.getBoundingClientRect().width)&&(n.style.width="".concat(i,"px"))),this.data.type!==sy.FANS||!this.fansRef.value){t.n=5;break}if(this.biliFansMedal&&(this.biliFansMedal.unmount(),this.biliFansMedal=null),window.BiliFansMedal){t.n=4;break}return t.p=1,t.n=2,ni("//s1.hdslb.com/bfs/seed/water-ui/common/bili-fans-medal.js");case 2:t.n=4;break;case 3:t.p=3,r=t.v,console.error("Failed to load BiliFansMedal script:",r);case 4:window.BiliFansMedal&&(this.biliFansMedal=new window.BiliFansMedal(this.data.fansDetail),this.biliFansMedal.mount(this.fansRef.value));case 5:return t.a(2)}},t,this,[[1,3]])})),function(){return n.apply(this,arguments)})},{key:"render",value:function(){if(this.data.type===sy.CONTRACTOR){var t=this.data.contractor,e=t.style,n=t.name;return Qe(Nc||(Nc=x(['<div id="contractor" style=','>\n        <div id="name" style=','><div id="name-text">',"</div></div>\n      </div>"])),e?Zn(v({},e)):"",n.style?Zn(v({},n.style)):"",n.text)}return this.data.type===sy.FANS?Qe(Mc||(Mc=x(['<div id="fans" ',"></div>"])),Zc(this.fansRef)):Qe(Lc||(Lc=x(['<div id="none"></div>'])))}}]);var n}(gn);vy.styles=we(Bc||(Bc=x(["\n    #contractor {\n      height: 12px;\n      padding: 0 2px;\n      border-radius: 2px;\n      border-width: 0.5px;\n      border-style: solid;\n      box-sizing: border-box;\n    }\n    #contractor #name {\n      height: 11px;\n      position: relative;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    #contractor #name #name-text {\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      white-space: nowrap;\n      transform: scale(0.5) translate(-50%, -50%);\n      transform-origin: 0 0;\n      font-size: 16px;\n    }\n    #fans {\n      display: flex;\n      align-items: center;\n      margin-left: 5px;\n    }\n  "]))),fy([kn({type:Object})],vy.prototype,"data",2),vy=fy([xn("bili-comment-user-medal")],vy);var my=Object.defineProperty,yy=Object.getOwnPropertyDescriptor,by=function(t,e,n,i){for(var r,o=i>1?void 0:i?yy(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&my(e,n,o),o},gy=function(t){function e(){var t;return o(this,e),(t=r(this,e,arguments)).card=null,t}return h(e,t),s(e,[{key:"clearData",value:function(){this.card&&(this.card.unmount(),this.card=null)}},{key:"connectedCallback",value:function(){var t=this;w(e,"connectedCallback",this,3)([]),setTimeout(function(){t.initData(t.data)})}},{key:"disconnectedCallback",value:function(){w(e,"disconnectedCallback",this,3)([]),this.clearData()}},{key:"updated",value:function(t){t.has("data")&&this.initData(this.data)}},{key:"initData",value:(n=i(m().m(function t(e){var n,i;return m().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ni("//s1.hdslb.com/bfs/seed/ogv/garb-component/garb-asset-equipment.umd.js",{lib:"__OGV_GRAB_ASSET_EQUIPMENT__"});case 1:n=t.v,i=n.CardBgForWeb,this.card&&this.clearData(),this.card=new i(e).mount(this.shadowRoot.querySelector("#card"));case 2:return t.a(2)}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"render",value:function(){return Qe(zc||(zc=x(['<div id="card"></div>'])))}}]);var n}(gn);gy.styles=we(Uc||(Uc=x(["\n    #card {\n      width: 288px;\n      height: 48px;\n      position: relative;\n      overflow: hidden;\n      user-select: none;\n      text-align: right;\n    }\n    #card > div {\n      height: 100%;\n      max-width: 100%;\n    }\n  "]))),by([kn()],gy.prototype,"data",2),gy=by([xn("bili-comment-user-sailing-card")],gy);var wy=Object.defineProperty,xy=Object.getOwnPropertyDescriptor,ky=function(t,e,n,i){for(var r,o=i>1?void 0:i?xy(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&wy(e,n,o),o},Ay=function(t){function e(){return o(this,e),r(this,e,arguments)}return h(e,t),s(e,[{key:"tag",get:function(){var t={class:"",text:""};switch(this.data.label_kind){case 1:t.class="red",t.text="";break;case 2:t.class="blue",t.text=""}return t}},{key:"render",value:function(){return Qe(Fc||(Fc=x(['<div id="option">\n      <div id="tag" class="','">','</div>\n      <div id="desc">',"</div>\n    </div>"])),this.tag.class,this.tag.text,this.data.desc)}}])}(gn);Ay.styles=we(Vc||(Vc=x(["\n    :host {\n      display: flex;\n    }\n    #option {\n      display: flex;\n      align-items: center;\n      font-size: 12px;\n    }\n    #tag {\n      box-sizing: border-box;\n      line-height: 16px;\n      padding: 2px 6px;\n      border-radius: 2px;\n      margin-right: 4px;\n      background-color: var(--graph_bg_regular);\n      color: var(--text3);\n    }\n    #tag.red {\n      background-color: var(--Pi1);\n      color: var(--Pi5);\n    }\n    #tag.blue {\n      background-color: var(--brand_blue_thin);\n      color: var(--brand_blue);\n    }\n    #desc {\n      color: var(--text2);\n    }\n  "]))),ky([kn()],Ay.prototype,"data",2),ky([An()],Ay.prototype,"tag",1),Ay=ky([xn("bili-comment-vote-option")],Ay);var _y=Object.defineProperty,Ey=Object.getOwnPropertyDescriptor,Cy=function(t,e,n,i){for(var r,o=i>1?void 0:i?Ey(e,n):e,a=t.length-1;a>=0;a--)(r=t[a])&&(o=(i?r(e,n,o):r(o))||o);return i&&o&&_y(e,n,o),o},Ty=function(t){function e(){return o(this,e),r(this,e,arguments)}return h(e,t),s(e,[{key:"handleClick",value:function(){dh(this.data.id)}},{key:"render",value:function(){return Qe(Hc||(Hc=x(['\n      <div id="card">\n        <div id="head">\n          <bili-icon icon="BDC/vote_line/2" size="40"></bili-icon>\n        </div>\n        <div id="content">\n          <div id="info">\n            <div id="title">','</div>\n            <div id="desc">','</div>\n          </div>\n        </div>\n        <div id="action">\n          <button @click=',"></button>\n        </div>\n      </div>\n    "])),this.data.title,this.data.cnt||0,this.handleClick)}}])}(gn);Ty.styles=we(Wc||(Wc=x(["\n    #card {\n      width: 100%;\n      height: 80px;\n      display: flex;\n      border: 0.5px solid var(--graph_bg_thick);\n      border-radius: 4px;\n      background-color: var(--bg1);\n    }\n\n    #head {\n      width: 80px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      flex-shrink: 0;\n      border-top-left-radius: 4px;\n      border-bottom-left-radius: 4px;\n      background-color: var(--brand_blue_thin);\n      color: var(--brand_blue);\n    }\n\n    #content {\n      flex: 1;\n      overflow: hidden;\n      display: flex;\n      align-items: center;\n      padding-left: 15px;\n    }\n    #info #title {\n      font-size: 14px;\n      color: var(--text1);\n    }\n    #info #desc {\n      margin-top: 10px;\n      font-size: 12px;\n      color: var(--text3);\n    }\n\n    #action {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      flex-shrink: 0;\n      width: 90px;\n    }\n    #action button {\n      width: 54px;\n      height: 28px;\n      font-size: 13px;\n      border-radius: 4px;\n      text-align: center;\n      line-height: 28px;\n      color: var(--text_white);\n      background-color: var(--brand_blue);\n      cursor: pointer;\n      outline: none;\n      border: none;\n    }\n  "]))),Cy([kn({type:Object})],Ty.prototype,"data",2),Ty=Cy([xn("bili-comment-vote-renderer")],Ty);var Sy=function(t){return t&&t.Math===Math&&t},Oy=Sy("object"==("undefined"==typeof globalThis?"undefined":_(globalThis))&&globalThis)||Sy("object"==("undefined"==typeof window?"undefined":_(window))&&window)||Sy("object"==("undefined"==typeof self?"undefined":_(self))&&self)||Sy("object"==_(_i)&&_i)||Sy("object"==_(_i)&&_i)||function(){return this}()||Function("return this")(),Py={},Iy=function(t){try{return!!t()}catch(t){return!0}},Ry=!Iy(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}),jy=!Iy(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),Dy=jy,Ny=Function.prototype.call,My=Dy?Ny.bind(Ny):function(){return Ny.apply(Ny,arguments)},Ly={},By={}.propertyIsEnumerable,zy=Object.getOwnPropertyDescriptor,Uy=zy&&!By.call({1:2},1);Ly.f=Uy?function(t){var e=zy(this,t);return!!e&&e.enumerable}:By;var Fy,Vy,Hy=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Wy=jy,$y=Function.prototype,Gy=$y.call,qy=Wy&&$y.bind.bind(Gy,Gy),Xy=Wy?qy:function(t){return function(){return Gy.apply(t,arguments)}},Zy=Xy,Yy=Zy({}.toString),Qy=Zy("".slice),Ky=function(t){return Qy(Yy(t),8,-1)},Jy=Iy,tb=Ky,eb=Object,nb=Xy("".split),ib=Jy(function(){return!eb("z").propertyIsEnumerable(0)})?function(t){return"String"===tb(t)?nb(t,""):eb(t)}:eb,rb=function(t){return null==t},ob=rb,ab=TypeError,sb=function(t){if(ob(t))throw new ab("Can't call method on "+t);return t},lb=ib,cb=sb,ub=function(t){return lb(cb(t))},db="object"==("undefined"==typeof document?"undefined":_(document))&&document.all,hb=void 0===db&&void 0!==db?function(t){return"function"==typeof t||t===db}:function(t){return"function"==typeof t},pb=hb,fb=function(t){return"object"==_(t)?null!==t:pb(t)},vb=Oy,mb=hb,yb=function(t,e){return arguments.length<2?(n=vb[t],mb(n)?n:void 0):vb[t]&&vb[t][e];var n},bb=Xy({}.isPrototypeOf),gb=Oy.navigator,wb=gb&&gb.userAgent,xb=Oy,kb=wb?String(wb):"",Ab=xb.process,_b=xb.Deno,Eb=Ab&&Ab.versions||_b&&_b.version,Cb=Eb&&Eb.v8;Cb&&(Vy=(Fy=Cb.split("."))[0]>0&&Fy[0]<4?1:+(Fy[0]+Fy[1])),!Vy&&kb&&(!(Fy=kb.match(/Edge\/(\d+)/))||Fy[1]>=74)&&(Fy=kb.match(/Chrome\/(\d+)/))&&(Vy=+Fy[1]);var Tb=Vy,Sb=Iy,Ob=Oy.String,Pb=!!Object.getOwnPropertySymbols&&!Sb(function(){var t=Symbol("symbol detection");return!Ob(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Tb&&Tb<41}),Ib=Pb&&!Symbol.sham&&"symbol"==_(Symbol.iterator),Rb=yb,jb=hb,Db=bb,Nb=Object,Mb=Ib?function(t){return"symbol"==_(t)}:function(t){var e=Rb("Symbol");return jb(e)&&Db(e.prototype,Nb(t))},Lb=String,Bb=hb,zb=function(t){try{return Lb(t)}catch(t){return"Object"}},Ub=TypeError,Fb=function(t){if(Bb(t))return t;throw new Ub(zb(t)+" is not a function")},Vb=Fb,Hb=rb,Wb=My,$b=hb,Gb=fb,qb=TypeError,Xb={exports:{}},Zb=Oy,Yb=Object.defineProperty,Qb=function(t,e){try{Yb(Zb,t,{value:e,configurable:!0,writable:!0})}catch(n){Zb[t]=e}return e},Kb=Oy,Jb=Qb,tg="__core-js_shared__",eg=Xb.exports=Kb[tg]||Jb(tg,{});(eg.versions||(eg.versions=[])).push({version:"3.45.1",mode:"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.1/LICENSE",source:"https://github.com/zloirock/core-js"});var ng=Xb.exports,ig=ng,rg=function(t,e){return ig[t]||(ig[t]=e||{})},og=sb,ag=Object,sg=function(t){return ag(og(t))},lg=sg,cg=Xy({}.hasOwnProperty),ug=Object.hasOwn||function(t,e){return cg(lg(t),e)},dg=Xy,hg=0,pg=Math.random(),fg=dg(1.1.toString),vg=function(t){return"Symbol("+(void 0===t?"":t)+")_"+fg(++hg+pg,36)},mg=rg,yg=ug,bg=vg,gg=Pb,wg=Ib,xg=Oy.Symbol,kg=mg("wks"),Ag=wg?xg.for||xg:xg&&xg.withoutSetter||bg,_g=function(t){return yg(kg,t)||(kg[t]=gg&&yg(xg,t)?xg[t]:Ag("Symbol."+t)),kg[t]},Eg=My,Cg=fb,Tg=Mb,Sg=function(t,e){var n=t[e];return Hb(n)?void 0:Vb(n)},Og=function(t,e){var n,i;if("string"===e&&$b(n=t.toString)&&!Gb(i=Wb(n,t)))return i;if($b(n=t.valueOf)&&!Gb(i=Wb(n,t)))return i;if("string"!==e&&$b(n=t.toString)&&!Gb(i=Wb(n,t)))return i;throw new qb("Can't convert object to primitive value")},Pg=TypeError,Ig=_g("toPrimitive"),Rg=function(t,e){if(!Cg(t)||Tg(t))return t;var n,i=Sg(t,Ig);if(i){if(void 0===e&&(e="default"),n=Eg(i,t,e),!Cg(n)||Tg(n))return n;throw new Pg("Can't convert object to primitive value")}return void 0===e&&(e="number"),Og(t,e)},jg=Mb,Dg=function(t){var e=Rg(t,"string");return jg(e)?e:e+""},Ng=fb,Mg=Oy.document,Lg=Ng(Mg)&&Ng(Mg.createElement),Bg=function(t){return Lg?Mg.createElement(t):{}},zg=Bg,Ug=!Ry&&!Iy(function(){return 7!==Object.defineProperty(zg("div"),"a",{get:function(){return 7}}).a}),Fg=Ry,Vg=My,Hg=Ly,Wg=Hy,$g=ub,Gg=Dg,qg=ug,Xg=Ug,Zg=Object.getOwnPropertyDescriptor;Py.f=Fg?Zg:function(t,e){if(t=$g(t),e=Gg(e),Xg)try{return Zg(t,e)}catch(t){}if(qg(t,e))return Wg(!Vg(Hg.f,t,e),t[e])};var Yg={},Qg=Ry&&Iy(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),Kg=fb,Jg=String,tw=TypeError,ew=function(t){if(Kg(t))return t;throw new tw(Jg(t)+" is not an object")},nw=Ry,iw=Ug,rw=Qg,ow=ew,aw=Dg,sw=TypeError,lw=Object.defineProperty,cw=Object.getOwnPropertyDescriptor,uw="enumerable",dw="configurable",hw="writable";Yg.f=nw?rw?function(t,e,n){if(ow(t),e=aw(e),ow(n),"function"==typeof t&&"prototype"===e&&"value"in n&&hw in n&&!n[hw]){var i=cw(t,e);i&&i[hw]&&(t[e]=n.value,n={configurable:dw in n?n[dw]:i[dw],enumerable:uw in n?n[uw]:i[uw],writable:!1})}return lw(t,e,n)}:lw:function(t,e,n){if(ow(t),e=aw(e),ow(n),iw)try{return lw(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new sw("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var pw=Yg,fw=Hy,vw=Ry?function(t,e,n){return pw.f(t,e,fw(1,n))}:function(t,e,n){return t[e]=n,t},mw={exports:{}},yw=Ry,bw=ug,gw=Function.prototype,ww=yw&&Object.getOwnPropertyDescriptor,xw=bw(gw,"name"),kw={EXISTS:xw,PROPER:xw&&"something"===function(){}.name,CONFIGURABLE:xw&&(!yw||yw&&ww(gw,"name").configurable)},Aw=hb,_w=ng,Ew=Xy(Function.toString);Aw(_w.inspectSource)||(_w.inspectSource=function(t){return Ew(t)});var Cw,Tw,Sw,Ow=_w.inspectSource,Pw=hb,Iw=Oy.WeakMap,Rw=Pw(Iw)&&/native code/.test(String(Iw)),jw=vg,Dw=rg("keys"),Nw=function(t){return Dw[t]||(Dw[t]=jw(t))},Mw={},Lw=Rw,Bw=Oy,zw=fb,Uw=vw,Fw=ug,Vw=ng,Hw=Nw,Ww=Mw,$w="Object already initialized",Gw=Bw.TypeError,qw=Bw.WeakMap;if(Lw||Vw.state){var Xw=Vw.state||(Vw.state=new qw);Xw.get=Xw.get,Xw.has=Xw.has,Xw.set=Xw.set,Cw=function(t,e){if(Xw.has(t))throw new Gw($w);return e.facade=t,Xw.set(t,e),e},Tw=function(t){return Xw.get(t)||{}},Sw=function(t){return Xw.has(t)}}else{var Zw=Hw("state");Ww[Zw]=!0,Cw=function(t,e){if(Fw(t,Zw))throw new Gw($w);return e.facade=t,Uw(t,Zw,e),e},Tw=function(t){return Fw(t,Zw)?t[Zw]:{}},Sw=function(t){return Fw(t,Zw)}}var Yw={set:Cw,get:Tw,has:Sw,enforce:function(t){return Sw(t)?Tw(t):Cw(t,{})},getterFor:function(t){return function(e){var n;if(!zw(e)||(n=Tw(e)).type!==t)throw new Gw("Incompatible receiver, "+t+" required");return n}}},Qw=Xy,Kw=Iy,Jw=hb,tx=ug,ex=Ry,nx=kw.CONFIGURABLE,ix=Ow,rx=Yw.enforce,ox=Yw.get,ax=String,sx=Object.defineProperty,lx=Qw("".slice),cx=Qw("".replace),ux=Qw([].join),dx=ex&&!Kw(function(){return 8!==sx(function(){},"length",{value:8}).length}),hx=String(String).split("String"),px=mw.exports=function(t,e,n){"Symbol("===lx(ax(e),0,7)&&(e="["+cx(ax(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!tx(t,"name")||nx&&t.name!==e)&&(ex?sx(t,"name",{value:e,configurable:!0}):t.name=e),dx&&n&&tx(n,"arity")&&t.length!==n.arity&&sx(t,"length",{value:n.arity});try{n&&tx(n,"constructor")&&n.constructor?ex&&sx(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var i=rx(t);return tx(i,"source")||(i.source=ux(hx,"string"==typeof e?e:"")),t};Function.prototype.toString=px(function(){return Jw(this)&&ox(this).source||ix(this)},"toString");var fx=mw.exports,vx=hb,mx=Yg,yx=fx,bx=Qb,gx={},wx=Math.ceil,xx=Math.floor,kx=Math.trunc||function(t){var e=+t;return(e>0?xx:wx)(e)},Ax=kx,_x=function(t){var e=+t;return e!=e||0===e?0:Ax(e)},Ex=_x,Cx=Math.max,Tx=Math.min,Sx=_x,Ox=Math.min,Px=function(t){var e=Sx(t);return e>0?Ox(e,9007199254740991):0},Ix=function(t){return Px(t.length)},Rx=ub,jx=function(t,e){var n=Ex(t);return n<0?Cx(n+e,0):Tx(n,e)},Dx=Ix,Nx=function(t){return function(e,n,i){var r=Rx(e),o=Dx(r);if(0===o)return!t&&-1;var a,s=jx(i,o);if(t&&n!=n){for(;o>s;)if((a=r[s++])!=a)return!0}else for(;o>s;s++)if((t||s in r)&&r[s]===n)return t||s||0;return!t&&-1}},Mx={includes:Nx(!0),indexOf:Nx(!1)},Lx=ug,Bx=ub,zx=Mx.indexOf,Ux=Mw,Fx=Xy([].push),Vx=function(t,e){var n,i=Bx(t),r=0,o=[];for(n in i)!Lx(Ux,n)&&Lx(i,n)&&Fx(o,n);for(;e.length>r;)Lx(i,n=e[r++])&&(~zx(o,n)||Fx(o,n));return o},Hx=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Wx=Vx,$x=Hx.concat("length","prototype");gx.f=Object.getOwnPropertyNames||function(t){return Wx(t,$x)};var Gx={};Gx.f=Object.getOwnPropertySymbols;var qx=yb,Xx=gx,Zx=Gx,Yx=ew,Qx=Xy([].concat),Kx=qx("Reflect","ownKeys")||function(t){var e=Xx.f(Yx(t)),n=Zx.f;return n?Qx(e,n(t)):e},Jx=ug,tk=Kx,ek=Py,nk=Yg,ik=Iy,rk=hb,ok=/#|\.prototype\./,ak=function(t,e){var n=lk[sk(t)];return n===uk||n!==ck&&(rk(e)?ik(e):!!e)},sk=ak.normalize=function(t){return String(t).replace(ok,".").toLowerCase()},lk=ak.data={},ck=ak.NATIVE="N",uk=ak.POLYFILL="P",dk=ak,hk=Oy,pk=Py.f,fk=vw,vk=function(t,e,n,i){i||(i={});var r=i.enumerable,o=void 0!==i.name?i.name:e;if(vx(n)&&yx(n,o,i),i.global)r?t[e]=n:bx(e,n);else{try{i.unsafe?t[e]&&(r=!0):delete t[e]}catch(t){}r?t[e]=n:mx.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},mk=Qb,yk=function(t,e,n){for(var i=tk(e),r=nk.f,o=ek.f,a=0;a<i.length;a++){var s=i[a];Jx(t,s)||n&&Jx(n,s)||r(t,s,o(e,s))}},bk=dk,gk=Ky,wk=Array.isArray||function(t){return"Array"===gk(t)},xk=TypeError,kk=Ky,Ak=Xy,_k=function(t){if("Function"===kk(t))return Ak(t)},Ek=Fb,Ck=jy,Tk=_k(_k.bind),Sk=wk,Ok=Ix,Pk=function(t){if(t>9007199254740991)throw xk("Maximum allowed index exceeded");return t},Ik=function(t,e){return Ek(t),void 0===e?t:Ck?Tk(t,e):function(){return t.apply(e,arguments)}},Rk=function(t,e,n,i,r,o,a,s){for(var l,c,u=r,d=0,h=!!a&&Ik(a,s);d<i;)d in n&&(l=h?h(n[d],d,e):n[d],o>0&&Sk(l)?(c=Ok(l),u=Rk(t,e,l,c,u,o-1)-1):(Pk(u+1),t[u]=l),u++),d++;return u},jk=Rk,Dk={};Dk[_g("toStringTag")]="z";var Nk="[object z]"===String(Dk),Mk=hb,Lk=Ky,Bk=_g("toStringTag"),zk=Object,Uk="Arguments"===Lk(function(){return arguments}()),Fk=Nk?Lk:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=zk(t),Bk))?n:Uk?Lk(e):"Object"===(i=Lk(e))&&Mk(e.callee)?"Arguments":i},Vk=Xy,Hk=Iy,Wk=hb,$k=Fk,Gk=Ow,qk=function(){},Xk=yb("Reflect","construct"),Zk=/^\s*(?:class|function)\b/,Yk=Vk(Zk.exec),Qk=!Zk.test(qk),Kk=function(t){if(!Wk(t))return!1;try{return Xk(qk,[],t),!0}catch(t){return!1}},Jk=function(t){if(!Wk(t))return!1;switch($k(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Qk||!!Yk(Zk,Gk(t))}catch(t){return!0}};Jk.sham=!0;var tA=!Xk||Hk(function(){var t;return Kk(Kk.call)||!Kk(Object)||!Kk(function(){t=!0})||t})?Jk:Kk,eA=wk,nA=tA,iA=fb,rA=_g("species"),oA=Array,aA=function(t){var e;return eA(t)&&(e=t.constructor,(nA(e)&&(e===oA||eA(e.prototype))||iA(e)&&null===(e=e[rA]))&&(e=void 0)),void 0===e?oA:e},sA=jk,lA=sg,cA=Ix,uA=_x,dA=function(t,e){return new(aA(t))(0===e?0:e)};(function(t,e){var n,i,r,o,a,s=t.target,l=t.global,c=t.stat;if(n=l?hk:c?hk[s]||mk(s,{}):hk[s]&&hk[s].prototype)for(i in e){if(o=e[i],r=t.dontCallGetSet?(a=pk(n,i))&&a.value:n[i],!bk(l?i:s+(c?".":"#")+i,t.forced)&&void 0!==r){if(_(o)==_(r))continue;yk(o,r)}(t.sham||r&&r.sham)&&fk(o,"sham",!0),vk(n,i,o,t)}})({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=lA(this),n=cA(e),i=dA(e,0);return i.length=sA(i,e,e,n,0,void 0===t?1:uA(t)),i}});var hA={},pA=Vx,fA=Hx,vA=Object.keys||function(t){return pA(t,fA)},mA=Ry,yA=Qg,bA=Yg,gA=ew,wA=ub,xA=vA;hA.f=mA&&!yA?Object.defineProperties:function(t,e){gA(t);for(var n,i=wA(e),r=xA(e),o=r.length,a=0;o>a;)bA.f(t,n=r[a++],i[n]);return t};var kA,AA=yb("document","documentElement"),_A=ew,EA=hA,CA=Hx,TA=Mw,SA=AA,OA=Bg,PA="prototype",IA="script",RA=Nw("IE_PROTO"),jA=function(){},DA=function(t){return"<"+IA+">"+t+"</"+IA+">"},NA=function(t){t.write(DA("")),t.close();var e=t.parentWindow.Object;return t=null,e},MA=function(){try{kA=new ActiveXObject("htmlfile")}catch(t){}var t,e,n;MA="undefined"!=typeof document?document.domain&&kA?NA(kA):(e=OA("iframe"),n="java"+IA+":",e.style.display="none",SA.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(DA("document.F=Object")),t.close(),t.F):NA(kA);for(var i=CA.length;i--;)delete MA[PA][CA[i]];return MA()};TA[RA]=!0;var LA=Object.create||function(t,e){var n;return null!==t?(jA[PA]=_A(t),n=new jA,jA[PA]=null,n[RA]=t):n=MA(),void 0===e?n:EA.f(n,e)},BA=_g,zA=LA,UA=Yg.f,FA=BA("unscopables"),VA=Array.prototype;void 0===VA[FA]&&UA(VA,FA,{configurable:!0,value:zA(null)});(function(t){VA[FA][t]=!0})("flat");var HA=Oy,WA=Xy;(function(t,e){WA(HA[t].prototype[e])})("Array","flat");var $A=function(){return s(function t(){o(this,t),this.target=null,this.events={}},[{key:"addEventListener",value:function(t,e){("undefined"==typeof window?"undefined":_(window))>"u"?console.warn("EventBridge is not supported in server side"):(this.events[t]?this.events[t].push(e):this.events[t]=[e],this.target&&this.target.addEventListener(t,e))}},{key:"removeEventListener",value:function(t,e){if(("undefined"==typeof window?"undefined":_(window))>"u")console.warn("EventBridge is not supported in server side");else if(this.target&&this.target.removeEventListener(t,e),this.events[t].length){var n=this.events[t];this.events[t]=n.filter(function(t){return t!==e})}}},{key:"connect",value:function(t){var e=this;this.target||t&&(this.target=t,Object.keys(this.events).forEach(function(n){e.events[n].forEach(function(e){t.addEventListener(n,e)})}))}},{key:"disconnect",value:function(){var t=this;if(this.target){var e=this.target;Object.keys(this.events).forEach(function(n){t.events[n].forEach(function(t){e.removeEventListener(n,t)})})}this.events={},this.target=null}}])}(),GA=function(){return s(function t(e){o(this,t),this.el={current:null},this.parent=null,this.props={},this.methods={},this.emits=[],this.dispose=null,this.eventBridge=new $A,e&&(this.props=e)},[{key:"engine",get:function(){return{core:"custom"}}},{key:"addEventListener",value:function(t,e){!this.emits.length||this.emits.includes(t)?this.eventBridge.addEventListener(t,e):console.warn("Event ".concat(String(t)," is not defined in emits"))}},{key:"removeEventListener",value:function(t,e){this.eventBridge.removeEventListener(t,e)}},{key:"dispatchAction",value:function(t){var e,n=t.type,i=t.args,r=t.callback,o=null==(e=this.methods)?void 0:e[n];if("function"==typeof o){var a=o.apply(void 0,k(i||[]));return null==r||r(a),a}console.warn("Action ".concat(String(n)," is undefined or not a function"))}},{key:"renderToString",value:function(){return""}},{key:"renderAsync",value:function(){var t=this;return new Promise(function(e){try{t.render(),e(!0)}catch(t){e(!1)}})}},{key:"update",value:function(t){var e=!!this.el.current,n=this.parent,i=this.eventBridge.events;return e&&(this.unmount(),this.eventBridge.events=i),this.props=t,e&&(this.parent=n,this.render()),this}},{key:"mount",value:function(t,e){return this.el.current?(console.warn("Component is already mounted"),this):this.parent?(t===this.parent||console.warn("Component maybe in mounting, please wait mounted, and then use update or unmount first"),this):(this.parent=t,e?this.renderAsync():this.render(),this)}},{key:"unmount",value:function(){var t;if(null==(t=this.dispose)||t.call(this),this.eventBridge.disconnect(),this.props={},this.methods={},this.el.current){var e=this.parent||this.el.current.parentElement;e!==this.el.current&&null!=e&&e.contains(this.el.current)&&(e.removeChild(this.el.current),this.parent=null),this.el.current=null}}}])}(),qA=function(t){function e(){return o(this,e),r(this,e,arguments)}return h(e,t),s(e,[{key:"_render",value:function(){if(this.parent){var t=this.props,e=t.params,n=t.mode,i=t.spmPrefix,r=t.seekId,o=t.disableVideoTime,a=t.disableUpActions,s=t.cmFromTrackId,l=t.lazyLoad,c=t.maxViewLimit,u=t.disableFixedCommentBox,d=document.createElement("bili-comments");d.setAttribute("data-params",e),n&&d.setAttribute("mode",String(n)),l&&d.setAttribute("lazy-load","true"),i&&d.setAttribute("spm-prefix",i),r&&d.setAttribute("seek-id",String(r)),o&&d.setAttribute("disable-video-time","true"),a&&d.setAttribute("disable-up-actions","true"),s&&d.setAttribute("cm-from-track-id",String(s)),c&&d.setAttribute("max-view-limit",String(c)),u&&d.setAttribute("fixed-comment-box","false"),this.el.current=d,this.eventBridge.connect(d),this.parent.appendChild(d)}}},{key:"render",value:function(){var t=this;this._render();this.methods={reload:function(e){if(e&&Object.assign(t.props,e),!t.el.current)return t._render();var n=t.props,i=n.params,r=n.mode,o=n.spmPrefix,a=n.seekId,s=n.disableUpActions,l=n.disableVideoTime,c=n.lazyLoad,u=n.maxViewLimit,d=n.cmFromTrackId,h=n.disableFixedCommentBox,p=g(i.split(","),2),f=p[0],v=p[1];t.el.current.reload({oid:v,type:f,mode:r,lazyLoad:c,seekRpid:a,spmPrefix:o,contentFeatures:{videoTime:!l},fixedCommentBox:!h,disableUpActions:s,maxViewLimit:u,cmFromTrackId:d})}}}},{key:"renderToString",value:function(){return""}},{key:"renderAsync",value:function(){return this.render(),Promise.resolve(!0)}}])}(GA);return qA.initCSSVars=function(){getComputedStyle(document.documentElement).getPropertyValue("--brand_pink")||ni("//s1.hdslb.com/bfs/seed/jinkela/short/bili-theme/bili-theme.min.js",{lib:"BiliTheme"}).then(function(t){t.initThemeWithCSR()}).catch(function(){var t=document.createElement("link");t.rel="stylesheet",t.href="//s1.hdslb.com/bfs/seed/jinkela/short/b-style/theme.min.css",document.head.appendChild(t)})},qA});
